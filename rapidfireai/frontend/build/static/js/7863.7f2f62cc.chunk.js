"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[7863],{3679:function(e,t,n){n.d(t,{M:function(){return y}});var o=n(89555),a=n(59403),r=n(68048),s=n(23823),i=n(70169),l=n(88464),d=n(31014),c=n(96070),u=n(6604),p=n(88443),m=n(9133),g=n(28380),h=n(50111);const f="tooltipLastPopup";var v={name:"c61v0h",styles:".du-bois-light-select-item-option-active:not(.du-bois-light-select-item-option-disabled){background-color:#e6f1f5;}"},_={name:"9gxvqt",styles:"display:flex;gap:4px;align-items:center"};const y=({baseOptions:e,searchFilter:t,requestError:n=null,onSearchFilterChange:y,onClear:x,tooltipContent:b,placeholder:w,useQuickFilter:C,defaultActiveFirstOption:Y=!0,className:k})=>{const{theme:I,getPrefixedClassName:A}=(0,a.u)(),S=(0,d.useRef)(null),M=(0,l.A)(),[R,D]=(0,d.useState)(""),[T,E]=(0,d.useState)(void 0),[L,F]=(0,d.useState)(!1),[B,U]=(0,d.useState)(!1),[N,O]=(0,d.useState)({Metrics:10,Parameters:10,Tags:10}),P=(0,d.useRef)([]),[H,V]=(0,d.useState)(void 0);(0,d.useEffect)((()=>{D(t)}),[t]),(0,d.useEffect)((()=>{const e=P.current,t=(0,c.jP)(R);if(P.current=t,B)return void U(!1);const n=t.map((e=>e.name)),o=e.map((e=>e.name));if(!(0,m.isEqual)(n,o)&&t.length>=e.length){let n=0;for(;n<t.length;){if(n>=e.length||t[n].name.trim()!==e[n].name.trim())return E(!0),void V(t[n]);n++}}E(!1)}),[R]);const K=(0,d.useMemo)((()=>H?(0,c.M8)(e,H,N):[]),[e,H,N]),z=(0,d.useCallback)(((e,t)=>{if(H)if(e.startsWith("...")){E(!0);const e=t.value.split("_")[1];O((t=>({...t,[e]:t[e]+10})))}else{const t=R.substring(0,H.startIndex),n=R.substring(H.endIndex);D(t+e+" "+n),U(!0),E(!1)}}),[R,D,H,E]),G=(0,g.S)(f),[j,q]=(0,d.useState)((()=>{const e=Math.floor(Date.now()/1e3),t=G.getItem(f);return!t||parseInt(t,10)<e-604800})),W=d.useRef(null),$=(0,d.useMemo)((()=>{if(C&&R.length>0&&!(0,u.cK)(R))return(0,u.jA)(R)}),[R,C]);(0,d.useEffect)((()=>{if(n&&j){var e;const t=Math.floor(Date.now()/1e3);G.setItem(f,t),q(!1),null===(e=W.current)||void 0===e||e.click()}}),[n]);const J=0===K.flatMap((e=>e.options)).length,Q=T&&L&&!J,X=(0,d.useCallback)((e=>{var t;const n=A("select-item-option-active"),o=Boolean(null===(t=S.current)||void 0===t?void 0:t.querySelector(`.${n}`));"Enter"===e.key&&(Q&&E(!1),Q&&o||y(R)),"Escape"===e.key&&(e.preventDefault(),Q&&E(!1))}),[Q,R,y,A]);return(0,h.Y)("div",{css:(0,o.AH)({display:"flex",gap:I.spacing.sm,width:430,[I.responsive.mediaQueries.xs]:{width:"auto"}},""),className:k,children:(0,h.Y)(r.AutoComplete,{dropdownMatchSelectWidth:560,css:(0,o.AH)({width:560,[I.responsive.mediaQueries.xs]:{width:"auto"}},""),defaultOpen:!1,defaultActiveFirstOption:Y&&!C,open:Q,options:K,onSelect:z,value:R,"data-testid":"runs-search-autocomplete",dropdownRender:e=>(0,h.Y)("div",{css:v,ref:S,children:e}),children:(0,h.Y)(i.I,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_runssearchautocomplete.tsx_236",value:R,prefix:(0,h.Y)(i.S,{css:(0,o.AH)({svg:{width:I.general.iconFontSize,height:I.general.iconFontSize,color:I.colors.textSecondary}},"")}),onKeyDown:X,onClick:()=>F(!0),onBlur:()=>F(!1),onChange:e=>D(e.target.value),placeholder:w,"data-testid":"search-box",suffix:(0,h.FD)("div",{css:_,children:[R&&(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_runssearchautocomplete.tsx_212",onClick:()=>{x(),D("")},type:"link","data-testid":"clear-button",children:(0,h.Y)(a.C,{})}),$?(0,h.Y)(s.T,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_runssearchautocomplete.tsx_310",content:(0,h.Y)(p.A,{id:"ESmLOR",defaultMessage:"Using regular expression quick filter. The following query will be used: {filterSample}",values:{filterSample:(0,h.Y)("div",{children:(0,h.Y)("code",{children:$})})}}),delayDuration:0,children:(0,h.Y)(r.InfoFillIcon,{"aria-label":M.formatMessage({id:"ESmLOR",defaultMessage:"Using regular expression quick filter. The following query will be used: {filterSample}"},{filterSample:$}),css:(0,o.AH)({svg:{width:I.general.iconFontSize,height:I.general.iconFontSize,color:I.colors.actionPrimaryBackgroundDefault}},"")})}):(0,h.Y)(r.LegacyTooltip,{title:b,placement:"right",dangerouslySetAntdProps:{overlayInnerStyle:{width:"150%"},trigger:["focus","click"]},children:(0,h.Y)(a.B,{size:"small",ref:W,componentId:"mlflow.experiment_page.search_filter.tooltip",type:"link",css:(0,o.AH)({marginLeft:-I.spacing.xs,marginRight:-I.spacing.xs},""),icon:(0,h.Y)(s.I,{css:(0,o.AH)({svg:{width:I.general.iconFontSize,height:I.general.iconFontSize,color:I.colors.textSecondary}},"")})})})]})})})})}},28380:function(e,t,n){n.d(t,{S:function(){return r}});var o=n(31014),a=n(32614);const r=e=>(0,o.useMemo)((()=>a.A.getStoreForComponent("ExperimentView",e)),[e])},39771:function(e,t,n){n.d(t,{b:function(){return a}});var o=n(31014);function a(e){const t=(0,o.useRef)(null),[n,a]=(0,o.useState)(void 0),r=(0,o.useCallback)((()=>{t.current&&a(t.current.clientWidth)}),[]);(0,o.useLayoutEffect)((()=>(r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r))),[r]);return{resizableMaxWidth:void 0===n?void 0:n-e,ref:(0,o.useCallback)((e=>{t.current=e,r()}),[r])}}},42550:function(e,t,n){n.d(t,{t:function(){return u}});var o=n(89555),a=n(59403),r=n(31014),s=n(15230),i=n(21879),l=n(50111);var d={name:"1h0bf8r",styles:"body, :host{user-select:none;}"},c={name:"5ob2ly",styles:"display:flex;position:relative"};const u=({runListHidden:e,width:t,onResize:n,children:a,onHiddenChange:u,maxWidth:m})=>{const g=(0,i.e)(),[h,f]=(0,r.useState)(!1);return(0,l.FD)(l.FK,{children:[(0,l.Y)(s.ResizableBox,{css:c,style:{flex:`0 0 ${e?0:t}px`},width:t,axis:"x",resizeHandles:["e"],minConstraints:[250,0],maxConstraints:void 0===m?void 0:[m,0],handle:(0,l.Y)(p,{runListHidden:e,updateRunListHidden:e=>{u?u(e):g((t=>({...t,runListHidden:e})))}}),onResize:(t,{size:o})=>{e||n(o.width)},onResizeStart:()=>!e&&f(!0),onResizeStop:()=>f(!1),children:a}),h&&(0,l.Y)(o.mL,{styles:d})]})},p=r.forwardRef((({updateRunListHidden:e,runListHidden:t,...n},r)=>{const{theme:s}=(0,a.u)();return(0,l.FD)("div",{ref:r,...n,css:(0,o.AH)({transition:"opacity 0.2s",width:0,overflow:"visible",height:"100%",position:"relative",zIndex:10,display:"flex",opacity:t?1:0,"&:hover":{opacity:1,".bar":{opacity:1},".button":{border:`2px solid ${s.colors.actionDefaultBorderHover}`}}},""),children:[(0,l.Y)("div",{css:(0,o.AH)({position:"absolute",left:-s.general.iconSize/2,width:s.general.iconSize,cursor:t?void 0:"ew-resize",height:"100%",top:0,bottom:0},""),children:(0,l.Y)("div",{className:"button",css:(0,o.AH)({top:"50%",transition:"border-color 0.2s",position:"absolute",width:s.general.iconSize,height:s.general.iconSize,backgroundColor:s.colors.backgroundPrimary,borderRadius:s.general.iconSize,overflow:"hidden",border:`1px solid ${s.colors.border}`,display:"flex",alignItems:"center",justifyContent:"center",zIndex:11},""),children:(0,l.Y)(a.B,{componentId:"mlflow.experiment_page.table_resizer.collapse",onClick:()=>e(!t),icon:t?(0,l.Y)(a.q,{}):(0,l.Y)(a.o,{}),size:"small"})})}),(0,l.Y)("div",{className:"bar",css:(0,o.AH)({position:"absolute",opacity:0,left:-1.5,width:3,height:"100%",top:0,bottom:0,backgroundColor:s.colors.actionPrimaryBackgroundDefault},"")})]})}))},77863:function(e,t,n){n.d(t,{n:function(){return ua}});var o=n(89555),a=n(59403),r=n(68048),s=n(31014),i=n(47664),l=n(26809),d=n(25866),c=n(88443),u=n(79085),p=n(32793),m=n(48624),g=n(58481),h=n(50111);const f=s.memo((({experiments:e})=>{const t=(0,s.useMemo)((()=>(0,h.Y)(c.A,{id:"Dhn7Mb",defaultMessage:"Displaying Runs from {numExperiments} Experiments",values:{numExperiments:e.length}})),[e.length]),n=(0,s.useMemo)((()=>[(0,h.Y)(m.N_,{to:g.Ay.experimentsObservatoryRoute,"data-testid":"experiment-observatory-link",children:(0,h.Y)(c.A,{id:"XBtNVo",defaultMessage:"Experiments"})},g.Ay.experimentsObservatoryRoute)]),[]);return(0,h.Y)(u.z,{title:t,breadcrumbs:n,children:(0,h.Y)(p.z,{})})}));var v=n(10811),_=n(21616);var y=n(33946),x=n(19376),b=n(97026),w=n(76010);class C extends s.Component{constructor(e){super(e),this.handleSubmit=this.handleSubmit.bind(this)}handleSubmit(){const e=[];return this.props.selectedRunIds.forEach((t=>{e.push(this.props.restoreRunApi(t))})),Promise.all(e).catch((e=>{let t="While restoring an experiment run, an error occurred.";e.textJson&&"RESOURCE_LIMIT_EXCEEDED"===e.textJson.error_code&&(t=t+" "+e.textJson.message),this.props.openErrorModal(t)})).then((()=>{var e,t;null===(e=(t=this.props).onSuccess)||void 0===e||e.call(t)}))}render(){const e=this.props.selectedRunIds.length;return(0,h.Y)(b.u,{isOpen:this.props.isOpen,onClose:this.props.onClose,handleSubmit:this.handleSubmit,title:`Restore Experiment ${w.A.pluralize("Run",e)}`,helpText:`${e} experiment ${w.A.pluralize("run",e)} will be restored.`,confirmButtonText:"Restore"})}}const Y={restoreRunApi:l.iz,openErrorModal:l.Yi};var k=(0,v.Ng)(null,Y)(C);const I=({showDeleteRunModal:e,showRestoreRunModal:t,showRenameRunModal:n,runsSelected:o,onCloseDeleteRunModal:a,onCloseRestoreRunModal:r,onCloseRenameRunModal:s,renamedRunName:i,refreshRuns:l})=>{const d=Object.entries(o).filter((([,e])=>e)).map((([e])=>e));return(0,h.FD)(h.FK,{children:[(0,h.Y)(y.A,{isOpen:e,onClose:a,selectedRunIds:d,onSuccess:()=>{l()}}),(0,h.Y)(k,{isOpen:t,onClose:r,selectedRunIds:d,onSuccess:()=>{l()}}),(0,h.Y)(x.j,{runUuid:d[0],onClose:s,runName:i,isOpen:n,onSuccess:()=>{l()}})]})};var A=n(98590),S=n(23823),M=n(70169);var R={name:"82a6rk",styles:"flex:1"},D={name:"82a6rk",styles:"flex:1"};const T=({isOpen:e,setIsOpen:t,selectedRunsExistingTagKeys:n,addNewTag:i})=>{const{theme:l}=(0,a.u)(),[d,u]=(0,s.useState)(""),[p,m]=(0,s.useState)(""),g=""===d||/^[^,.:/=\-\s]+$/.test(d),f=n.includes(d),v=g&&!f,_=d.length>0&&p.length>0&&v;return(0,h.Y)(S.d,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsactionsaddnewtagmodal.tsx_34",title:(0,h.Y)(c.A,{id:"VGJhVI",defaultMessage:"Add New Tag"}),visible:e,onCancel:()=>t(!1),onOk:()=>{_&&(i({key:d,value:p}),t(!1),u(""),m(""))},okText:(0,h.Y)(c.A,{id:"oU/SPm",defaultMessage:"Add"}),cancelText:(0,h.Y)(c.A,{id:"urvfNd",defaultMessage:"Cancel"}),okButtonProps:{disabled:!_},children:(0,h.Y)("form",{css:(0,o.AH)({display:"flex",alignItems:"flex-end",gap:l.spacing.md},""),children:(0,h.FD)("div",{css:(0,o.AH)({display:"flex",gap:l.spacing.md,flex:1},""),children:[(0,h.FD)("div",{css:R,children:[(0,h.Y)(r.FormUI.Label,{htmlFor:"key",children:(0,h.Y)(c.A,{id:"FYxQgz",defaultMessage:"Key"})}),(0,h.Y)(M.I,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsactionsaddnewtagmodal.tsx_51",value:d,onChange:e=>u(e.target.value),validationState:v?void 0:"warning","data-testid":"add-new-tag-key-input"}),!g&&(0,h.Y)(r.FormUI.Hint,{children:(0,h.Y)(c.A,{id:"Sb0Z4Z",defaultMessage:", . : / - = and blank spaces are not allowed"})}),f&&(0,h.Y)(r.FormUI.Hint,{children:(0,h.Y)(c.A,{id:"xBoybr",defaultMessage:"Tag key already exists on one or more of the selected runs. Please choose a different key."})})]}),(0,h.FD)("div",{css:D,children:[(0,h.Y)(r.FormUI.Label,{htmlFor:"value",children:(0,h.Y)(c.A,{id:"OQsEJv",defaultMessage:"Value"})}),(0,h.Y)(M.I,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsactionsaddnewtagmodal.tsx_78",value:p,onChange:e=>m(e.target.value),"data-testid":"add-new-tag-value-input"})]})]})})})};var E=n(9133),L=n(52350);const F=e=>`${e.key}: ${e.value}`,B=e=>{const[t,...n]=e.split(": ");return{key:t,value:n.join(": ")}},U=({runInfos:e,runsSelected:t,tagsList:n,refreshRuns:i})=>{const{theme:d}=(0,a.u)(),[u,p]=(0,s.useState)({}),[m,g]=(0,s.useState)(!1),[f,_]=(0,s.useState)(!1),[y,x]=(0,s.useState)(!1),{allSelectedTags:b,allNotSelectedTags:C,indeterminateTags:Y,allTags:k}=((e,t,n)=>{const o=e.flatMap(((e,o)=>{if(t[e.runUuid]){const e=n[o];return[Object.keys(e).filter(A.oD).map((t=>F(e[t])))]}return[]})),a=n.flatMap((e=>Object.keys(e).filter(A.oD).map((t=>F(e[t]))))),r=a.filter((e=>o.every((t=>t.includes(e))))),s=a.filter((e=>o.every((t=>!t.includes(e))))),i=a.filter((e=>!r.includes(e)&&o.some((t=>t.includes(e)))));return{allSelectedTags:r,allNotSelectedTags:s,indeterminateTags:i,allTags:a}})(e,t,n),I=e=>{p((()=>{const t={...u};return k.forEach((e=>{b.includes(e)?t[e]=!0:C.includes(e)?t[e]=!1:Y.includes(e)&&(t[e]=void 0)})),void 0!==e&&(t[F(e)]=!0),t})),_(!0)},S=e=>{p((t=>({...t,[e]:!t[e]})))},M=(0,v.wA)();return(0,h.FD)(h.FK,{children:[(0,h.FD)(r.DialogCombobox,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsactionsselecttags.tsx_162",open:f,label:"Add tags",id:"runs-tag-multiselect",multiSelect:!0,children:[(0,h.Y)(r.DialogComboboxTrigger,{onClick:()=>{f?_(!1):I()},"data-testid":"runs-tag-multiselect-trigger"}),(0,h.FD)(r.DialogComboboxContent,{matchTriggerWidth:!0,children:[(0,h.Y)(r.DialogComboboxOptionList,{children:Object.keys(u).map((e=>{const t=void 0===u[e];return(0,h.Y)(r.DialogComboboxOptionListCheckboxItem,{value:e,onChange:S,checked:u[e],indeterminate:t},e)}))}),(0,h.Y)(r.DialogComboboxFooter,{children:(0,h.FD)("div",{css:(0,o.AH)({display:"flex",justifyContent:"flex-end",gap:d.spacing.sm},""),children:[(0,h.Y)(a.B,{componentId:"mlflow.experiment_page.runs.add_new_tag",onClick:()=>{g(!0),_(!1)},icon:(0,h.Y)(r.PlusIcon,{}),"data-testid":"runs-add-new-tag-button",children:(0,h.Y)(c.A,{id:"2zy+D5",defaultMessage:"Add new tag"})}),(0,h.Y)(a.B,{type:"primary",componentId:"mlflow.experiment_page.runs.add_tags",onClick:()=>{x(!0);e.flatMap(((e,n)=>t[e.runUuid]?[n]:[])).forEach((t=>{const o=e[t].runUuid,a=Object.values(n[t]).filter((e=>(0,A.oD)(e.key))),r=Object.keys(u).filter((e=>void 0===u[e]?a.map((e=>F(e))).includes(e):u[e])).map((e=>B(e)));M((0,l.hD)(o,a,r)).then((()=>{i()})).catch((e=>{const t=e instanceof L.s?e.getMessageField():e.message;w.A.displayGlobalErrorNotification(t)})).finally((()=>{x(!1),_(!1)}))}))},disabled:0===Object.keys(u).length,loading:y,children:(0,h.Y)(c.A,{id:"dl0TeT",defaultMessage:"Save"})})]})})]})]}),(0,h.Y)(T,{isOpen:m,setIsOpen:g,selectedRunsExistingTagKeys:(0,E.uniq)(b.concat(Y).map((e=>B(e).key))),addNewTag:e=>{I(e)}})]})},N=({children:e})=>(0,h.Y)(h.FK,{children:e}),O=s.memo((({viewState:e,runsData:t,searchFacetsState:n,refreshRuns:o})=>{const{runsSelected:r}=e,{runInfos:i,tagsList:l}=t,{lifecycleFilter:u}=n,p=(0,m.Zp)(),{theme:f}=(0,a.u)(),[v,_]=(0,s.useState)(!1),[y,x]=(0,s.useState)(!1),[b,w]=(0,s.useState)(!1),[C,Y]=(0,s.useState)(""),k=(0,s.useCallback)((()=>{const e=Object.keys(r),t=i.find((t=>t.runUuid===e[0]));t&&(Y(t.runName),w(!0))}),[i,r]),A=(0,s.useCallback)((()=>{const e=Object.keys(r),t=i.filter((({runUuid:t})=>e.includes(t))).map((({experimentId:e})=>e));p(g.Ay.getCompareRunPageRoute(e,[...new Set(t)].sort()))}),[p,i,r]),S=(0,s.useCallback)((()=>_(!0)),[]),M=(0,s.useCallback)((()=>x(!0)),[]),R=(0,s.useCallback)((()=>_(!1)),[]),D=(0,s.useCallback)((()=>x(!1)),[]),T=(0,s.useCallback)((()=>w(!1)),[]),E=Object.values(e.runsSelected).filter(Boolean).length,L=E>0,F=1===E,B=E>1;return(0,h.FD)(h.FK,{children:[(0,h.FD)("div",{css:P.controlBar,children:[(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsactions.tsx_110","data-testid":"run-rename-button",onClick:k,disabled:!F,children:(0,h.Y)(c.A,{id:"oWPgX7",defaultMessage:"Rename"})}),u===d.gy.ACTIVE?(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsactions.tsx_117","data-testid":"runs-delete-button",disabled:!L,onClick:S,danger:!0,children:(0,h.Y)(c.A,{id:"3Rb4sG",defaultMessage:"Delete"})}):null,u===d.gy.DELETED?(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsactions.tsx_126","data-testid":"runs-restore-button",disabled:!L,onClick:M,children:(0,h.Y)(c.A,{id:"Potju2",defaultMessage:"Restore"})}):null,(0,h.Y)("div",{css:P.buttonSeparator}),(0,h.Y)(N,{children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsactions.tsx_136","data-testid":"runs-compare-button",disabled:!B,onClick:A,children:(0,h.Y)(c.A,{id:"RaGnOQ",defaultMessage:"Compare"})})}),(0,h.Y)("div",{css:P.buttonSeparator}),(0,h.Y)(U,{runsSelected:r,runInfos:i,tagsList:l,refreshRuns:o})]}),(0,h.Y)(I,{runsSelected:r,onCloseRenameRunModal:T,onCloseDeleteRunModal:R,onCloseRestoreRunModal:D,showDeleteRunModal:v,showRestoreRunModal:y,showRenameRunModal:b,renamedRunName:C,refreshRuns:o})]})})),P={buttonSeparator:e=>({borderLeft:`1px solid ${e.colors.border}`,marginLeft:e.spacing.xs,marginRight:e.spacing.xs,height:"100%"}),controlBar:e=>({display:"flex",gap:e.spacing.sm,alignItems:"center"})};var H=n(91144),V=n(88464),K=n(14343),z=n(24947);var G={name:"bjn8wh",styles:"position:relative"};const j=s.memo((e=>{const{runInfos:t}=e,{theme:n}=(0,a.u)(),{refreshRuns:i}=e,u=(0,z.z)(),[p,m]=(0,s.useState)(0),[g,f]=(0,s.useState)(0);return(0,s.useEffect)((()=>{f(0),m((()=>Date.now()))}),[t]),(0,s.useEffect)((()=>{if(!p)return;const e=setInterval((()=>{const e={experimentIds:u,filter:`attributes.start_time > ${p}`,maxResults:d.ks};(0,l.bc)(e).then((e=>{var t;const n=(null===(t=e.runs)||void 0===t?void 0:t.length)||0;f(n)}))}),d.a0);return()=>clearInterval(e)}),[p,u]),(0,h.FD)("div",{css:G,children:[g>0&&(0,h.Y)("div",{title:d.ks>g?`${g}`:d.ks-1+"+",css:(0,o.AH)({position:"absolute",top:0,right:0,transform:"translate(50%, -50%)",display:"flex",justifyContent:"center",alignItems:"center",width:g>9?28:20,height:20,borderRadius:10,border:`1px solid ${n.colors.white}`,backgroundColor:n.colors.lime,color:n.colors.white,fontSize:10,fontWeight:"bold",userSelect:"none",zIndex:1},""),children:d.ks>g?g:d.ks-1+"+"}),(0,h.Y)(r.LegacyTooltip,{title:(0,h.Y)(c.A,{id:"ag05Pe",defaultMessage:"Refresh"}),useAsLabel:!0,children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrefreshbutton.tsx_123",onClick:i,"data-testid":"runs-refresh-button",icon:(0,h.Y)(r.SyncIcon,{})})})]})})),q=(0,v.Ng)((e=>({runInfos:e.entities.runInfosByUuid})),void 0,void 0,{areStatesEqual:(e,t)=>e.entities.runInfosByUuid===t.entities.runInfosByUuid})(j);var W=n(3679);const $=()=>(0,h.FD)("div",{className:"search-input-tooltip-content",children:[(0,h.Y)(c.A,{id:"kIlkgf",defaultMessage:"Search runs using a simplified version of the SQL {whereBold} clause.",values:{whereBold:(0,h.Y)("b",{children:"WHERE"})}})," ",(0,h.Y)(c.A,{id:"nYKZy4",defaultMessage:"<link>Learn more</link>",values:{link:e=>(0,h.Y)("a",{href:i.Lm,target:"_blank",rel:"noopener noreferrer",children:e})}}),(0,h.Y)("br",{}),(0,h.Y)(c.A,{id:"U3btBc",defaultMessage:"Examples:"}),(0,h.Y)("br",{}),"\u2022 metrics.rmse >= 0.8",(0,h.Y)("br",{}),"\u2022 metrics.`f1 score` < 1",(0,h.Y)("br",{}),"\u2022 params.model = 'tree'",(0,h.Y)("br",{}),"\u2022 attributes.run_name = 'my run'",(0,h.Y)("br",{}),"\u2022 tags.`mlflow.user` = 'myUser'",(0,h.Y)("br",{}),"\u2022 metric.f1_score > 0.9 AND params.model = 'tree'",(0,h.Y)("br",{}),"\u2022 dataset.name IN ('dataset1', 'dataset2')",(0,h.Y)("br",{}),"\u2022 attributes.run_id IN ('a1b2c3d4', 'e5f6g7h8')",(0,h.Y)("br",{}),"\u2022 tags.model_class LIKE 'sklearn.linear_model%'"]});var J=n(96070);const Q=["run_id","run_name","status","artifact_uri","user_id","start_time","end_time","created"].map((e=>({value:`attributes.${e}`}))),X=(e,t)=>[...new Set([...e,...t])],Z=e=>e.flatMap((e=>Object.keys(e))),ee=({runsData:e,...t})=>{const n=(0,s.useRef)({metricNames:[],paramNames:[],tagNames:[]}),o=(0,s.useMemo)((()=>{const t=n.current,o=(a=e,{metricNames:X((r=t).metricNames,a.metricKeyList),paramNames:X(r.paramNames,a.paramKeyList),tagNames:(0,J.tY)(X(Z(r.tagNames),Z(a.tagsList)))});var a,r;return n.current=o,(0,J.$K)(o,Q)}),[e]);return(0,h.Y)(W.M,{...t,baseOptions:o,tooltipContent:(0,h.Y)($,{}),placeholder:'metrics.rmse < 1 and params.model = "tree"',useQuickFilter:(0,H.ey)()})};var te=n(18476),ne=n(20897),oe=n(56412);var ae={name:"1voqbl3",styles:"margin-top:0;font-weight:normal"};const re=({isOpen:e,closeModal:t,experimentId:n})=>{const{theme:s}=(0,a.u)(),i=s.isDarkMode?"duotoneDark":"light",l=`\nimport mlflow\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.datasets import load_diabetes\nfrom sklearn.ensemble import RandomForestRegressor\n\n# set the experiment id\nmlflow.set_experiment(experiment_id="${n}")\n\nmlflow.autolog()\ndb = load_diabetes()\n\nX_train, X_test, y_train, y_test = train_test_split(db.data, db.target)\n\n# Create and train models.\nrf = RandomForestRegressor(n_estimators=100, max_depth=6, max_features=3)\nrf.fit(X_train, y_train)\n\n# Use the model to make predictions on the test dataset.\npredictions = rf.predict(X_test)\n`.trimStart(),d=`\nimport mlflow\nimport openai\nimport os\nimport pandas as pd\n\n# you must set the OPENAI_API_KEY environment variable\nassert (\n  "OPENAI_API_KEY" in os.environ\n), "Please set the OPENAI_API_KEY environment variable."\n\n# set the experiment id\nmlflow.set_experiment(experiment_id="${n}")\n\nsystem_prompt = (\n  "The following is a conversation with an AI assistant."\n  + "The assistant is helpful and very friendly."\n)\n\n# start a run\nmlflow.start_run()\nmlflow.log_param("system_prompt", system_prompt)\n\n# Create a question answering model using prompt engineering\n# with OpenAI. Log the model to MLflow Tracking\nlogged_model = mlflow.openai.log_model(\n    model="gpt-4o-mini",\n    task=openai.chat.completions,\n    artifact_path="model",\n    messages=[\n        {"role": "system", "content": system_prompt},\n        {"role": "user", "content": "{question}"},\n    ],\n)\n\n# Evaluate the model on some example questions\nquestions = pd.DataFrame(\n    {\n        "question": [\n            "How do you create a run with MLflow?",\n            "How do you log a model with MLflow?",\n            "What is the capital of France?",\n        ]\n    }\n)\nmlflow.evaluate(\n    model=logged_model.model_uri,\n    model_type="question-answering",\n    data=questions,\n)\nmlflow.end_run()\n`.trimStart(),u=18*(Math.min(...[l,d].map((e=>e.split("\n").length)))+1);return(0,h.Y)(S.d,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_createnotebookrunmodal.tsx_111",visible:e,onCancel:t,onOk:t,footer:(0,h.Y)("div",{css:(0,o.AH)({display:"flex",gap:s.spacing.sm,justifyContent:"flex-end"},""),children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_createnotebookrunmodal.tsx_117",onClick:t,type:"primary",children:(0,h.Y)(c.A,{id:"ttyLD4",defaultMessage:"Okay"})})}),title:(0,h.FD)("div",{children:[(0,h.Y)(a.T.Title,{level:2,css:(0,o.AH)({marginTop:s.spacing.sm,marginBottom:s.spacing.xs},""),children:(0,h.Y)(c.A,{id:"iF1UfU",defaultMessage:"New run using notebook"})}),(0,h.Y)(a.T.Hint,{css:ae,children:"Run this code snippet in a notebook or locally, to create an experiment run"})]}),children:(0,h.FD)(r.LegacyTabs,{children:[(0,h.Y)(r.LegacyTabPane,{tab:(0,h.Y)(c.A,{id:"71dHIO",defaultMessage:"Classical ML"}),children:(0,h.Y)(ne.z7,{style:{padding:"5px",height:u},language:"python",theme:i,actions:(0,h.Y)("div",{style:{marginTop:s.spacing.sm,marginRight:s.spacing.md},children:(0,h.Y)(oe.i,{copyText:l,showLabel:!1,icon:(0,h.Y)(r.CopyIcon,{})})}),children:l})},"classical-ml"),(0,h.Y)(r.LegacyTabPane,{tab:(0,h.Y)(c.A,{id:"xBVMQz",defaultMessage:"LLM"}),children:(0,h.Y)(ne.z7,{style:{padding:"5px",height:u},language:"python",theme:i,actions:(0,h.Y)("div",{style:{marginTop:s.spacing.sm,marginRight:s.spacing.md},children:(0,h.Y)(oe.i,{copyText:d,showLabel:!1,icon:(0,h.Y)(r.CopyIcon,{})})}),children:d})},"llm")]})})};var se=n(30214),ie=n(4877),le=n.n(ie),de=n(63528),ce=n(50361);class ue extends L.s{getGatewayErrorMessage(){var e,t,n,o;return(null===(e=this.textJson)||void 0===e||null===(t=e.error)||void 0===t?void 0:t.message)||(null===(n=this.textJson)||void 0===n?void 0:n.message)||(null===(o=this.textJson)||void 0===o?void 0:o.toString())||this.text}}var pe;class me{static createEvaluationTextPayload(e,t){switch(t){case ce.W8.LLM_V1_COMPLETIONS:return{prompt:e};case ce.W8.LLM_V1_CHAT:return{messages:[{content:e,role:"user"}]};case ce.W8.LLM_V1_EMBEDDINGS:throw new Error(`Unsupported served LLM model task "${t}"!`);default:throw new Error(`Unknown served LLM model task "${t}"!`)}}}pe=me,me.queryMLflowDeploymentEndpointRoute=async(e,t)=>{le()(e.mlflowDeployment,"Trying to call a MLflow deployment route without a deployment_url");const{inputText:n}=t,o={...pe.createEvaluationTextPayload(n,e.task),...t.parameters};return de.x.gatewayProxyPost({gateway_path:e.mlflowDeployment.endpoint_url.substring(1),json_data:o})},me.queryModelGatewayRoute=async(e,t)=>{if("mlflow_deployment_endpoint"===e.type){le()(e.mlflowDeployment,"Trying to call a serving endpoint route without an endpoint");return((e,t)=>{if(t===ce.W8.LLM_V1_COMPLETIONS){var n,o;const t=e,a=null===(n=t.choices)||void 0===n||null===(o=n[0])||void 0===o?void 0:o.text,{usage:r}=t;if(a&&r)return{text:a,metadata:{total_tokens:r.total_tokens,output_tokens:r.completion_tokens,input_tokens:r.prompt_tokens}}}if(t===ce.W8.LLM_V1_CHAT){var a,r,s;const t=e,n=null===(a=t.choices)||void 0===a||null===(r=a[0])||void 0===r||null===(s=r.message)||void 0===s?void 0:s.content,{usage:o}=t;if(n&&o)return{text:n,metadata:{total_tokens:o.total_tokens,output_tokens:o.completion_tokens,input_tokens:o.prompt_tokens}}}throw new Error(`Unrecognizable AI gateway response metadata "${e.usage}"!`)})(await pe.queryMLflowDeploymentEndpointRoute(e,t),e.task)}throw new Error("Unknown route type")};var ge=n(54346),he=n(65795),fe=n(69526);const ve=[{type:"slider",name:"temperature",string:(0,fe.zR)({id:"Jrri/Y",defaultMessage:"Temperature"}),helpString:(0,fe.zR)({id:"5yWkFd",defaultMessage:"Increase or decrease the confidence level of the language model."}),max:1,min:0,step:.01},{type:"input",name:"max_tokens",string:(0,fe.zR)({id:"qR3llD",defaultMessage:"Max tokens"}),helpString:(0,fe.zR)({id:"cEwSR8",defaultMessage:"Maximum number of language tokens returned from evaluation."}),max:65536,min:1,step:1},{type:"list",name:"stop",string:(0,fe.zR)({id:"FAfPOl",defaultMessage:"Stop Sequences"}),helpString:(0,fe.zR)({id:"J2XCE/",defaultMessage:"Specify sequences that signal the model to stop generating text."})}],_e={temperature:.01,max_tokens:100},ye=()=>{const[e,t]=(0,s.useState)(_e),n=(0,s.useCallback)(((e,n)=>{t((t=>({...t,[e]:n})))}),[]);return{parameterDefinitions:ve,parameters:e,updateParameter:n}};var xe=n(20193);var be={name:"1d3w5wq",styles:"width:100%"};const we=({parameterValue:e,updateParameter:t,disabled:n})=>{const[i,l]=(0,s.useState)(""),{theme:d}=(0,a.u)();return(0,E.isArray)(e)?(0,h.FD)(h.FK,{children:[(0,h.Y)("div",{css:(0,o.AH)({marginTop:d.spacing.xs,marginBottom:d.spacing.sm},""),children:e.map(((n,o)=>(0,h.Y)(r.Tag,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptparameters.tsx_28",closable:!0,onClose:()=>{t(e.filter((e=>e!==n)))},children:n},o)))}),(0,h.Y)(M.I,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptparameters.tsx_39",allowClear:!0,css:be,disabled:n,onChange:e=>l(e.target.value),value:i,onKeyDown:n=>{"Enter"===n.key&&i.trim()&&(t((0,E.uniq)([...e,i])),l(""))}})]}):null};var Ce={name:"151f7v8",styles:"span{font-weight:normal;}"};const Ye=({disabled:e=!1,parameters:t,updateParameter:n})=>{const{parameterDefinitions:s}=ye(),{theme:i}=(0,a.u)();return(0,h.FD)("div",{css:(0,o.AH)({marginBottom:i.spacing.lg},""),children:[(0,h.Y)(r.FormUI.Label,{css:(0,o.AH)({marginBottom:i.spacing.md},""),children:(0,h.Y)(c.A,{id:"KADUUT",defaultMessage:"Model parameters"})}),s.map((a=>{var s;return(0,h.Y)("div",{css:(0,o.AH)({marginBottom:i.spacing.md},""),children:(0,h.FD)(h.FK,{children:[(0,h.FD)(r.FormUI.Label,{htmlFor:a.name,css:Ce,children:[(0,h.Y)(c.A,{...a.string}),(0,h.Y)(r.LegacyTooltip,{title:(0,h.Y)(c.A,{...a.helpString}),placement:"right",children:(0,h.Y)(S.I,{css:(0,o.AH)({marginLeft:i.spacing.sm,verticalAlign:"text-top",color:i.colors.textSecondary},"")})})]}),(0,h.Y)(r.FormUI.Hint,{}),"temperature"===a.name&&(0,h.Y)(xe.o,{"data-testid":a.name,disabled:e,max:a.max,min:a.min,step:a.step,value:t[a.name]||0,onChange:e=>n(a.name,e)}),"input"===a.type&&(0,h.Y)(M.I,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptparameters.tsx_107","data-testid":a.name,type:"number",disabled:e,max:a.max,min:a.min,step:a.step,value:t[a.name]||0,onChange:e=>n(a.name,parseInt(e.target.value,10))}),"list"===a.type&&(0,h.Y)(we,{parameterValue:null!==(s=t[a.name])&&void 0!==s?s:[],disabled:e,updateParameter:e=>n(a.name,e)})]})},a.name)}))]})},ke=" }}",Ie="new_variable",Ae=()=>{const[e,t]=(0,s.useState)(he.KH),n=(0,s.useRef)(),o=(0,s.useCallback)((()=>{t((e=>{const t=((e=[])=>{if(!e.includes(Ie))return Ie;const t=(0,E.max)(e.map((e=>{var t;return parseInt((null===(t=e.match(/new_variable_(\d+)/))||void 0===t?void 0:t[1])||"1",10)})))||1;return`${Ie}_${t+1}`})((0,he.rl)(e)),o=`${e} {{ ${t}${ke}`;return requestAnimationFrame((()=>{const e=n.current;e&&(e.focus(),e.setSelectionRange(o.length-t.length-3,o.length-3))})),o}))}),[t]);return{savePromptTemplateInputRef:(0,s.useCallback)((e=>{var t;n.current=null===e||void 0===e||null===(t=e.resizableTextArea)||void 0===t?void 0:t.textArea}),[]),handleAddVariableToTemplate:o,promptTemplate:e,updatePromptTemplate:t}},Se=(0,fe.zR)({id:"lM0z8k",defaultMessage:"The following variable names contain spaces which is disallowed: {invalidNames}"}),Me=({violations:e})=>{const{namesWithSpaces:t}=e,{formatMessage:n}=(0,V.A)();return(0,h.Y)(h.FK,{children:t.length>0&&(0,h.Y)(a.T.Text,{color:"warning",size:"sm","aria-label":n(Se,{invalidNames:t.join(", ")}),children:(0,h.Y)(c.A,{...Se,values:{invalidNames:(0,h.Y)(h.FK,{children:t.map((e=>(0,h.Y)("code",{children:e},e)))})}})})})},Re=[{prompt:["You are a marketing consultant for a technology company. Develop a marketing strategy report for {{ company_name }} aiming to {{ company_goal }}"],variables:[{name:"company_name",value:"XYZ Company"},{name:"company_goal",value:"Increase top-line revenue"}]},{prompt:['You are a helpful and friendly customer support chatbot. Answer the users question "{{ user_question }}" clearly, based on the following documentation: {{ documentation }}'],variables:[{name:"user_question",value:"Is MLflow open source?"},{name:"documentation",value:"MLflow is an open source platform for managing the end-to-end machine learning lifecycle."}]},{prompt:['Summarize the given text "{{ text }}" into a concise and coherent summary, capturing the main ideas and key points. Make sure that the summary does not exceed {{ word_count }} words.'],variables:[{name:"text",value:"Although C. septempunctata larvae and adults mainly eat aphids, they also feed on Thysanoptera, Aleyrodidae, on the larvae of Psyllidae and Cicadellidae, and on eggs and larvae of some beetles and butterflies. There are one or two generations per year. Adults overwinter in ground litter in parks, gardens and forest edges and under tree bark and rocks. C. septempunctata has a broad ecological range, generally living wherever there are aphids for it to eat. This includes, amongst other biotopes, meadows, fields, Pontic\u2013Caspian steppe, parkland, gardens, Western European broadleaf forests and mixed forests. In the United Kingdom, there are fears that the seven-spot ladybird is being outcompeted for food by the harlequin ladybird. An adult seven-spot ladybird may reach a body length of 7.6\u201312.7 mm (0.3\u20130.5 in). Their distinctive spots and conspicuous colours warn of their toxicity, making them unappealing to predators. The species can secrete a fluid from joints in their legs which gives them a foul taste. A threatened ladybird may both play dead and secrete the unappetising substance to protect itself. The seven-spot ladybird synthesizes the toxic alkaloids, N-oxide coccinelline and its free base precoccinelline; depending on sex and diet, the spot size and coloration can provide some indication of how toxic the individual insect is to potential predators."},{name:"word_count",value:"75"}]},{prompt:["Generate a list of ten titles for my book. The book is about {{ topic }}. Each title should be between {{ word_range }} words long.","### Examples of great titles ###","{{ examples }}"],variables:[{name:"topic",value:"my journey as an adventurer who has lived an unconventional life, meeting many different personalities and finally finding peace in gardening."},{name:"word_range",value:"two to five"},{name:"examples",value:'"Long walk to freedom", "Wishful drinking", "I know why the caged bird sings"'}]},{prompt:["Generate a SQL query from a user\u2019s question, using the information from the table.","Question: {{ user_question }}","Table Information: {{ table_information }}"],variables:[{name:"user_question",value:"Which product generated the most sales this month?"},{name:"table_information",value:"CREATE TABLE Sales (SaleID INT PRIMARY KEY, ProductID INT, SaleDate DATE, CustomerID INT, QuantitySold INT, UnitPrice DECIMAL(10, 2));"}]}],{TextArea:De}=M.I,Te=({isOpen:e,closeExamples:t,closeModal:n,updatePromptTemplate:s,updateInputVariableValue:i})=>{const{theme:l}=(0,a.u)();return(0,h.Y)(S.d,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodalexamples.tsx_42",verticalSizing:"maxed_out",visible:e,onCancel:n,title:(0,h.Y)("div",{children:(0,h.FD)(a.T.Title,{level:2,css:(0,o.AH)({marginTop:l.spacing.sm,marginBottom:l.spacing.xs},""),children:[(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodalexamples.tsx_48",css:(0,o.AH)({marginRight:l.spacing.sm,marginBottom:l.spacing.sm},""),icon:(0,h.Y)(r.ArrowLeftIcon,{}),onClick:t}),(0,h.Y)(c.A,{id:"KzC+38",defaultMessage:"Prompt template examples"})]})}),dangerouslySetAntdProps:{width:1200},children:Re.map((e=>(0,h.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:l.spacing.md},""),children:[(0,h.FD)("div",{css:(0,o.AH)({boxSizing:"border-box",border:`1px solid ${l.colors.actionDefaultBorderDefault}`,borderRadius:l.legacyBorders.borderRadiusMd,background:l.colors.backgroundPrimary,padding:l.spacing.md,margin:0,overflow:"hidden",display:"flex",flexDirection:"column",gap:`${l.spacing.xs}px`},""),children:[(0,h.FD)(a.T.Title,{level:4,children:[(0,h.Y)(c.A,{id:"GDzD7I",defaultMessage:"Prompt Template"}),(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodalexamples.tsx_90",type:"tertiary",size:"small",style:{float:"right"},onClick:()=>(e=>{s(e.prompt.join("\n")),e.variables.forEach((({name:e,value:t})=>{i(e,t)})),t()})(e),children:(0,h.Y)(c.A,{id:"Np53PR",defaultMessage:"Try this template"})})]}),e.prompt.map((e=>(0,h.Y)(a.T.Paragraph,{children:e},e))),(0,h.Y)("div",{css:(0,o.AH)({marginTop:l.spacing.xs,marginBottom:l.spacing.xs,borderTop:`1px solid ${l.colors.border}`,opacity:.5},"")}),e.variables.map((({name:e,value:t})=>(0,h.FD)("div",{children:[(0,h.Y)(a.T.Title,{level:4,children:e}),(0,h.Y)(a.T.Paragraph,{children:t})]},e)))]}),(0,h.Y)(S.S,{})]},e.prompt.join("\n"))))})};const{TextArea:Ee}=M.I;var Le={name:"1ll9bqd",styles:"cursor:default"};const Fe=({evaluationMetadata:e,isEvaluating:t,isOutputDirty:n,evaluationOutput:i,evaluationError:l,evaluateButtonTooltip:d,disabled:u,onEvaluateClick:p,onCancelClick:m})=>{const{theme:g}=(0,a.u)(),f=(0,s.useMemo)((()=>e?t?null:(0,h.FD)("div",{css:(0,o.AH)({display:"flex",gap:g.spacing.xs,alignItems:"center"},""),children:[he.Ef in e&&(0,h.FD)(a.T.Hint,{size:"sm",children:[Math.round(Number(e[he.Ef]))," ms","MLFLOW_total_tokens"in e?",":""]}),he.jC in e&&(0,h.Y)(a.T.Hint,{size:"sm",children:(0,h.Y)(c.A,{id:"/nPZbt",defaultMessage:"{totalTokens} total tokens",values:{totalTokens:e[he.jC]}})})]}):null),[e,t,g]);return(0,h.FD)(h.FK,{children:[(0,h.FD)("div",{css:(0,o.AH)({marginBottom:g.spacing.md},""),children:[(0,h.Y)(r.LegacyTooltip,{title:d,children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationcreatepromptrunoutput.tsx_85","data-testid":"button-evaluate",icon:(0,h.Y)(r.PlayIcon,{}),onClick:p,disabled:u,loading:t,children:(0,h.Y)(c.A,{id:"72uGpl",defaultMessage:"Evaluate"})})}),t&&(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationcreatepromptrunoutput.tsx_99","data-testid":"button-cancel",icon:(0,h.Y)(r.StopIcon,{}),onClick:m,css:(0,o.AH)({marginLeft:g.spacing.sm},""),children:(0,h.Y)(c.A,{id:"CTEh+b",defaultMessage:"Cancel"})})]}),(0,h.FD)(r.FormUI.Label,{children:[(0,h.Y)(c.A,{id:"ydoHrJ",defaultMessage:"Output"}),n&&(0,h.Y)(r.LegacyTooltip,{title:(0,h.Y)(c.A,{id:"gc+GrI",defaultMessage:"Model, input data or prompt have changed since last evaluation of the output"}),children:(0,h.Y)(a.W,{css:(0,o.AH)({marginLeft:g.spacing.xs},"")})})]}),(0,h.Y)(r.FormUI.Hint,{children:(0,h.Y)(c.A,{id:"JtQQMn",defaultMessage:"This is the output generated by the LLM using the prompt template and input values defined above."})}),!l&&t&&(0,h.Y)("div",{css:(0,o.AH)({marginTop:g.spacing.sm},""),children:(0,h.Y)(r.TableSkeleton,{lines:5})}),!t&&(0,h.Y)(Ee,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationcreatepromptrunoutput.tsx_144",rows:5,css:Le,"data-testid":"prompt-output",value:i,readOnly:!0}),!t&&l&&(0,h.Y)(r.FormUI.Message,{message:l,type:"error"}),(0,h.Y)("div",{css:(0,o.AH)({marginTop:g.spacing.sm},""),children:f})]})};var Be=n(53660),Ue=n(17111),Ne=n(7204);const Oe=({routeName:e,routeType:t,compiledPrompt:n,inputValues:o,parameters:a,outputColumn:r,rowKey:s,run:i})=>(({routeName:e,routeType:t,compiledPrompt:n,inputValues:o,parameters:a,outputColumn:r,rowKey:s,run:i})=>async(r,l)=>{const{modelGateway:d}=l();d.modelGatewayRoutesLoading.loading||0!==Object.keys(d.modelGatewayRoutes).length||await r(Pe());const c=l().modelGateway.modelGatewayRoutes[`${t}:${e}`];if(!c){const t=`MLflow deployment endpoint ${e} does not exist anymore!`;throw w.A.logErrorAndNotifyUser(t),new Error(t)}const u={inputText:n,parameters:a};return r({type:"EVALUATE_PROMPT_TABLE_VALUE",payload:me.queryModelGatewayRoute(c,u),meta:{inputValues:o,run:i,compiledPrompt:n,rowKey:s,startTime:performance.now()}})})({...{routeName:e,compiledPrompt:n,inputValues:o,parameters:a,outputColumn:r,rowKey:s,run:i},routeType:t}),Pe=()=>async e=>e({type:"SEARCH_MLFLOW_DEPLOYMENTS_MODEL_ROUTES",payload:de.x.gatewayProxyGet({gateway_path:"api/2.0/endpoints/"}),meta:{id:(0,Ne.yk)()}}),He=e=>e instanceof ue?e.getGatewayErrorMessage():e instanceof L.s?e.getMessageField():e.message;const{TextArea:Ve}=M.I;var Ke={name:"1voqbl3",styles:"margin-top:0;font-weight:normal"},ze={name:"t691yx",styles:"display:grid;grid-template-columns:300px 1fr;gap:48px"},Ge={name:"1d3w5wq",styles:"width:100%"},je={name:"1eoy87d",styles:"display:flex;justify-content:space-between"};const qe=({isOpen:e,closeModal:t,runBeingDuplicated:n,visibleRuns:i=[],refreshRuns:d})=>{const[u]=(0,z.z)(),{theme:p}=(0,a.u)(),{parameters:m,updateParameter:g}=ye(),[,f]=(0,Be.an)(),[_,y]=(0,s.useState)(""),[x,b]=(0,s.useState)(""),[C,Y]=(0,s.useState)(!1),[k,I]=(0,s.useState)(!1),[A,R]=(0,s.useState)(null),[D,T]=(0,s.useState)(""),[L,F]=(0,s.useState)({}),[B,U]=(0,s.useState)(!1),[N,O]=(0,s.useState)(!1),P=(0,s.useRef)(null),H=(0,v.wA)();(0,s.useEffect)((()=>{H(Pe()).catch((e=>{w.A.logErrorAndNotifyUser((null===e||void 0===e?void 0:e.message)||e)}))}),[H]);const K=(0,V.A)(),{updateInputVariables:G,inputVariables:j,inputVariableValues:q,updateInputVariableValue:W,inputVariableNameViolations:$,clearInputVariableValues:J}=(()=>{const[e,t]=(0,s.useState)((0,he.rl)("")),[n,o]=(0,s.useState)({namesWithSpaces:[]}),[a,r]=(0,s.useState)(he.kU),i=(0,s.useCallback)((()=>r({})),[]),l=(0,s.useMemo)((()=>(0,E.debounce)((e=>{t((t=>{const n=(0,he.rl)(e);return(0,E.isEqual)(n,t)?t:n})),o((0,he.Eb)(e))}),250)),[]),d=(0,s.useCallback)(((e,t)=>{r((n=>({...n,[e]:t})))}),[]),c=(0,s.useMemo)((()=>(0,E.fromPairs)(Object.entries(a).filter((([t])=>e.includes(t))))),[a,e]);return{updateInputVariables:l,inputVariables:e,inputVariableValues:c,updateInputVariableValue:d,inputVariableNameViolations:n,clearInputVariableValues:i}})(),{handleAddVariableToTemplate:Q,savePromptTemplateInputRef:X,promptTemplate:Z,updatePromptTemplate:ee}=Ae();(0,s.useEffect)((()=>{e&&!n&&b((0,ge.Lr)())}),[e,n]),(0,s.useEffect)((()=>{G(Z)}),[Z,G]),(0,s.useEffect)((()=>{if(n){const{promptTemplate:e,routeName:t,parameters:o}=(0,he.vC)(n);(0,he.xP)(n),e&&ee(e),o.temperature&&g("temperature",o.temperature),o.max_tokens&&g("max_tokens",o.max_tokens),t&&y(t),T(""),U(!1);const a=(0,ge.gK)(n.runName,(0,E.compact)(i.map((({runName:e})=>e))));b(a),J()}}),[n,J,g,ee,i]);const te=(0,v.d4)((({modelGateway:e})=>e.modelGatewayRoutes)),ne=(0,s.useMemo)((()=>(0,E.sortBy)(Object.values(te),"name")),[te]),oe=(0,v.d4)((({modelGateway:e})=>e.modelGatewayRoutesLoading.loading));(0,s.useEffect)((()=>{D&&U(!0)}),[q,Z,m,_]);const ae=(0,s.useCallback)((()=>{const e=te[_],t=Math.random().toString(36);if(P.current=t,!e)throw new Error("No model route found!");R(null),I(!0);const n=(0,he.TG)(Z,q),o=performance.now();me.queryModelGatewayRoute(e,{inputText:n,parameters:m}).then((e=>{if(P.current===t){const{text:n,metadata:a}=e,r=performance.now()-o;T(n);const s={...a,latency:r},i=Object.entries(s).reduce(((e,[t,n])=>({...e,[`MLFLOW_${t}`]:n})),{});F(i),U(!1),I(!1),P.current===t&&(P.current=null)}})).catch((e=>{const n=He(e),o=K.formatMessage({id:"nyHcAz",defaultMessage:'MLflow deployment returned the following error: "{errorMessage}"'},{errorMessage:n});w.A.displayGlobalErrorNotification(o),I(!1),R(o),P.current===t&&(P.current=null)}))}),[q,te,m,Z,_,K]),re=(0,s.useCallback)((()=>{P.current&&(I(!1),P.current=null)}),[I]),se=K.formatMessage({id:"AyceYA",defaultMessage:"Served LLM model"}),ie=K.formatMessage({id:"pTDM+x",defaultMessage:"Select LLM model endpoint"}),le=Z.trim().length>0,de=(0,s.useMemo)((()=>j.every((e=>{var t;return null===(t=q[e])||void 0===t?void 0:t.trim()}))),[j,q]),ce=x.trim().length>0,ue=_&&le&&de,pe=Boolean(_&&le&&de&&D&&!B&&j.length>0&&ce&&!A),fe=(0,s.useMemo)((()=>_?le?de?D?B?K.formatMessage({id:"/K6wBr",defaultMessage:"Input data or prompt template have changed since last evaluation of the output"}):0===j.length?K.formatMessage({id:"z+0t/R",defaultMessage:"You need to define at least one input variable"}):ce?null:K.formatMessage({id:"dYbJha",defaultMessage:"Please provide run name"}):K.formatMessage({id:"gUhc5g",defaultMessage:"You need to evaluate the resulting output first"}):K.formatMessage({id:"flJNTA",defaultMessage:"You need to provide values for all defined inputs"}):K.formatMessage({id:"dHAuWp",defaultMessage:"You need to provide a prompt template"}):K.formatMessage({id:"4HbEVz",defaultMessage:"You need to select a served model endpoint using dropdown first"})),[de,j.length,K,B,D,le,_,ce]),ve=(0,s.useMemo)((()=>_?le?de?null:K.formatMessage({id:"flJNTA",defaultMessage:"You need to provide values for all defined inputs"}):K.formatMessage({id:"dHAuWp",defaultMessage:"You need to provide a prompt template"}):K.formatMessage({id:"4HbEVz",defaultMessage:"You need to select a served model endpoint using dropdown first"})),[de,K,le,_]);if(e&&N)return(0,h.Y)(Te,{isOpen:e&&N,closeExamples:()=>O(!1),closeModal:t,updatePromptTemplate:ee,updateInputVariableValue:W});return(0,h.FD)(S.d,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodal.tsx_541",verticalSizing:"maxed_out",visible:e,onCancel:t,onOk:t,footer:(0,h.FD)("div",{css:(0,o.AH)({display:"flex",gap:p.spacing.sm,justifyContent:"flex-end"},""),children:[(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodal.tsx_589",onClick:t,children:(0,h.Y)(c.A,{id:"mqTFL+",defaultMessage:"Cancel"})}),(0,h.Y)(r.LegacyTooltip,{title:fe,children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodal.tsx_596",onClick:()=>{var e,n;Y(!0);const o=null===(e=te[_])||void 0===e?void 0:e.name,a={...m,route_type:null===(n=te[_])||void 0===n?void 0:n.type},r=(0,he.TG)(Z,q);H((0,l.$v)({experimentId:u,promptTemplate:Z,modelInput:r,modelParameters:a,modelRouteName:o,promptParameters:q,modelOutput:D,runName:x,modelOutputParameters:L})).then((()=>{d(),t(),Y(!1),f("ARTIFACT")})).catch((e=>{w.A.logErrorAndNotifyUser((null===e||void 0===e?void 0:e.message)||e),Y(!1)}))},"data-testid":"button-create-run",type:"primary",disabled:!pe,children:(0,h.Y)(c.A,{id:"8Uwpjw",defaultMessage:"Create run"})})})]}),title:(0,h.FD)("div",{children:[(0,h.Y)(a.T.Title,{level:2,css:(0,o.AH)({marginTop:p.spacing.sm,marginBottom:p.spacing.xs},""),children:(0,h.Y)(c.A,{id:"sLhmy7",defaultMessage:"New run"})}),(0,h.Y)(a.T.Hint,{css:Ke,children:"Create a new run using a large-language model by giving it a prompt template and model parameters"})]}),dangerouslySetAntdProps:{width:1200},children:[(0,h.FD)("div",{css:ze,children:[(0,h.FD)("div",{children:[(0,h.Y)(r.FormUI.Label,{htmlFor:"selected_model",css:(0,o.AH)({marginBottom:p.spacing.sm},""),children:se}),(0,h.Y)("div",{css:(0,o.AH)({marginBottom:p.spacing.lg,display:"flex",alignItems:"center"},""),children:(0,h.FD)(r.DialogCombobox,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodal.tsx_597",label:se,modal:!1,value:_?[(_e=_,_e.includes(":")?_e.split(":")[1]:_e)]:void 0,children:[(0,h.Y)(r.DialogComboboxTrigger,{id:"selected_model",css:Ge,allowClear:!1,placeholder:ie,withInlineLabel:!1}),(0,h.Y)(r.DialogComboboxContent,{loading:oe,maxHeight:400,matchTriggerWidth:!0,children:!oe&&(0,h.Y)(r.DialogComboboxOptionList,{children:(0,h.Y)(r.DialogComboboxOptionListSearch,{autoFocus:!0,children:ne.map((e=>(0,h.FD)(r.DialogComboboxOptionListSelectItem,{value:e.key,onChange:e=>{y(e)},checked:_===e.key,children:[e.name,e.mlflowDeployment&&(0,h.Y)(r.DialogComboboxHintRow,{children:e.mlflowDeployment.model.name})]},e.key)))})})})]})}),_&&(0,h.Y)(Ye,{parameters:m,updateParameter:g}),(0,h.Y)("div",{css:We.formItem,children:(0,h.FD)(h.FK,{children:[(0,h.FD)(r.FormUI.Label,{htmlFor:"new_run_name",children:[(0,h.Y)(c.A,{id:"Zqj4VA",defaultMessage:"New run name"}),!x.trim()&&(0,h.Y)(r.FormUI.Message,{type:"error",message:K.formatMessage({id:"dYbJha",defaultMessage:"Please provide run name"})})]}),(0,h.Y)(M.I,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodal.tsx_638",id:"new_run_name","data-testid":"run-name-input",required:!0,value:x,onChange:e=>b(e.target.value)})]})})]}),(0,h.FD)("div",{children:[(0,h.FD)("div",{css:We.formItem,children:[(0,h.FD)(h.FK,{children:[(0,h.FD)("div",{css:je,children:[(0,h.Y)(r.FormUI.Label,{htmlFor:"prompt_template",children:(0,h.Y)(c.A,{id:"uBTAtY",defaultMessage:"Prompt Template"})}),(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodal.tsx_695",onClick:()=>O(!0),style:{marginLeft:"auto"},size:"small",children:(0,h.Y)(c.A,{id:"13vJft",defaultMessage:"View Examples"})})]}),(0,h.Y)(r.FormUI.Hint,{children:(0,h.Y)(c.A,{id:"gC2Kxm",defaultMessage:"Give instructions to the model. Use '{{ }}' or the \"Add new variable\" button to add variables to your prompt."})})]}),(0,h.Y)(Ve,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodal.tsx_678",id:"prompt_template",autoSize:{minRows:3},"data-testid":"prompt-template-input",value:Z,onChange:e=>ee(e.target.value),ref:X}),(0,h.Y)(Me,{violations:$})]}),j.map((e=>(0,h.Y)("div",{css:We.formItem,children:(0,h.FD)(h.FK,{children:[(0,h.Y)(r.FormUI.Label,{htmlFor:e,children:(0,h.Y)("span",{children:e})}),(0,h.Y)(Ve,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodal.tsx_694",id:e,autoSize:!0,value:q[e]?q[e]:"",onChange:t=>W(e,t.target.value)})]})},e))),(0,h.Y)("div",{css:(0,o.AH)({marginBottom:2*p.spacing.md},""),children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationcreatepromptrunmodal.tsx_736",icon:(0,h.Y)(r.PlusIcon,{}),onClick:Q,children:(0,h.Y)(c.A,{id:"71hvMu",defaultMessage:"Add new variable"})})}),(0,h.Y)(Fe,{evaluateButtonTooltip:ve,evaluationMetadata:L,evaluationOutput:D,disabled:!ue,isEvaluating:k,isOutputDirty:B,onCancelClick:re,onEvaluateClick:ae,evaluationError:A})]})]}),C&&(0,h.Y)("div",{css:(0,o.AH)({inset:0,backgroundColor:p.colors.overlayOverlay,position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1},""),children:(0,h.Y)(a.S,{})})]});var _e},We={formItem:{marginBottom:16}},$e=s.createContext({createNewRun:()=>{}}),Je=({children:e,visibleRuns:t,refreshRuns:n})=>{const[o,a]=(0,s.useState)(!1),[r,i]=(0,s.useState)(null),l=(0,s.useMemo)((()=>({createNewRun:e=>{a(!0),i(e||null)}})),[]);return(0,h.FD)($e.Provider,{value:l,children:[e,(0,H.Ii)()&&(0,h.Y)(qe,{visibleRuns:t,isOpen:o,closeModal:()=>a(!1),runBeingDuplicated:r,refreshRuns:n})]})},Qe=()=>(0,s.useContext)($e);var Xe=n(3546),Ze=n(83028),et=n(21879);const tt=s.memo((({searchFacetsState:e,experimentId:t,runsData:n,viewState:i,updateViewState:l,onDownloadCsv:u,requestError:p,additionalControls:m,refreshRuns:g,viewMaximized:f,autoRefreshEnabled:y=!1,hideEmptyCharts:x=!1,areRunsGrouped:b=!1})=>{const w=(0,Xe.Px)(),[C,Y]=(0,Be.an)(),k=(0,et.e)(),I=(0,z.z)().length>1,{startTime:A,lifecycleFilter:M,datasetsFilter:R,searchFilter:D}=e,T=C,E=(0,V.A)(),{createNewRun:L}=Qe(),[F,B]=(0,s.useState)(!1),{theme:U}=(0,a.u)(),N=(0,s.useMemo)((()=>(0,_.XU)(E)),[E]),O=M===d.gy.ACTIVE?E.formatMessage({id:"0pdAuV",defaultMessage:"Active"}):E.formatMessage({id:"yJpGwW",defaultMessage:"Deleted"}),P=E.formatMessage({id:"+fb25b",defaultMessage:"Time created"}),G=void 0===T||"ARTIFACT"===T,j=(0,v.d4)((e=>e.entities.datasetsByExperimentId[t])),W=void 0!==j;return(0,h.FD)("div",{css:(0,o.AH)({display:"flex",gap:U.spacing.sm,justifyContent:"space-between",[U.responsive.mediaQueries.xs]:{flexDirection:"column"}},""),children:[(0,h.FD)("div",{css:(0,o.AH)({display:"flex",gap:U.spacing.sm,alignItems:"center",flexWrap:"wrap"},""),children:[("ARTIFACT"!==C||(0,H.GV)())&&(0,h.FD)(r.SegmentedControlGroup,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_184",name:"runs-view-mode",value:C,onChange:({target:e})=>{const{value:t}=e;C!==t&&Y(t)},children:[(0,h.Y)(r.SegmentedControlButton,{value:"TABLE",icon:(0,h.Y)(S.T,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_201",content:E.formatMessage({id:"AxyQXa",defaultMessage:"Table view"}),children:(0,h.Y)(S.L,{})})}),(0,h.Y)(r.SegmentedControlButton,{value:"CHART",icon:(0,h.Y)(S.T,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_211",content:E.formatMessage({id:"Q6oN2U",defaultMessage:"Chart view"}),children:(0,h.Y)(r.ChartLineIcon,{})})}),(0,H.GV)()&&(0,h.Y)(r.SegmentedControlButton,{value:"ARTIFACT",disabled:b,icon:(0,h.Y)(S.T,{componentId:"mlflow.experiment_page.mode.artifact",content:b?E.formatMessage({id:"YOp3/x",defaultMessage:"Unavailable when runs are grouped"}):E.formatMessage({id:"LTbwXS",defaultMessage:"Artifact evaluation"}),children:(0,h.Y)(r.TableIcon,{})})})]}),(0,h.Y)(ee,{runsData:n,searchFilter:D,onSearchFilterChange:e=>{w({searchFilter:e})},onClear:()=>{w((0,Ze.G)())},requestError:p}),(0,h.FD)(r.DialogCombobox,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_217",label:P,value:"ALL"!==A?[N[A]]:[],children:[(0,h.Y)(r.DialogComboboxTrigger,{allowClear:"ALL"!==A,onClear:()=>{w({startTime:"ALL"})},"data-testid":"start-time-select-dropdown"}),(0,h.Y)(r.DialogComboboxContent,{children:(0,h.Y)(r.DialogComboboxOptionList,{children:Object.keys(N).map((e=>(0,h.Y)(r.DialogComboboxOptionListSelectItem,{checked:e===A,title:N[e],"data-testid":`start-time-select-${e}`,value:e,onChange:()=>{w({startTime:e})},children:N[e]},e)))})})]}),(0,h.FD)(r.DialogCombobox,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_248",label:E.formatMessage({id:"iLFoPb",defaultMessage:"State"}),value:[O],children:[(0,h.Y)(r.DialogComboboxTrigger,{allowClear:!1,"data-testid":"lifecycle-filter"}),(0,h.Y)(r.DialogComboboxContent,{children:(0,h.FD)(r.DialogComboboxOptionList,{children:[(0,h.Y)(r.DialogComboboxOptionListSelectItem,{checked:M===d.gy.ACTIVE,"data-testid":"active-runs-menu-item",value:d.gy.ACTIVE,onChange:()=>{w({lifecycleFilter:d.gy.ACTIVE})},children:(0,h.Y)(c.A,{id:"0pdAuV",defaultMessage:"Active"})},d.gy.ACTIVE),(0,h.Y)(r.DialogComboboxOptionListSelectItem,{checked:M===d.gy.DELETED,"data-testid":"deleted-runs-menu-item",value:d.gy.DELETED,onChange:()=>{w({lifecycleFilter:d.gy.DELETED})},children:(0,h.Y)(c.A,{id:"yJpGwW",defaultMessage:"Deleted"})},d.gy.DELETED)]})})]}),(0,h.Y)(r.DialogCombobox,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_289",label:E.formatMessage({id:"IZ95jb",defaultMessage:"Datasets"}),value:R.map((e=>e.name)),multiSelect:!0,children:(0,h.FD)(r.LegacyTooltip,{title:!W&&(0,h.Y)(c.A,{id:"v8UFxB",defaultMessage:"No datasets were recorded for this experiment's runs."}),children:[(0,h.Y)(r.DialogComboboxTrigger,{allowClear:!0,onClear:()=>w({datasetsFilter:[]}),"data-testid":"datasets-select-dropdown",showTagAfterValueCount:1,disabled:!W}),W&&(0,h.Y)(r.DialogComboboxContent,{maxHeight:600,children:(0,h.Y)(r.DialogComboboxOptionList,{children:(0,h.Y)(r.DialogComboboxOptionListSearch,{children:j.map((e=>(0,h.FD)(r.DialogComboboxOptionListCheckboxItem,{checked:R.some((t=>(0,te.R)(t,e))),title:e.name,"data-testid":`dataset-dropdown-${e.name}`,value:e.name,onChange:()=>(e=>{const t=R.some((t=>(0,te.R)(t,e)))?R.filter((t=>!(0,te.R)(t,e))):[...R,e];w({datasetsFilter:t})})(e),children:[e.name," (",e.digest,")"," ",e.context&&(0,h.Y)(r.Tag,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_329",css:(0,o.AH)({textTransform:"capitalize",marginRight:U.spacing.xs},""),children:e.context})]},e.name+e.digest+e.context)))})})})]})}),m]}),(0,h.FD)("div",{css:(0,o.AH)({display:"flex",gap:U.spacing.sm,alignItems:"flex-start"},""),children:[(0,h.FD)(r.DropdownMenu.Root,{modal:!1,children:[(0,h.Y)(r.DropdownMenu.Trigger,{asChild:!0,children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_338",icon:(0,h.Y)(r.OverflowIcon,{}),"aria-label":E.formatMessage({id:"E5gbt5",defaultMessage:"More options"})})}),(0,h.FD)(r.DropdownMenu.Content,{children:[(0,h.FD)(r.DropdownMenu.Item,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_362",className:"csv-button",onClick:u,children:[(0,h.Y)(r.DropdownMenu.IconWrapper,{children:(0,h.Y)(r.DownloadIcon,{})}),`Download ${n.runInfos.length} runs`]}),(0,h.Y)(r.DropdownMenu.Separator,{}),(0,h.FD)(r.DropdownMenu.CheckboxItem,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_382",checked:x,onClick:()=>k((e=>({...e,hideEmptyCharts:!e.hideEmptyCharts}))),children:[(0,h.Y)(r.DropdownMenu.ItemIndicator,{}),(0,h.Y)(c.A,{id:"lZPbxb",defaultMessage:"Hide charts with no data"})]}),(0,H.Hn)()&&(0,h.FD)(h.FK,{children:[(0,h.Y)(r.DropdownMenu.Separator,{}),(0,h.FD)(r.DropdownMenu.CheckboxItem,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_402",checked:y,onClick:()=>k((e=>({...e,autoRefreshEnabled:!e.autoRefreshEnabled}))),children:[(0,h.Y)(r.DropdownMenu.ItemIndicator,{}),(0,h.Y)(c.A,{id:"YamyaP",defaultMessage:"Auto-refresh"})]})]})]})]}),(0,h.Y)(re,{isOpen:F,closeModal:()=>B(!1),experimentId:t}),G&&(0,h.Y)(r.LegacyTooltip,{title:E.formatMessage({id:"eZOxx1",defaultMessage:"Toggle the preview sidepane"}),useAsLabel:!0,children:(0,h.Y)(K.k,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_403",pressed:i.previewPaneVisible,icon:(0,h.Y)(r.SidebarIcon,{}),onClick:()=>l({previewPaneVisible:!i.previewPaneVisible})})}),!(0,H.Hn)()&&(0,h.Y)(q,{refreshRuns:g}),!I&&(0,h.FD)(r.DropdownMenu.Root,{children:[(0,h.Y)(r.DropdownMenu.Trigger,{asChild:!0,children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_415",icon:(0,h.Y)(r.PlusIcon,{}),children:(0,h.Y)(c.A,{id:"PEYesH",defaultMessage:"New run"})})}),(0,h.FD)(r.DropdownMenu.Content,{children:[(0,H.Ii)()&&(0,h.FD)(r.DropdownMenu.Item,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_461",onSelect:()=>L(),children:[" ",(0,h.Y)(c.A,{id:"UmwZQv",defaultMessage:"using Prompt Engineering"}),(0,h.Y)(se.W,{})]}),(0,h.FD)(r.DropdownMenu.Item,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrolsfilters.tsx_469",onSelect:()=>B(!0),children:[" ",(0,h.Y)(c.A,{id:"vNRmQa",defaultMessage:"using Notebook"})]})]})]})]})]})}));var nt=n(35286);const ot="GROUP",at=(0,_.GF)(ot,d.RO.ATTRIBUTES),rt=(0,_.GF)(ot,d.RO.PARAMS),st=(0,_.GF)(ot,d.RO.METRICS),it=(0,_.GF)(ot,d.RO.TAGS),lt=(e,t)=>e.filter((e=>e.toLowerCase().includes(t.toLowerCase()))),dt=(e,t)=>{if(!t)return e;const n=e.toLowerCase().indexOf(t.toLowerCase()),o=e.substring(0,n),a=e.substring(n,n+t.length),r=e.substring(n+t.length);return n>-1?(0,h.FD)("span",{children:[o,(0,h.Y)("strong",{children:a}),r]}):e},ct=s.memo((({runsData:e,columnSelectorVisible:t,onChangeColumnSelectorVisible:n,selectedColumns:i})=>{const l=(0,et.e)(),u=(0,z.z)(),[p,m]=(0,s.useState)(""),{theme:g}=(0,a.u)(),f=(0,s.useRef)(null),v=(0,s.useRef)(null),y=(0,s.useRef)(null),x=(0,s.useMemo)((()=>(e=>{const t=[d.qo.USER,d.qo.SOURCE,d.qo.VERSION,d.qo.MODELS,d.qo.DESCRIPTION];return e&&t.unshift(d.qo.EXPERIMENT_NAME),t.unshift(d.qo.DATASET),t})(u.length>1)),[u.length]),b=(0,s.useCallback)((e=>l((t=>{const n=e(t.selectedColumns),o=Array.from(new Set(n));return{...t,selectedColumns:o}}))),[l]),C=(0,s.useMemo)((()=>w.A.getVisibleTagKeyList(e.tagsList)),[e]),Y=(0,s.useMemo)((()=>({[d.RO.ATTRIBUTES]:x.map((e=>(0,_.GF)(d.RO.ATTRIBUTES,e))),[d.RO.PARAMS]:e.paramKeyList.map((e=>(0,_.GF)(d.RO.PARAMS,e))),[d.RO.METRICS]:e.metricKeyList.map((e=>(0,_.GF)(d.RO.METRICS,e))),[d.RO.TAGS]:C.map((e=>(0,_.GF)(d.RO.TAGS,e)))})),[e,x,C]),k=(0,s.useMemo)((()=>{const t=[],n=lt(x,p),o=lt(e.paramKeyList,p),a=lt(e.metricKeyList,p),r=lt(C,p);return n.length&&t.push({key:at,title:"Attributes",children:n.map((e=>({key:(0,_.GF)(d.RO.ATTRIBUTES,e),title:dt(e,p)})))}),a.length&&t.push({key:st,title:`Metrics (${a.length})`,children:a.map((e=>{var t;const n=nt.g[e];return{key:(0,_.GF)(d.RO.METRICS,e),title:dt(null!==(t=null===n||void 0===n?void 0:n.displayName)&&void 0!==t?t:e,p)}}))}),o.length&&t.push({key:rt,title:`Parameters (${o.length})`,children:o.map((e=>({key:(0,_.GF)(d.RO.PARAMS,e),title:dt(e,p)})))}),r.length&&t.push({key:it,title:`Tags (${r.length})`,children:r.map((e=>({key:(0,_.GF)(d.RO.TAGS,e),title:e})))}),t}),[x,p,e,C]),I=(0,s.useCallback)(((e,t)=>{b(e?e=>e.filter((e=>!t.includes(e))):e=>[...e,...t])}),[b]),A=(0,s.useCallback)(((e,t)=>{b(t?t=>t.filter((t=>t!==e)):t=>[...t,e])}),[b]);(0,s.useEffect)((()=>{t&&(m(""),requestAnimationFrame((()=>{var e,t;null===v||void 0===v||null===(e=v.current)||void 0===e||e.scrollTo(0,0),null===(t=f.current)||void 0===t||t.focus({preventScroll:!0}),y.current&&y.current.scrollIntoView({block:"nearest",behavior:"smooth"})})))}),[t]);const S=(0,s.useCallback)(((e,{node:{key:t,checked:n}})=>{if((0,_.tG)(t.toString(),ot)){const e=(0,_.dz)(t.toString(),ot),o=Y[e];o&&I(n,lt(o,p))}else A(t.toString(),n)}),[Y,I,A,p]),R=(0,s.useCallback)((e=>{if("ArrowDown"===e.key){const e=(null===(t=v.current)||void 0===t?void 0:t.querySelector('[role="tree"] input'))||null;e&&e.focus()}var t}),[]),D=(0,h.FD)("div",{css:(0,o.AH)({backgroundColor:g.colors.backgroundPrimary,width:400,border:"1px solid",borderColor:g.colors.border,[g.responsive.mediaQueries.xs]:{width:"100vw"}},""),onKeyDown:e=>{var t;"Escape"===e.key&&(n(!1),null===(t=y.current)||void 0===t||t.focus())},children:[(0,h.Y)("div",{css:e=>({padding:e.spacing.md}),children:(0,h.Y)(M.I,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscolumnselector.tsx_300",value:p,prefix:(0,h.Y)(M.S,{}),placeholder:"Search columns",allowClear:!0,ref:f,onChange:e=>{m(e.target.value)},onKeyDown:R})}),(0,h.Y)("div",{ref:v,css:(0,o.AH)({maxHeight:480,overflowY:"scroll",overflowX:"hidden",paddingBottom:g.spacing.md,"span[title]":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},[g.responsive.mediaQueries.xs]:{maxHeight:"calc(100vh - 100px)"}},""),children:(0,h.Y)(r.Tree,{"data-testid":"column-selector-tree",mode:"checkable",dangerouslySetAntdProps:{checkedKeys:i,onCheck:S},defaultExpandedKeys:[at,rt,st,it],treeData:k})})]});return(0,h.Y)(r.Dropdown,{overlay:D,placement:"bottomLeft",trigger:["click"],visible:t,onVisibleChange:n,children:(0,h.FD)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscolumnselector.tsx_315",ref:y,style:{display:"flex",alignItems:"center"},"data-testid":"column-selection-dropdown",icon:(0,h.Y)(r.ColumnsIcon,{}),children:[(0,h.Y)(c.A,{id:"ny+fBZ",defaultMessage:"Columns"})," ",(0,h.Y)(r.ChevronDownIcon,{})]})})}));var ut=n(72069),pt=n(62862),mt=n(12772);const gt=(0,fe.YK)({minimum:{id:"iT8ODo",defaultMessage:"Minimum"},maximum:{id:"au61Yy",defaultMessage:"Maximum"},average:{id:"/LfvdB",defaultMessage:"Average"},attributes:{id:"cy9EfG",defaultMessage:"Attributes"},tags:{id:"LEiN8m",defaultMessage:"Tags"},params:{id:"i9OADf",defaultMessage:"Params"},dataset:{id:"RtKhwd",defaultMessage:"Dataset"},noParams:{id:"Q73eXs",defaultMessage:"No params"},noTags:{id:"jHWRLw",defaultMessage:"No tags"},aggregationTooltip:{id:"fKx4kG",defaultMessage:"Aggregation: {value}"},noResults:{id:"aaVp/T",defaultMessage:"No results"}});var ht={name:"9q39xd",styles:"min-width:32px"},ft={name:"o5v4ro",styles:"max-height:400px;overflow-y:scroll"};const vt=({runsData:e,onChange:t,groupBy:n,useGroupedValuesInCharts:i,onUseGroupedValuesInChartsChange:l})=>{const d=(0,V.A)(),u=(0,s.useRef)(null),p=(0,s.useRef)(null),m=(0,s.useRef)(null),g=(0,s.useRef)(null),f=d.formatMessage(gt.minimum),v=d.formatMessage(gt.maximum),_=d.formatMessage(gt.average),y=d.formatMessage(gt.dataset),x=(0,s.useMemo)((()=>(0,E.uniq)((0,E.values)(e.tagsList).flatMap((e=>(0,E.keys)(e).filter((e=>!e.startsWith(A.nt))))))),[e.tagsList]),{aggregateFunction:b=mt.it.Average,groupByKeys:w=[]}=n||{},C={min:f,max:v,average:_}[b],{theme:Y}=(0,a.u)(),[k,I]=(0,s.useState)("");(0,s.useEffect)((()=>{requestAnimationFrame((()=>{g.current.focus()}))}),[]);const S=x.filter((e=>e.toLowerCase().includes(k.toLowerCase()))),R=e.paramKeyList.filter((e=>e.toLowerCase().includes(k.toLowerCase()))),D=(0,s.useMemo)((()=>!(0,E.isEmpty)((0,E.compact)(e.datasetsList))),[e.datasetsList])&&y.toLowerCase().includes(k.toLowerCase()),T=S.length>0||R.length>0||D,L=(0,s.useCallback)(((e,n,o)=>{if(o){const o=[...w];o.some((t=>t.mode===e&&t.groupByData===n))||o.push({mode:e,groupByData:n}),t({aggregateFunction:b,groupByKeys:o})}else{const o=w.filter((t=>!(t.mode===e&&t.groupByData===n)));if(!o.length)return void t(null);t({aggregateFunction:b,groupByKeys:o})}}),[b,w,t]);return(0,h.FD)(h.FK,{children:[(0,h.FD)("div",{css:(0,o.AH)({display:"flex",gap:Y.spacing.xs,padding:Y.spacing.sm},""),children:[(0,h.Y)(M.I,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsgroupbyselector.tsx_191",value:k,onChange:e=>I(e.target.value),prefix:(0,h.Y)(M.S,{}),placeholder:"Search",autoFocus:!0,ref:g,onKeyDown:e=>{if("ArrowDown"!==e.key&&"Tab"!==e.key)"Escape"!==e.key&&e.stopPropagation();else{const e=u.current||p.current||m.current;null===e||void 0===e||e.focus()}}}),(0,h.FD)(r.DropdownMenu.Root,{children:[(0,h.Y)(r.LegacyTooltip,{placement:"right",title:(0,h.Y)(c.A,{...gt.aggregationTooltip,values:{value:C||b}}),children:(0,h.Y)(r.DropdownMenu.Trigger,{asChild:!0,children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsgroupbyselector.tsx_168",icon:(0,h.Y)(r.GearIcon,{}),css:ht,"aria-label":"Change aggregation function"})})}),(0,h.FD)(r.DropdownMenu.Content,{align:"start",side:"right",children:[(0,H.Bh)()&&(0,h.FD)(h.FK,{children:[(0,h.FD)(r.DropdownMenu.CheckboxItem,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsgroupbyselector.tsx_233",disabled:!w.length,checked:i,onCheckedChange:l,children:[(0,h.Y)(r.DropdownMenu.ItemIndicator,{}),"Use grouping from the runs table in charts"]}),(0,h.Y)(r.DropdownMenu.Separator,{})]}),(0,h.FD)(r.DropdownMenu.RadioGroup,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsgroupbyselector.tsx_244",value:b,onValueChange:e=>{if((0,E.values)(mt.it).includes(e)){const o=e,a={...n,aggregateFunction:o};t(a)}},children:[(0,h.FD)(r.DropdownMenu.RadioItem,{disabled:!w.length,value:mt.it.Min,children:[(0,h.Y)(r.DropdownMenu.ItemIndicator,{}),f]},mt.it.Min),(0,h.FD)(r.DropdownMenu.RadioItem,{disabled:!w.length,value:mt.it.Max,children:[(0,h.Y)(r.DropdownMenu.ItemIndicator,{}),v]},mt.it.Max),(0,h.FD)(r.DropdownMenu.RadioItem,{disabled:!w.length,value:mt.it.Average,children:[(0,h.Y)(r.DropdownMenu.ItemIndicator,{}),_]},mt.it.Average)]})]})]})]}),(0,h.FD)(r.DropdownMenu.Group,{css:ft,children:[D&&(0,h.FD)(h.FK,{children:[(0,h.Y)(r.DropdownMenu.Label,{children:(0,h.Y)(c.A,{...gt.attributes})}),y.toLowerCase().includes(k.toLowerCase())&&(0,h.FD)(r.DropdownMenu.CheckboxItem,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsgroupbyselector.tsx_280",checked:(0,pt.sd)(n,mt.uq.Dataset,"dataset"),ref:u,onCheckedChange:e=>L(mt.uq.Dataset,"dataset",e),children:[(0,h.Y)(r.DropdownMenu.ItemIndicator,{}),y]},(0,pt._p)(mt.uq.Dataset,"dataset",b)),(0,h.Y)(r.DropdownMenu.Separator,{})]}),S.length>0&&(0,h.FD)(h.FK,{children:[(0,h.Y)(r.DropdownMenu.Label,{children:(0,h.Y)(c.A,{...gt.tags})}),S.map(((e,t)=>{const o=(0,pt._p)(mt.uq.Tag,e,b);return(0,h.FD)(r.DropdownMenu.CheckboxItem,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsgroupbyselector.tsx_302",checked:(0,pt.sd)(n,mt.uq.Tag,e),ref:0===t?p:void 0,onCheckedChange:t=>L(mt.uq.Tag,e,t),children:[(0,h.Y)(r.DropdownMenu.ItemIndicator,{}),e]},o)})),!x.length&&(0,h.FD)(r.DropdownMenu.Item,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsgroupbyselector.tsx_314",disabled:!0,children:[(0,h.Y)(r.DropdownMenu.ItemIndicator,{})," ",(0,h.Y)(c.A,{...gt.noTags})]}),(0,h.Y)(r.DropdownMenu.Separator,{})]}),R.length>0&&(0,h.FD)(h.FK,{children:[(0,h.Y)(r.DropdownMenu.Label,{children:(0,h.Y)(c.A,{...gt.params})}),R.map(((e,t)=>{const o=(0,pt._p)(mt.uq.Param,e,b);return(0,h.FD)(r.DropdownMenu.CheckboxItem,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsgroupbyselector.tsx_330",checked:(0,pt.sd)(n,mt.uq.Param,e),ref:0===t?m:void 0,onCheckedChange:t=>L(mt.uq.Param,e,t),children:[(0,h.Y)(r.DropdownMenu.ItemIndicator,{}),e]},o)})),!e.paramKeyList.length&&(0,h.Y)(r.DropdownMenu.Item,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsgroupbyselector.tsx_342",disabled:!0,children:(0,h.Y)(c.A,{...gt.noParams})})]}),!T&&(0,h.Y)(r.DropdownMenu.Item,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsgroupbyselector.tsx_349",disabled:!0,children:(0,h.Y)(c.A,{...gt.noResults})})]})]})};var _t={name:"taqmwb",styles:"margin-left:4px;margin-right:0"};const yt=s.memo((({runsData:e,groupBy:t,isLoading:n,onChange:s,useGroupedValuesInCharts:i,onUseGroupedValuesInChartsChange:l})=>{const{theme:d}=(0,a.u)(),u=(0,pt.Zp)(t)||{aggregateFunction:mt.it.Average,groupByKeys:[]},p=u&&!(0,E.isEmpty)(u.groupByKeys);return(0,h.FD)(r.DropdownMenu.Root,{modal:!1,children:[(0,h.Y)(r.DropdownMenu.Trigger,{asChild:!0,children:(0,h.FD)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsgroupbyselector.tsx_306",icon:(0,h.Y)(r.ListBorderIcon,{}),style:{display:"flex",alignItems:"center"},"data-testid":"column-selection-dropdown",endIcon:(0,h.Y)(r.ChevronDownIcon,{}),children:[p?(0,h.Y)(c.A,{id:"AFI74W",defaultMessage:"Group by: {value}",values:{value:u.groupByKeys[0].groupByData}}):(0,h.Y)(c.A,{id:"fjM/KK",defaultMessage:"Group by"}),u.groupByKeys.length>1&&(0,h.FD)(r.Tag,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsgroupbyselector.tsx_426",css:_t,children:["+",u.groupByKeys.length-1]}),t&&(0,h.Y)(M.X,{"aria-hidden":"false",css:(0,o.AH)({color:d.colors.textPlaceholder,fontSize:d.typography.fontSizeSm,marginLeft:d.spacing.sm,":hover":{color:d.colors.actionTertiaryTextHover}},""),role:"button",onClick:()=>{s(null)},onPointerDownCapture:e=>{e.stopPropagation()}})]})}),(0,h.Y)(r.DropdownMenu.Content,{children:n?(0,h.Y)(r.DropdownMenu.Item,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunsgroupbyselector.tsx_436",children:(0,h.Y)(a.S,{})}):(0,h.Y)(vt,{groupBy:u,onChange:s,runsData:e,onUseGroupedValuesInChartsChange:l,useGroupedValuesInCharts:i})})]})}));var xt=n(45653);var bt={name:"1kxd8xu",styles:"max-height:400px;overflow-y:auto"},wt={name:"1j5vobt",styles:"display:flex;align-items:center;gap:4px"};const Ct=({sortOptions:e,orderByKey:t,orderByAsc:n,onOptionSelected:i})=>{const{theme:l}=(0,a.u)(),d=(0,Xe.Px)(),u=(0,et.e)(),p=(0,s.useRef)(null),[m,g]=(0,s.useState)(""),f=(0,s.useRef)(null),v=(0,s.useMemo)((()=>e.filter((e=>e.label.toLowerCase().includes(m.toLowerCase())))),[e,m]),_=e=>{d({orderByAsc:e}),i()};return(0,s.useEffect)((()=>{requestAnimationFrame((()=>{var e;null===(e=p.current)||void 0===e||e.focus()}))}),[]),(0,h.FD)(h.FK,{children:[(0,h.FD)("div",{css:(0,o.AH)({padding:`${l.spacing.sm}px ${l.spacing.lg/2}px ${l.spacing.sm}px`,width:"100%",display:"flex",gap:l.spacing.xs},""),children:[(0,h.Y)(M.I,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunssortselectorv2.tsx_97",prefix:(0,h.Y)(M.S,{}),value:m,type:"search",onChange:e=>g(e.target.value),placeholder:"Search",autoFocus:!0,ref:p,onKeyDown:e=>{var t;"ArrowDown"!==e.key&&"Tab"!==e.key?e.stopPropagation():null===(t=f.current)||void 0===t||t.focus()}}),(0,h.FD)("div",{css:(0,o.AH)({display:"flex",gap:l.spacing.xs},""),children:[(0,h.Y)(K.k,{pressed:!n,icon:(0,h.Y)(r.ArrowDownIcon,{}),componentId:"mlflow.experiment_page.sort_select_v2.sort_desc",onClick:()=>_(!1),"aria-label":"Sort descending","data-testid":"sort-select-desc"}),(0,h.Y)(K.k,{pressed:n,icon:(0,h.Y)(r.ArrowUpIcon,{}),componentId:"mlflow.experiment_page.sort_select_v2.sort_asc",onClick:()=>_(!0),"aria-label":"Sort ascending","data-testid":"sort-select-asc"})]})]}),(0,h.FD)(r.DropdownMenu.Group,{css:bt,children:[v.map(((e,n)=>(0,h.FD)(r.DropdownMenu.CheckboxItem,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunssortselectorv2.tsx_137",onClick:()=>(e=>{d({orderByKey:e}),u((t=>t.selectedColumns.includes(e)?t:{...t,selectedColumns:[...t.selectedColumns,e]})),i()})(e.value),checked:e.value===t,"data-testid":`sort-select-${e.label}`,ref:0===n?f:void 0,children:[(0,h.Y)(r.DropdownMenu.ItemIndicator,{}),(0,h.Y)("span",{css:wt,children:(0,xt.fx)(e.label,50)})]},e.value))),!v.length&&(0,h.Y)(r.DropdownMenu.Item,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunssortselectorv2.tsx_151",disabled:!0,children:(0,h.Y)(c.A,{id:"EkUD0b",defaultMessage:"No results"})})]})]})};var Yt={name:"9q39xd",styles:"min-width:32px"};const kt=s.memo((({metricKeys:e,paramKeys:t,orderByAsc:n,orderByKey:o})=>{const i=(0,V.A)(),[l,c]=(0,s.useState)(!1),{theme:u}=(0,a.u)(),p=(0,s.useMemo)((()=>Object.keys(d.Eg).map((e=>({label:d.Eg[e],value:d.T8[e]})))),[]),m=(0,s.useMemo)((()=>e.map((e=>{var t,n;const o=(0,_.GF)(d.RO.METRICS,e);return{label:null!==(t=null===(n=nt.g[e])||void 0===n?void 0:n.displayName)&&void 0!==t?t:e,value:o}}))),[e]),g=(0,s.useMemo)((()=>t.map((e=>({label:e,value:`${(0,_.GF)(d.RO.PARAMS,e)}`})))),[t]),f=(0,s.useMemo)((()=>[...p,...m,...g]),[p,m,g]),v=(0,s.useMemo)((()=>{const e=f.find((e=>e.value===o));let t=null===e||void 0===e?void 0:e.label;if(!t){const e=o.match(/^.+\.`(.+)`$/);e&&(t=e[1])}return`${i.formatMessage({id:"sKaamx",defaultMessage:"Sort"})}: ${t}`}),[f,i,o]);return(0,h.FD)(r.DropdownMenu.Root,{open:l,onOpenChange:c,modal:!1,children:[(0,h.Y)(r.DropdownMenu.Trigger,{"data-testid":"sort-select-dropdown",asChild:!0,children:(0,h.Y)(a.B,{componentId:"mlflow.experiment_page.sort_select_v2.toggle",icon:n?(0,h.Y)(r.SortAscendingIcon,{}):(0,h.Y)(r.SortDescendingIcon,{}),css:Yt,"aria-label":v,endIcon:(0,h.Y)(r.ChevronDownIcon,{}),children:v})}),(0,h.Y)(r.DropdownMenu.Content,{minWidth:250,children:(0,h.Y)(Ct,{sortOptions:f,orderByKey:o,orderByAsc:n,onOptionSelected:()=>c(!1)})})]})})),It=s.memo((({runsData:e,viewState:t,updateViewState:n,searchFacetsState:i,experimentId:l,requestError:u,expandRows:p,updateExpandRows:m,refreshRuns:g,uiState:f,isLoading:v,isComparingExperiments:y})=>{var x;const[b,C]=(0,Be.an)(),{paramKeyList:Y,metricKeyList:k,tagsList:I}=e,{orderByAsc:A,orderByKey:S}=i,M=(0,et.e)(),R="TABLE"!==b,D="ARTIFACT"===b,{theme:T}=(0,a.u)(),E=Y,L=k,F=w.A.getVisibleTagKeyList(I),B=(0,s.useCallback)((()=>(0,_.D1)(e,F,E,L)),[L,E,F,e]),U=(((e,t)=>{(0,s.useMemo)((()=>{let n=[];const o=[d.mh,d.KU];return n=[...Object.keys(d.Eg).reduce(((e,t)=>{const n=d.Eg[t];return o.forEach((o=>{e.push({label:n,value:d.T8[t]+d.KE+o,order:o})})),e}),[]),...e.reduce(((e,t)=>(o.forEach((n=>{e.push({label:t,value:`${(0,_.GF)(d.RO.METRICS,t)}${d.KE}${n}`,order:n})})),e)),[]),...t.reduce(((e,t)=>(o.forEach((n=>{e.push({label:t,value:`${(0,_.GF)(d.RO.PARAMS,t)}${d.KE}${n}`,order:n})})),e)),[])],n}),[e,t])})(L,E),Object.values(t.runsSelected).filter(Boolean).length),N=U>1||1===U||U>0,P=!D,V=(0,s.useCallback)((e=>n({columnSelectorVisible:e})),[n]),K=(0,s.useCallback)((()=>m(!p)),[p,m]),z=(0,s.useMemo)((()=>e.datasetsList.some((e=>(null===e||void 0===e?void 0:e.length)>1))),[e]);return(0,h.FD)("div",{css:(0,o.AH)({display:"flex",gap:T.spacing.sm,flexDirection:"column",marginBottom:T.spacing.sm},""),children:[!(0,H.w7)()&&!y&&(0,h.Y)(ut.W,{hideBorder:!1,viewState:t,runsAreGrouped:Boolean(f.groupBy)}),N&&(0,h.Y)(O,{runsData:e,searchFacetsState:i,viewState:t,refreshRuns:g}),!N&&(0,h.Y)(tt,{onDownloadCsv:B,searchFacetsState:i,experimentId:l,viewState:t,updateViewState:n,runsData:e,requestError:u,refreshRuns:g,viewMaximized:f.viewMaximized,autoRefreshEnabled:f.autoRefreshEnabled,hideEmptyCharts:f.hideEmptyCharts,areRunsGrouped:Boolean(f.groupBy),additionalControls:(0,h.FD)(h.FK,{children:[(0,h.Y)(kt,{orderByAsc:A,orderByKey:S,metricKeys:L,paramKeys:E}),!R&&(0,h.Y)(ct,{columnSelectorVisible:t.columnSelectorVisible,onChangeColumnSelectorVisible:V,runsData:e,selectedColumns:f.selectedColumns}),!R&&z&&(0,h.Y)(r.ToggleButton,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewrunscontrols.tsx_175",onClick:K,children:(0,h.Y)(c.A,{id:"mRc7MY",defaultMessage:"Expand rows"})}),P&&(0,h.Y)(yt,{groupBy:f.groupBy,onChange:e=>{M((t=>({...t,groupBy:e})))},runsData:e,isLoading:v,useGroupedValuesInCharts:null===(x=f.useGroupedValuesInCharts)||void 0===x||x,onUseGroupedValuesInChartsChange:e=>{M((t=>({...t,useGroupedValuesInCharts:e})))}})]})})]})}));var At=n(40037);class St{constructor(){this.runsSelected={},this.hiddenChildRunsSelected={},this.columnSelectorVisible=!1,this.previewPaneVisible=!1,this.artifactViewState={selectedTables:[],groupByCols:[],outputColumn:"",intersectingOnly:!1}}}var Mt=n(57368);const Rt="FETCHED_RUN_NOTIFICATION_KEY",Dt=e=>{const{formatMessage:t}=(0,V.A)(),n=(0,s.useCallback)(((e,n)=>e===n?t({id:"KJbYrw",defaultMessage:"Loaded {childRuns} child {childRuns, plural, =1 {run} other {runs}}"},{childRuns:n}):t({id:"ziIhFQ",defaultMessage:"Loaded {allRuns} {allRuns, plural, =1 {run} other {runs}}, including {childRuns} child {childRuns, plural, =1 {run} other {runs}}"},{allRuns:e,childRuns:n})),[t]);return(0,s.useCallback)(((t,o)=>{if(Array.isArray(t)){const{allRuns:a,childRuns:r}=((e,t=[])=>{const n=e.filter((e=>!t.some((t=>t.runUuid===e.info.runUuid)))),o=n.filter((e=>{var t;const n=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.tags;return Array.isArray(n)&&n.some((e=>e.key===_.Ol&&Boolean(e.value)))}));return{allRuns:n.length,childRuns:o.length}})(t,o);if(r<1)return;e.close(Rt),e.info({message:n(a,r),duration:3,placement:"bottomRight",key:Rt})}}),[e,n])};var Tt=n(85343),Et=n(28380),Lt=n(51293);const Ft=s.createContext({getMissingParams:()=>[],pendingDataLoading:{},getEvaluableRowCount:()=>0,evaluateCell:()=>{},evaluateAllClick:()=>{},runColumnsBeingEvaluated:[],canEvaluateInRunColumn:()=>!1,toggleExpandedHeader:()=>{},isHeaderExpanded:!1}),Bt=({tableData:e,outputColumn:t,children:n})=>{const o=(0,V.A)(),[a,r]=(0,s.useState)(!1),i=(0,s.useCallback)((()=>r((e=>!e))),[]),l=(0,s.useCallback)(((t,n)=>{if(!(0,he.o1)(t))return null;const o=e.find((e=>e.key===n));if(!o)return null;const{promptTemplate:a}=(0,he.vC)(t);if(!a)return null;return(0,he.rl)(a).filter((e=>!o.groupByCellValues[e]))}),[e]),d=(0,v.wA)(),{startEvaluatingRunColumn:c,stopEvaluatingRunColumn:u,runColumnsBeingEvaluated:p}=((e,t)=>{const n=(0,s.useRef)(e),o=(0,s.useRef)([]),a=(0,V.A)();(0,s.useEffect)((()=>{n.current=e}),[e]);const[r,i]=(0,s.useState)([]);(0,s.useEffect)((()=>{o.current=r}),[r]);const l=(0,v.wA)(),d=(0,s.useCallback)((e=>{const r=n.current,{parameters:s,promptTemplate:c,routeName:u,routeType:p}=(0,he.vC)(e);if(!c)return;const m=(0,he.rl)(c),g=r.find((t=>!t.cellValues[e.runUuid]&&((e,t)=>0===t.filter((t=>!e.groupByCellValues[t])).length)(t,m)));if(!g)return void i((t=>t.filter((t=>t!==e.runUuid))));const h=g.key,f=g.groupByCellValues;if(!c)return;const v=(0,he.TG)(c,f);u&&l(Oe({routeName:u,routeType:p,compiledPrompt:v,inputValues:f,outputColumn:t,rowKey:h,parameters:s,run:e})).then((()=>{o.current.includes(e.runUuid)&&d(e)})).catch((t=>{const n=He(t),o=a.formatMessage({id:"jI22Qu",defaultMessage:'Gateway returned the following error: "{errorMessage}"'},{errorMessage:n});w.A.logErrorAndNotifyUser(o),i((t=>t.filter((t=>t!==e.runUuid))))}))}),[l,t,a]),c=(0,s.useCallback)((e=>{i((t=>[...t,e.runUuid])),d(e)}),[d]),u=(0,s.useCallback)((e=>{i((t=>t.filter((t=>t!==e.runUuid))))}),[]);return{runColumnsBeingEvaluated:r,startEvaluatingRunColumn:c,stopEvaluatingRunColumn:u}})(e,t),m=(0,v.d4)((({evaluationData:e})=>e.evaluationPendingDataLoadingByRunUuid)),g=(0,s.useCallback)((e=>t===he.hR&&(0,he.o1)(e)),[t]),f=(0,s.useCallback)((t=>e.filter((e=>{if(e.cellValues[t.runUuid])return!1;const n=l(t,e.key);return 0===(null===n||void 0===n?void 0:n.length)})).length),[e,l]),_=(0,s.useCallback)((e=>{p.includes(e.runUuid)?u(e):c(e)}),[p,c,u]),y=(0,s.useCallback)(((n,a)=>{const r=e.find((({key:e})=>e===a));if(!r)return;const s=r.groupByCellValues,{parameters:i,promptTemplate:l,routeName:c,routeType:u}=(0,he.vC)(n);if(!l)return;const p=(0,he.TG)(l,s);if(c){d((()=>Oe({routeName:c,routeType:u,compiledPrompt:p,inputValues:s,outputColumn:t,rowKey:a,parameters:i,run:n}))()).catch((e=>{const t=He(e),n=o.formatMessage({id:"nyHcAz",defaultMessage:'MLflow deployment returned the following error: "{errorMessage}"'},{errorMessage:t});w.A.logErrorAndNotifyUser(n)}))}}),[e,d,t,o]),x=(0,s.useMemo)((()=>({getMissingParams:l,getEvaluableRowCount:f,evaluateCell:y,evaluateAllClick:_,pendingDataLoading:m,canEvaluateInRunColumn:g,runColumnsBeingEvaluated:p,isHeaderExpanded:a,toggleExpandedHeader:i})),[l,f,_,y,m,g,p,a,i]);return(0,h.Y)(Ft.Provider,{value:x,children:n})},Ut=()=>(0,s.useContext)(Ft);var Nt={name:"1h52dri",styles:"overflow:hidden;text-overflow:ellipsis;white-space:nowrap"},Ot={name:"lyel5l",styles:"font-size:0"},Pt={name:"1hetg88",styles:"max-width:300px"};const Ht=({run:e})=>{const{theme:t}=(0,a.u)(),{isHeaderExpanded:n}=Ut(),r=(0,he.vC)(e),s=(0,v.d4)((({modelGateway:e})=>{const t=`${r.routeType}:${r.routeName}`;return r.routeName?e.modelGatewayRoutes[t]:null}));if(!(0,he.o1)(e)||!r)return null;const{parameters:i,promptTemplate:l,routeName:d}=r,{stop:u=[]}=i;return(0,h.FD)("div",{css:(0,o.AH)({marginTop:t.spacing.xs,flex:1,display:"flex",flexDirection:"column",gap:t.spacing.sm,overflowX:"hidden",width:"100%"},""),children:[s&&"mlflowDeployment"in s&&s.mlflowDeployment&&(0,h.Y)(a.T.Hint,{children:s.mlflowDeployment.name}),n&&(0,h.FD)(h.FK,{children:[(0,h.Y)(a.T.Hint,{children:(0,h.Y)(c.A,{id:"HGBit9",defaultMessage:"Temperature: {temperature}",values:i})}),(0,h.Y)(a.T.Hint,{children:(0,h.Y)(c.A,{id:"6K04VZ",defaultMessage:"Max. tokens: {max_tokens}",values:i})}),u.length?(0,h.Y)(a.T.Hint,{css:Nt,children:(0,h.Y)(c.A,{id:"iC2Owx",defaultMessage:"Stop sequences: {stopSequences}",values:{stopSequences:null===u||void 0===u?void 0:u.join(", ")}})}):null,(0,h.Y)("div",{css:Ot,children:(0,h.FD)(a.ax.Root,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheadermodelindicator.tsx_107",children:[(0,h.Y)(a.ax.Trigger,{asChild:!0,children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheadermodelindicator.tsx_115",type:"link",size:"small",css:(0,o.AH)({fontSize:t.typography.fontSizeSm},""),children:(0,h.Y)(c.A,{id:"XX8+x1",defaultMessage:"View prompt template"})})}),(0,h.FD)(a.ax.Content,{css:Pt,children:[(0,h.Y)(a.ax.Arrow,{}),l]})]})})]})]})};var Vt=n(38243);var Kt={name:"1iwgvlm",styles:"flex-shrink:1;flex-grow:1;overflow:hidden"},zt={name:"1kd7iwj",styles:"flex-shrink:0;flex-grow:1;display:flex;align-items:flex-end"};const Gt=({run:e,onDatasetSelected:t})=>{var n;const{theme:r}=(0,a.u)(),i=(0,s.useCallback)((n=>t(n,e)),[t,e]);return(null===(n=e.datasets)||void 0===n?void 0:n.length)<1?null:(0,h.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",gap:r.spacing.xs,overflow:"hidden"},""),children:[(0,h.Y)("div",{css:Kt,children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheaderdatasetindicator.tsx_37",type:"link",onClick:()=>i(e.datasets[0]),children:(0,h.Y)(Vt.E,{datasetWithTags:e.datasets[0],displayTextAsLink:!0,css:(0,o.AH)({marginTop:r.spacing.xs/2,marginBottom:r.spacing.xs/2},"")})})}),e.datasets.length>1&&(0,h.Y)("div",{css:zt,children:(0,h.FD)(a.ax.Root,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheaderdatasetindicator.tsx_51",modal:!1,children:[(0,h.Y)(a.ax.Trigger,{asChild:!0,children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheaderdatasetindicator.tsx_49",size:"small",style:{borderRadius:"8px",width:"40px"},children:(0,h.FD)(a.T.Text,{color:"secondary",children:["+",e.datasets.length-1]})})}),(0,h.Y)(a.ax.Content,{align:"start",children:e.datasets.slice(1).filter(Boolean).map((e=>(0,h.Y)("div",{css:(0,o.AH)({height:r.general.heightSm,display:"flex",alignItems:"center"},""),children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheaderdatasetindicator.tsx_66",type:"link",onClick:()=>i(e),children:(0,h.Y)(Vt.E,{datasetWithTags:e,displayTextAsLink:!0})})},`${e.dataset.name}-${e.dataset.digest}`)))})]})})]})};var jt={name:"1on1b16",styles:"width:100%;height:100%;display:flex;flex-direction:column"};const qt=({children:e,className:t,groupHeaderContent:n=null})=>{const{theme:r}=(0,a.u)();return(0,h.FD)("div",{css:jt,children:[(0,h.Y)("div",{css:(0,o.AH)({width:"100%",flexBasis:40,display:"flex",alignItems:"center",padding:r.spacing.sm,borderBottom:`1px solid ${r.colors.borderDecorative}`},""),className:"header-group-cell",children:n}),(0,h.Y)("div",{css:(0,o.AH)({width:"100%",flex:1,display:"flex",justifyContent:"flex-start",alignItems:"flex-start",padding:r.spacing.xs,borderRight:`1px solid ${r.colors.borderDecorative}`},""),className:t,children:e})]})};var Wt=n(70403),$t=n(79432);var Jt={name:"8xhv84",styles:"width:100%;display:flex"},Qt={name:"ozd7xs",styles:"flex-shrink:0"},Xt={name:"82a6rk",styles:"flex:1"};const Zt=({run:e,onHideRun:t,onDuplicateRun:n,onDatasetSelected:i,groupHeaderContent:l=null})=>{const{theme:d}=(0,a.u)(),{getEvaluableRowCount:u,evaluateAllClick:p,runColumnsBeingEvaluated:f,canEvaluateInRunColumn:v}=Ut(),_=(0,V.A)(),y=u(e),x=(0,Wt.LE)(),b=y>0,w=f.includes(e.runUuid),C=(0,s.useMemo)((()=>b?b&&!w?_.formatMessage({id:"2gmOVq",defaultMessage:"Process {evaluableRowCount} rows without evaluation output"},{evaluableRowCount:y}):null:_.formatMessage({id:"7m2B5x",defaultMessage:"There are no evaluable rows within this column"})),[y,b,w,_]);return(0,h.FD)(qt,{css:(0,o.AH)({justifyContent:"flex-start",padding:d.spacing.sm,paddingBottom:0,paddingTop:d.spacing.sm,flexDirection:"column",gap:d.spacing.xs/2,overflow:"hidden"},""),groupHeaderContent:l,children:[(0,h.FD)("div",{css:Jt,children:[(0,h.FD)("span",{css:(0,o.AH)({display:"flex",gap:d.spacing.sm,alignItems:"center"},""),children:[(0,h.Y)($t.E,{color:x(e.runUuid)}),(0,h.Y)(m.N_,{to:g.Ay.getRunPageRoute(e.experimentId||"",e.runUuid),target:"_blank",children:e.runName})]}),(0,h.Y)("div",{css:(0,o.AH)({flexBasis:d.spacing.sm,flexShrink:0},"")}),(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheadercellrenderer.tsx_112",onClick:()=>t(e.runUuid),size:"small",icon:(0,h.Y)(r.VisibleIcon,{}),css:Qt}),(0,h.Y)("div",{css:Xt}),(0,H.Ii)()&&v(e)&&(0,h.FD)(h.FK,{children:[(0,h.Y)("div",{css:(0,o.AH)({flexBasis:d.spacing.sm},"")}),(0,h.Y)(r.LegacyTooltip,{title:C,children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheadercellrenderer.tsx_118",disabled:!b,size:"small",onClick:()=>p(e),icon:w?(0,h.Y)(r.StopIcon,{}):(0,h.Y)(r.PlayIcon,{}),children:w?(0,h.Y)(c.A,{id:"plw4Kp",defaultMessage:"Stop evaluating"}):(0,h.Y)(c.A,{id:"JnIbS3",defaultMessage:"Evaluate all"})})})]}),(0,h.Y)("div",{css:(0,o.AH)({flexBasis:d.spacing.sm},"")}),(0,H.Ii)()&&(0,he.o1)(e)&&(0,h.FD)(r.DropdownMenu.Root,{modal:!1,children:[(0,h.Y)(r.DropdownMenu.Trigger,{asChild:!0,children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheadercellrenderer.tsx_143",size:"small",icon:(0,h.Y)(r.OverflowIcon,{})})}),(0,h.Y)(r.DropdownMenu.Content,{children:(0,h.Y)(r.DropdownMenu.Item,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationrunheadercellrenderer.tsx_150",onClick:()=>n(e),children:(0,h.Y)(c.A,{id:"1YGQOY",defaultMessage:"Duplicate run"})})})]})]}),(0,H.Ii)()&&(0,he.o1)(e)?(0,h.Y)(Ht,{run:e}):(0,h.Y)(Gt,{run:e,onDatasetSelected:i})]})},en=({disabled:e,isLoading:t,run:n,rowKey:o})=>{const s=(0,he.o1)(n),{evaluateCell:i,getMissingParams:l}=Ut(),d=n&&l(n,o)||null;return d&&d.length>0?(0,h.Y)(r.LegacyTooltip,{title:(0,h.Y)(c.A,{id:"yAuDRt",defaultMessage:'Evaluation is not possible because values for the following inputs cannot be determined: {missingParamList}. Add input columns to the "group by" settings or use "Add row" button to define new parameter set.',values:{missingParamList:(0,h.Y)("code",{children:d.join(", ")})}}),children:(0,h.Y)(S.I,{})}):s?(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationcellevaluatebutton.tsx_59",loading:t,disabled:e,size:"small",onMouseDownCapture:e=>e.stopPropagation(),onClickCapture:e=>{e.stopPropagation(),i(n,o)},icon:(0,h.Y)(r.PlayIcon,{}),children:(0,h.Y)(h.FK,{children:"Evaluate"})}):(0,h.Y)(r.LegacyTooltip,{title:(0,h.Y)(c.A,{id:"MhtxHm",defaultMessage:"You cannot evaluate this cell, this run was not created using served LLM model route"}),children:(0,h.Y)(S.I,{})})};var tn=n(40555);const nn=s.memo((({text:e,highlight:t})=>{const{theme:n}=(0,a.u)();if(!t)return(0,h.Y)(h.FK,{children:e});const r=e.split(new RegExp(`(${t})`,"gi"));return(0,h.Y)(h.FK,{children:r.map(((e,a)=>(0,h.Y)(s.Fragment,{children:e.toLowerCase()===t.toLowerCase()?(0,h.Y)("span",{css:(0,o.AH)({backgroundColor:n.colors.yellow200},""),children:e}):e},a)))})}));var on={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},an={name:"52b6nu",styles:"display:-webkit-box;overflow:hidden;text-overflow:ellipsis;-webkit-box-orient:vertical;-webkit-line-clamp:7"},rn={name:"1jwcxx3",styles:"font-style:italic"};const sn=({value:e,context:t,isGroupByColumn:n,run:i,data:l})=>{var d,u;const{theme:p}=(0,a.u)(),{pendingDataLoading:m,canEvaluateInRunColumn:g}=Ut(),f=(0,v.d4)((({modelGateway:{modelGatewayRoutesLoading:e,modelGatewayRoutesLoadingLegacy:t}})=>e.loading)),_=i&&(null===(d=m[i.runUuid])||void 0===d?void 0:d[null===l||void 0===l?void 0:l.key]),y=i&&(null===(u=l.outputMetadataByRunUuid)||void 0===u?void 0:u[i.runUuid])||null,x=null!==y&&void 0!==y&&y.isPending||l.isPendingInputRow?p.colors.backgroundSecondary:p.colors.backgroundPrimary,b=s.useMemo((()=>{try{return JSON.parse(e)}catch(t){return null}}),[e]);return(0,h.FD)("div",{css:(0,o.AH)({height:"100%",whiteSpace:"normal",padding:p.spacing.sm,overflow:"hidden",position:"relative",cursor:"pointer",backgroundColor:x,"&:hover":{backgroundColor:p.colors.actionDefaultBackgroundHover}},""),children:[_?(0,h.Y)(r.TableSkeleton,{lines:3}):(0,h.Y)(h.FK,{children:e?b?(0,h.Y)(tn.y,{json:JSON.stringify(b,null,2)}):(0,h.Y)("span",{css:an,children:n&&t.highlightedText?(0,h.Y)(nn,{text:e,highlight:t.highlightedText}):"string"===typeof e?e.substring(0,512):"object"!==typeof e&&e}):(0,h.Y)(a.T.Text,{color:"info",css:on,children:(0,h.Y)(c.A,{id:"aQxQIF",defaultMessage:"(empty)"})})}),(0,H.Ii)()&&i&&g(i)&&(0,h.FD)("div",{css:(0,o.AH)({position:"absolute",left:8,bottom:8,right:8,display:"flex",gap:p.spacing.sm,alignItems:"center",justifyContent:"space-between"},""),children:[(0,h.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",gap:p.spacing.xs},""),children:[!e&&(0,h.Y)(en,{disabled:_,isLoading:f,run:i,rowKey:l.key}),((null===y||void 0===y?void 0:y.isPending)||l.isPendingInputRow)&&(0,h.Y)(a.T.Hint,{size:"sm",css:rn,children:(0,h.Y)(c.A,{id:"2fvQaF",defaultMessage:"Unsaved"})})]}),y&&!_&&(0,h.FD)("div",{css:(0,o.AH)({display:"flex",gap:p.spacing.xs,alignItems:"center"},""),children:[y.evaluationTime&&(0,h.FD)(a.T.Hint,{size:"sm",children:[Math.round(y.evaluationTime)," ms",y.totalTokens?",":""]}),y.totalTokens&&(0,h.Y)(a.T.Hint,{size:"sm",children:(0,h.Y)(c.A,{id:"/nPZbt",defaultMessage:"{totalTokens} total tokens",values:{totalTokens:y.totalTokens}})})]})]})]})},ln={initialWidthGroupBy:200,initialWidthOutput:360,maxWidth:500,minWidth:140};var dn={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"};const cn=({displayName:e})=>{const{theme:t}=(0,a.u)();return(0,h.Y)(qt,{css:(0,o.AH)({justifyContent:"flex-start",padding:t.spacing.sm},""),children:(0,h.Y)(r.LegacyTooltip,{title:(0,E.truncate)(e,{length:250}),children:(0,h.Y)(a.T.Text,{bold:!0,css:dn,children:e})})})};var un={name:"l8l8b8",styles:"white-space:nowrap;overflow:hidden;text-overflow:ellipsis"};const pn={svg:{width:20,height:20}},mn=()=>{const{toggleExpandedHeader:e,isHeaderExpanded:t}=Ut();return(0,h.Y)(qt,{children:(0,h.Y)(r.LegacyTooltip,{placement:"right",title:(0,h.Y)(c.A,{id:"lDGQGa",defaultMessage:"Toggle detailed view"}),children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationtableactionscolumnrenderer.tsx_22",icon:t?(0,h.Y)(r.ChevronDownIcon,{css:pn}):(0,h.Y)(a.q,{css:pn}),onClick:e})})})},gn=({onAddNewInputs:e,displayAddNewInputsButton:t})=>{const{theme:n}=(0,a.u)();return t?(0,h.Y)("div",{css:(0,o.AH)({width:"100%",height:"100%",display:"flex",flexDirection:"column",padding:n.spacing.xs},""),children:(0,h.Y)(r.LegacyTooltip,{placement:"right",title:(0,h.Y)(c.A,{id:"PNfcez",defaultMessage:"Add row"}),children:(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_components_evaluationtableactionscellrenderer.tsx_37",icon:(0,h.Y)(r.PlusIcon,{}),onClick:e})})}):null};var hn=n(54421);var fn={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},vn={name:"pdi3j6",styles:"display:-webkit-box;overflow:hidden;text-overflow:ellipsis;-webkit-box-orient:vertical;-webkit-line-clamp:7;width:100%;height:100%"};const _n=({value:e})=>{const{theme:t}=(0,a.u)(),n=t.colors.backgroundPrimary;return(0,h.Y)("div",{css:(0,o.AH)({height:"100%",whiteSpace:"normal",padding:t.spacing.sm,overflow:"hidden",position:"relative",cursor:"pointer",backgroundColor:n,"&:hover":{backgroundColor:t.colors.actionDefaultBackgroundHover}},""),children:e&&e.url&&e.compressed_url?(0,h.Y)("span",{css:vn,children:(0,h.Y)(hn.TV,{imageUrl:e.url,compressedImageUrl:e.compressed_url})}):(0,h.Y)(a.T.Text,{color:"info",css:fn,children:(0,h.Y)(c.A,{id:"aQxQIF",defaultMessage:"(empty)"})})})};var yn={name:"3ytxc3",styles:"height:100%;overflow:hidden"};const xn=({resultList:e,visibleRuns:t,groupByColumns:n,onCellClick:r,onHideRun:i,onDatasetSelected:l,highlightedText:d="",isPreviewPaneVisible:u,outputColumnName:p,isImageColumn:m})=>{const[g,f]=(0,s.useState)([]),[_,y]=(0,s.useState)(null),x=(0,v.d4)((({evaluationData:e})=>e.evaluationPendingDataByRunUuid)),b=(0,s.useRef)(null),{isHeaderExpanded:w}=Ut(),{createNewRun:C}=Qe(),Y=(0,s.useCallback)((e=>{null===_||void 0===_||_.refreshHeader(),i(e)}),[_,i]),k=(0,s.useCallback)((e=>{null===_||void 0===_||_.refreshHeader(),C(e)}),[C,_]);(0,s.useEffect)((()=>{_&&!u&&_.clearFocusedCell()}),[_,u]),(0,s.useEffect)((()=>{if(!_)return;const e=_.getRenderedNodes();_.refreshCells({force:!0,rowNodes:e})}),[_,x,d]);const{showAddNewInputsModal:I,AddNewInputsModal:A}=(()=>{const[e,t]=(0,s.useState)(!1),[n,r]=(0,s.useState)([]),[i,l]=(0,s.useState)({}),d=(0,s.useMemo)((()=>n.every((({inputName:e})=>i[e]))),[i,n]),[u,p]=(0,s.useState)((async()=>{})),m=(0,s.useCallback)(((e,t)=>{l((n=>({...n,[e]:t})))}),[]),g=(0,s.useCallback)(((e,n)=>{const o=e.filter(he.o1).map((e=>({runName:e.runName,params:(0,he.xP)(e)}))),a=(0,E.uniq)(o.map((({params:e})=>e)).flat()).map((e=>({inputName:e,runNames:(0,E.compact)(o.filter((t=>t.params.includes(e))).map((({runName:e})=>e)))})));t(!0),r(a),l({}),p((()=>n))}),[]),{theme:f}=(0,a.u)();return{showAddNewInputsModal:g,AddNewInputsModal:(0,h.Y)(S.d,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_hooks_useevaluationaddnewinputsmodal.tsx_57",title:(0,h.Y)(c.A,{id:"JnidmZ",defaultMessage:"Add row"}),okButtonProps:{disabled:!d},okText:(0,h.Y)(c.A,{id:"eeLqSn",defaultMessage:"Submit"}),cancelText:(0,h.Y)(c.A,{id:"jwALGI",defaultMessage:"Cancel"}),onOk:()=>{u(i),t(!1)},visible:e,onCancel:()=>t(!1),children:n.map((({inputName:e,runNames:t})=>(0,h.FD)("div",{css:(0,o.AH)({marginBottom:f.spacing.md},""),children:[(0,h.Y)(a.T.Text,{bold:!0,children:e}),(0,h.Y)(a.T.Hint,{css:un,children:(0,h.Y)(c.A,{id:"s35HDG",defaultMessage:"Used by {runNames} {hasMore, select, true {and other runs} other {}}",values:{runNames:t.slice(0,5).join(", "),hasMore:t.length>5}})}),(0,h.Y)("div",{css:(0,o.AH)({marginTop:f.spacing.sm},""),children:(0,h.Y)(M.I.TextArea,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_hooks_useevaluationaddnewinputsmodal.tsx_99",value:i[e],onChange:t=>m(e,t.target.value)})})]},e)))})}})(),R=(0,v.wA)(),D=(0,s.useCallback)((()=>{var e;const t=null===(e=b.current)||void 0===e?void 0:e.querySelector(".ag-body-viewport");t?t.scrollTo({top:0,behavior:"smooth"}):null===_||void 0===_||_.ensureIndexVisible(0,"top")}),[_]),T=(0,s.useMemo)((()=>t.map(he.xP).flat().length>0),[t]),L=(0,s.useCallback)((()=>{I(t,(e=>{R({type:"EVALUATE_ADD_INPUT_VALUES",payload:e,meta:{}}),D()}))}),[D,I,R,t]),{theme:F}=(0,a.u)(),B=(0,V.A)(),U=(0,s.useCallback)((({value:e,colDef:t,column:n})=>{const o=B.formatMessage({id:"aQxQIF",defaultMessage:"(empty)"});return null===r||void 0===r?void 0:r(e||o,t.headerName||n.getId())}),[B,r]),N=(0,s.useMemo)((()=>(0,h.Y)(a.T.Text,{bold:!0,children:p})),[p]);return(0,s.useEffect)((()=>{const e=[],{initialWidthGroupBy:o,initialWidthOutput:a,maxWidth:r,minWidth:s}=ln;(0,H.Ii)()&&t.some((e=>(0,he.o1)(e)))&&e.push({resizable:!1,pinned:!0,width:40,headerComponent:"ActionsColumnRenderer",cellRendererSelector:({rowIndex:e})=>0===e?{component:"ActionsCellRenderer",params:{displayAddNewInputsButton:T,onAddNewInputs:L}}:void 0,cellClass:"leading-column-cell"}),n.forEach(((t,a)=>{const i=a===n.length-1;e.push({resizable:!0,initialWidth:o,minWidth:s,maxWidth:r,headerName:t,valueGetter:({data:e})=>e.groupByCellValues[t],suppressMovable:!0,cellRenderer:"TextRendererCellRenderer",headerClass:i?"last-group-by-header-cell":void 0,cellRendererParams:{isGroupByColumn:!0},headerComponent:"GroupHeaderCellRenderer",headerComponentParams:{displayAddNewInputsButton:T,onAddNewInputs:L},colId:t,onCellClicked:U})})),t.forEach(((t,n)=>{const o=0===n;e.push({resizable:!0,initialWidth:a,minWidth:s,maxWidth:r,headerName:t.runName,colId:t.runUuid,valueGetter:({data:e})=>e.cellValues[t.runUuid],suppressMovable:!0,cellRenderer:m?"ImageRendererCellRenderer":"TextRendererCellRenderer",cellRendererParams:{run:t},headerComponent:"RunHeaderCellRenderer",headerComponentParams:{run:t,onDuplicateRun:k,onHideRun:Y,onDatasetSelected:l,groupHeaderContent:o?N:null},onCellClicked:U})})),f(e)}),[t,n,Y,k,l,L,T,U,N,m]),(0,s.useEffect)((()=>{if(!_)return;const e=t.some((e=>{var t;return(0,he.o1)(e)||(null===(t=e.datasets)||void 0===t?void 0:t.length)>0}));_.setHeaderHeight(((e=!1,t=!1)=>t?40+(e?175:62):80)(w,e))}),[_,w,t]),(0,h.FD)("div",{css:yn,ref:b,children:[(0,h.Y)(Lt.p,{css:bn(F),context:{highlightedText:d},rowHeight:190,onGridReady:({api:e})=>y(e),getRowId:({data:e})=>e.key,suppressHorizontalScroll:!1,columnDefs:g,rowData:e,components:{TextRendererCellRenderer:sn,GroupHeaderCellRenderer:cn,RunHeaderCellRenderer:Zt,ActionsColumnRenderer:mn,ActionsCellRenderer:gn,ImageRendererCellRenderer:_n}}),A]})},bn=e=>({".ag-row:not(.ag-row-first), .ag-body-viewport":{borderTop:`1px solid ${e.colors.borderDecorative}`},".ag-row-last":{borderBottom:`1px solid ${e.colors.borderDecorative}`},".ag-cell, .last-group-by-header-cell .header-group-cell":{borderRight:`1px solid ${e.colors.borderDecorative}`},".ag-cell-focus:not(.leading-column-cell)::after":{content:'""',position:"absolute",inset:0,boxShadow:`inset 0 0 0px 2px ${e.colors.blue300}`,pointerEvents:"none"}});var wn=n(77484);const Cn=(e,t)=>{const n=t.map((t=>{const n=e[t];return[t,(0,E.isString)(n)?n:JSON.stringify(n)]}));return{key:n.map((([,e])=>String(e))).join("."),groupByValues:(0,E.fromPairs)(n)}};var Yn=n(38566);var kn=n(37752);const In=()=>{var e;return/mac/i.test(null===(e=window.navigator.userAgentData)||void 0===e?void 0:e.platform)||/mac/i.test(window.navigator.platform)},An=In()?"metaKey":"ctrlKey",Sn=(e,t={},n)=>{const{altOrOptKey:o=!1,ctrlOrCmdKey:a=!1,shiftKey:r=!1}=t;return(0,s.useEffect)((()=>{const t=t=>{if((!a||t[An])&&(!o||t.altKey)&&(!r||t.shiftKey)&&t.key===e){n()&&t.preventDefault()}};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)}),[e,n,a,o,r]),{isMacKeyboard:In}},Mn=()=>{const{evaluationPendingDataByRunUuid:e,evaluationArtifactsBeingUploaded:t,evaluationDraftInputValues:n}=(0,v.d4)((({evaluationData:e})=>e)),[r,i]=(0,s.useState)(!1),u=(0,v.wA)(),p=(0,s.useCallback)((()=>{u({type:"DISCARD_PENDING_EVALUATION_DATA"})}),[u]),m=Object.values(e).flat().length,g=n.length,f=Object.values(t).filter((e=>Object.values(e).some((e=>e)))).length;(0,s.useEffect)((()=>{0===m&&i(!1)}),[m]);const _=(0,s.useCallback)((()=>(0===m||r||(i(!0),u((async(e,t)=>{const{evaluationPendingDataByRunUuid:n,evaluationArtifactsByRunUuid:o}=t().evaluationData,a=Object.keys(n),r=(0,E.fromPairs)(Object.entries(o).filter((([e,t])=>a.includes(e)&&t[d.AH])).map((([e,t])=>[e,t[d.AH]]))),s=a.map((e=>{const t=r[e];if(!t)throw new Error(`Cannot find existing prompt engineering artifact for run ${e}`);const o=n[e].map((({entryData:e,evaluationTime:n,totalTokens:o})=>t.columns.map((t=>t===he.Ef?n.toString():t===he.jC&&o?o.toString():e[t]||"")))),a=(0,E.cloneDeep)(r[e].rawArtifactFile);return null===a||void 0===a||a.data.unshift(...o),{runUuid:e,updatedArtifactFile:a}})).map((({runUuid:t,updatedArtifactFile:n})=>e((0,l.Of)(t,d.AH,n)).then((()=>{const e=(0,Ue.G4)(d.AH,n);return{runUuid:t,newEvaluationTable:e}}))));return e({type:"WRITE_BACK_EVALUATION_ARTIFACTS",payload:Promise.all(s),meta:{runUuidsToUpdate:a,artifactPath:d.AH}})})).catch((e=>{w.A.logErrorAndNotifyUser(e)}))),!0)),[u,m,r]),{isMacKeyboard:y}=Sn("s",{ctrlOrCmdKey:!0},_),{theme:x}=(0,a.u)(),b=g>0&&0===m,C=m>0||b?(0,h.FD)("div",{css:(0,o.AH)({backgroundColor:x.colors.backgroundPrimary,border:`1px solid ${x.colors.border}`,padding:x.spacing.md,marginBottom:x.spacing.sm,display:"flex",justifyContent:"space-between",alignItems:"center"},""),children:[b?(0,h.Y)(c.A,{id:"EPcEi9",defaultMessage:"You have added rows with new input values, but you still need to evaluate the new data in order to save it."}):r?(0,h.Y)(a.T.Text,{children:(0,h.Y)(c.A,{id:"NGsTf/",defaultMessage:"Synchronizing artifacts for {runsBeingSynchronizedCount} runs...",values:{runsBeingSynchronizedCount:(0,h.Y)("strong",{children:f})}})}):(0,h.Y)(a.T.Text,{children:(0,h.Y)(c.A,{id:"BWpQZ7",defaultMessage:'You have <strong>{unsyncedDataEntriesCount}</strong> unsaved evaluated {unsyncedDataEntriesCount, plural, =1 {value} other {values}}. Click "Save" button or press {keyCombination} keys to synchronize the artifact data.',values:{strong:e=>(0,h.Y)("strong",{children:e}),unsyncedDataEntriesCount:m,keyCombination:y()?"\u2318CMD+S":"CTRL+S"}})}),(0,h.FD)("div",{css:(0,o.AH)({display:"flex",gap:x.spacing.sm},""),children:[(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_hooks_useevaluationartifactwriteback.tsx_102",disabled:r,onClick:p,children:(0,h.Y)(c.A,{id:"kNTkr+",defaultMessage:"Discard"})})," ",m>0&&(0,h.Y)(a.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_hooks_useevaluationartifactwriteback.tsx_110",loading:r,type:"primary",onClick:_,children:(0,h.Y)(c.A,{id:"nhqO2Z",defaultMessage:"Save"})})]})]}):null;return{isSyncingArtifacts:r,EvaluationSyncStatusElement:C}},Rn=({noEvalTablesLogged:e,userDeselectedAllColumns:t,areRunsSelected:n,areTablesSelected:o})=>!o||!n||t||e,Dn=({noEvalTablesLogged:e,userDeselectedAllColumns:t,areRunsSelected:n})=>{const[o,s]=n?e?[(0,h.Y)(c.A,{id:"sguNEF",defaultMessage:"No evaluation tables logged"}),(0,h.Y)(c.A,{id:"j7cj5r",defaultMessage:"Please log at least one table artifact containing evaluation data. <link>Learn more</link>.",values:{link:e=>(0,h.Y)(a.T.Link,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationartifactviewemptystate.tsx_48",openInNewTab:!0,href:"https://mlflow.org/docs/latest/python_api/mlflow.html?highlight=log_table#mlflow.log_table",target:"_blank",rel:"noopener noreferrer",children:e})}})]:t?[(0,h.Y)(c.A,{id:"owr9l2",defaultMessage:"No group by columns selected"}),(0,h.Y)(c.A,{id:"lJQEW4",defaultMessage:'Using controls above, select at least one "group by" column.'})]:[(0,h.Y)(c.A,{id:"ZvJTXB",defaultMessage:"No tables selected"}),(0,h.Y)(c.A,{id:"18/UVG",defaultMessage:"Using controls above, select at least one artifact containing table."})]:[(0,h.Y)(c.A,{id:"BFzsMn",defaultMessage:"No runs selected"}),(0,h.Y)(c.A,{id:"nPWZsh",defaultMessage:"Make sure that at least one experiment run is visible and available to compare"})];return(0,h.Y)(r.Empty,{title:o,description:s})};var Tn=n(22853),En=n(58898);var Ln={name:"1hetg88",styles:"max-width:300px"},Fn={name:"111arwn",styles:"width:300px;min-width:300px"},Bn={name:"1hetg88",styles:"max-width:300px"},Un={name:"1hetg88",styles:"max-width:300px"},Nn={name:"1ichkjj",styles:"height:100%;display:flex;justify-content:center;align-items:center"};const On=({comparedRuns:e,onDatasetSelected:t,viewState:n,updateViewState:i})=>{const u=(0,V.A)(),{theme:p}=(0,a.u)(),m=((0,et.e)(),(0,s.useMemo)((()=>e.filter((({hidden:e})=>!e)).slice(0,10)),[e])),{selectedTables:g,groupByCols:f,outputColumn:_,setSelectedTables:y,setGroupByCols:x,setOutputColumn:b}=((e,t)=>{const{artifactViewState:n={}}=e,[o,a]=(0,s.useState)(n.selectedTables||[]),[r,i]=(0,s.useState)(n.groupByCols||[]),[l,d]=(0,s.useState)(n.outputColumn||"");return(0,s.useEffect)((()=>t({artifactViewState:{selectedTables:o,groupByCols:r,outputColumn:l}})),[t,o,r,l]),{selectedTables:o,groupByCols:r,outputColumn:l,setSelectedTables:a,setGroupByCols:i,setOutputColumn:d}})(n,i),[C,Y]=(0,s.useState)(!1),[k,I]=(0,s.useState)(""),[A,R]=(0,s.useState)(""),[D,T]=(0,s.useState)(!1),{isSyncingArtifacts:L,EvaluationSyncStatusElement:F}=Mn(),B=(0,v.wA)();(0,s.useEffect)((()=>{(0,H.Ii)()&&B(Pe()).catch((e=>{w.A.logErrorAndNotifyUser((null===e||void 0===e?void 0:e.message)||e)}))}),[B]);const U=(0,s.useCallback)((e=>y((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))),[y]),N=(0,s.useCallback)((e=>x((t=>{const n=t.includes(e)?t.filter((t=>t!==e)):[...t,e];return T(0===n.length),n}))),[x]),O=(0,s.useMemo)((()=>m.map((({runUuid:e})=>e))),[m]),{evaluationArtifactsByRunUuid:P,evaluationPendingDataByRunUuid:K,evaluationDraftInputValues:z}=(0,v.d4)((({evaluationData:e})=>e)),{tables:G,tablesByRun:j,noEvalTablesLogged:q}=(W=m,(0,s.useMemo)((()=>{const e=(0,E.fromPairs)(W.map((e=>{const t=e.tags?(0,Yn.T)(e.tags):[];return[e.runUuid,t]})).filter((([,e])=>e.length>0))),t=Array.from(new Set(Object.values(e).flat())),n=t.filter((t=>W.every((({runUuid:n})=>{var o;return null===(o=e[n])||void 0===o?void 0:o.includes(t)})))),o=0===t.length;return{tables:t,tablesByRun:e,tablesIntersection:n,noEvalTablesLogged:o}}),[W]));var W;(0,s.useEffect)((()=>{G.length>0&&0===g.length&&y([G[0]])}),[G,y,g.length]);const $=(0,v.d4)((({evaluationData:e,modelGateway:t})=>t.modelGatewayRoutesLoading.loading||O.some((t=>g.some((n=>{var o;return null===(o=e.evaluationArtifactsLoadingByRunUuid[t])||void 0===o?void 0:o[n]})))))),{columns:J,imageColumns:Q}=(X=P,Z=O,ee=g,(0,s.useMemo)((()=>{if(0===ee.length||0===Z.length)return{columns:[],columnsIntersection:[],imageColumns:[]};const e=Z.map((e=>Object.values(X[e]||{}).filter((({path:e})=>ee.includes(e))))).flat(),t=e.filter((({path:e})=>ee.includes(e))).map((({columns:e,entries:t})=>e.map((e=>{const n=String(e);if(t.length>0){const o=t[0][e];return"object"===typeof o&&"image"===(null===o||void 0===o?void 0:o.type)?{name:n,type:"image"}:{name:n,type:"text"}}return{name:n,type:"text"}})))).flat(),n=Array.from(new Set(t.filter((e=>"text"===e.type)).map((e=>e.name)))),o=Array.from(new Set(t.filter((e=>"image"===e.type)).map((e=>e.name)))),a=n.filter((t=>e.every((({columns:e})=>e.includes(t)))));return{columns:n,columnsIntersection:a,imageColumns:o}}),[Z,X,ee]));var X,Z,ee;const te=Q.includes(_),ne=((e,t,n,o,a,r,i)=>(0,s.useMemo)((()=>{const s=[],l={},c={},u=[];for(const e of n){const t=r.map((t=>[t,e[t]])),n=t.map((([,e])=>e)).join(".");c[n]=(0,E.fromPairs)(t),u.push(n)}const p={},m=o.map((t=>[t,Object.values(e[t]||{}).filter((({path:e})=>a.includes(e))).map((({entries:e})=>e)).flat()]));for(const[e,t]of m)for(const n of t){const{key:t,groupByValues:o}=Cn(n,r);if(Object.values(o).every((e=>!e)))continue;c[t]||(c[t]=o),(n[he.Ef]||n[he.jC])&&(p[t]||(p[t]={}),p[t][e]||(p[t][e]={isPending:!1,evaluationTime:parseFloat(n[he.Ef]),totalTokens:n[he.jC]?parseInt(n[he.jC],10):void 0})),l[t]||(l[t]={});const a=l[t];a[e]=a[e]||n[i]}for(const[e,n]of Object.entries(t))for(const t of n){const{entryData:n,...o}=t,{key:a,groupByValues:s}=Cn(n,r);if(Object.values(s).every((e=>!e)))continue;c[a]||(c[a]=s,u.push(a)),p[a]||(p[a]={}),p[a][e]=o,l[a]||(l[a]={});const d=l[a];d[e]=n[i]||d[e]}const g=(0,E.sortBy)(Object.entries(c),(([e])=>!u.includes(e)));for(const[e,t]of g){const n=s.find((({key:t})=>e===t));if(n&&l[e])n.cellValues=l[e],n.outputMetadataByRunUuid=p[e];else{const n=l[e];Object.keys(n||{}).forEach((e=>{if(null!==n[e]&&"object"===typeof n[e])try{const{type:t,filepath:o,compressed_filepath:a}=n[e];t===d.Oe?n[e]={url:(0,wn.To)(o,e),compressed_url:(0,wn.To)(a,e)}:n[e]=JSON.stringify(n[e])}catch{n[e]=""}else(0,E.isNil)(n[e])||(0,E.isString)(n[e])||(n[e]=JSON.stringify(n[e]))})),s.push({key:e,groupByCellValues:t,cellValues:l[e]||{},outputMetadataByRunUuid:p[e],isPendingInputRow:u.includes(e)})}}return s}),[o,e,r,n,a,i,t]))(P,K,z,O,g,f,_),oe=(0,s.useMemo)((()=>{const e=m.filter(he.o1).map(he.xP).flat();if(!e.length)return null;return Array.from(new Set(e)).filter((e=>J.includes(e)))}),[m,J]);(0,s.useEffect)((()=>{m.every(he.o1)&&x([])}),[x,m]),(0,s.useEffect)((()=>{if(g.length)for(const e of m){if(!e)continue;const t=(j[e.runUuid]||[]).filter((e=>g.includes(e)));for(const n of t)B((0,l.sT)(e.runUuid,n,!1)).catch((e=>{e instanceof Ue.ap?w.A.displayGlobalErrorNotification(e.message):w.A.logErrorAndNotifyUser(e.message||e)}))}}),[m,B,g,j]);const ae=g.length>0,re=m.length>0,se=!$&&ae&&re,ie=(0,s.useMemo)((()=>{if(!A.trim())return ne;const e=new RegExp(A,"i");return ne.filter((({groupByCellValues:t})=>Object.values(t).some((t=>null===t||void 0===t?void 0:t.match(e)))))}),[ne,A]),le=(0,Tn.v)(e),de=(0,s.useCallback)((e=>{le(En.oy.CUSTOM,e)}),[le]);(0,s.useEffect)((()=>{if($||D)return;const e=f.length<1,t=f.some((e=>!J.includes(e))),n=J[0],o=oe||(n?[n]:null);(e||t)&&o&&x(o)}),[$,D,f,_,J,x,oe]);const ce=(0,s.useMemo)((()=>J.filter((e=>!e.startsWith("MLFLOW_")))),[J]),ue=(0,s.useMemo)((()=>[...J,...Q].filter((e=>!f.includes(e)&&!e.startsWith("MLFLOW_")))),[J,Q,f]);(0,s.useEffect)((()=>{if(f.includes(_)||!_){const e=ue.includes(he.hR)?he.hR:ue[0];b(e||"")}}),[f,_,ue,b]),(0,s.useEffect)((()=>{Y(!0);const e=setTimeout((()=>R(k)),250);return()=>clearTimeout(e)}),[k]),(0,s.useEffect)((()=>{Y(!1)}),[A]),(0,s.useEffect)((()=>{if(!ue.includes(_)){const e=ue.includes(he.hR)?he.hR:ue[0];b(e||"")}}),[_,ue,b]),(0,s.useEffect)((()=>{g.some((e=>!G.includes(e)))&&y([])}),[g,G,y]);const[pe,me]=(0,s.useState)(null),ge=(0,s.useCallback)(((e,t)=>{me({value:e,header:t}),i({previewPaneVisible:!0})}),[i]);return(0,h.FD)("div",{css:(0,o.AH)({flex:1,borderTop:`1px solid ${p.colors.border}`,borderLeft:`1px solid ${p.colors.border}`,marginLeft:-1,zIndex:1,height:"100%",display:"grid",gridTemplateColumns:n.previewPaneVisible?"1fr auto":"1fr",overflow:"hidden"},""),children:[(0,h.FD)("div",{css:(0,o.AH)({paddingLeft:p.spacing.sm,paddingTop:p.spacing.sm,height:"100%",display:"grid",gridTemplateRows:"auto auto 1fr",overflow:"hidden",rowGap:p.spacing.sm,backgroundColor:p.colors.backgroundSecondary},""),children:[(0,h.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",gap:p.spacing.sm,overflow:"hidden",height:p.general.heightSm},""),children:[(0,h.FD)(r.DialogCombobox,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationartifactcompareview.tsx_358",label:(0,h.Y)(c.A,{id:"syyEiR",defaultMessage:"Table"}),multiSelect:!0,value:g,children:[(0,h.Y)(r.DialogComboboxTrigger,{css:(0,o.AH)({maxWidth:300,backgroundColor:p.colors.backgroundPrimary},""),"data-testid":"dropdown-tables",onClear:()=>y([]),disabled:L||!re||q}),(0,h.Y)(r.DialogComboboxContent,{css:Ln,children:(0,h.Y)(r.DialogComboboxOptionList,{children:G.map((e=>(0,h.Y)(r.DialogComboboxOptionListCheckboxItem,{value:e,onChange:U,checked:g.includes(e),"data-testid":"dropdown-tables-option",children:e},e)))})})]}),(0,h.Y)(r.LegacyTooltip,{title:(0,h.Y)(c.A,{id:"VZRc73",defaultMessage:"Using the list of logged table artifacts, select at least one to start comparing results."}),children:(0,h.Y)(S.I,{})})]}),$?(0,h.Y)(r.LegacySkeleton,{}):(0,h.FD)(h.FK,{children:[(0,h.FD)("div",{css:(0,o.AH)({display:"flex",columnGap:p.spacing.sm,alignItems:"center",overflow:"hidden",height:p.general.heightSm},""),children:[(0,h.Y)(M.I,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationartifactcompareview.tsx_414",prefix:(0,h.Y)(M.S,{}),suffix:C&&(0,h.Y)(a.S,{size:"small"}),css:Fn,onChange:e=>I(e.target.value),value:k,placeholder:u.formatMessage({id:"3D2Znf",defaultMessage:"Filter by {columnNames}"},{columnNames:f.join(", ")}),allowClear:!0,disabled:!se||L}),(0,h.FD)(r.DialogCombobox,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationartifactcompareview.tsx_433",value:f,multiSelect:!0,label:(0,h.Y)(c.A,{id:"fWm1UC",defaultMessage:"Group by"}),children:[(0,h.Y)(r.DialogComboboxTrigger,{disabled:!se||L,allowClear:!1,showTagAfterValueCount:1,css:(0,o.AH)({maxWidth:300,backgroundColor:p.colors.backgroundPrimary},""),"aria-label":'Select "group by" columns'}),(0,h.Y)(r.DialogComboboxContent,{css:Bn,children:(0,h.Y)(r.DialogComboboxOptionList,{children:ce.map((e=>(0,h.Y)(r.DialogComboboxOptionListCheckboxItem,{value:e,onChange:N,checked:f.includes(e),children:e},e)))})})]}),(0,h.FD)(r.DialogCombobox,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_evaluation-artifacts-compare_evaluationartifactcompareview.tsx_465",value:[_],label:(0,h.Y)(c.A,{id:"ZqGzZd",defaultMessage:"Compare"}),children:[(0,h.Y)(r.DialogComboboxTrigger,{disabled:!se||L,allowClear:!1,css:(0,o.AH)({maxWidth:300,backgroundColor:p.colors.backgroundPrimary},"")}),(0,h.Y)(r.DialogComboboxContent,{css:Un,children:(0,h.Y)(r.DialogComboboxOptionList,{children:ue.map((e=>(0,h.Y)(r.DialogComboboxOptionListSelectItem,{value:e,onChange:()=>b(e),checked:_===e,children:e},e)))})})]})]}),Rn({areRunsSelected:re,areTablesSelected:ae,noEvalTablesLogged:q,userDeselectedAllColumns:D})?(0,h.Y)("div",{css:Nn,children:(0,h.Y)(Dn,{areRunsSelected:re,areTablesSelected:ae,noEvalTablesLogged:q,userDeselectedAllColumns:D})}):(0,h.Y)("div",{css:(0,o.AH)({position:"relative",zIndex:1,overflowY:"hidden",height:"100%",backgroundColor:p.colors.backgroundPrimary},""),children:(0,h.Y)(Bt,{tableData:ne,outputColumn:_,children:(0,h.Y)(xn,{visibleRuns:m,groupByColumns:f,resultList:ie,onCellClick:te?void 0:ge,onHideRun:de,onDatasetSelected:t,highlightedText:A.trim(),isPreviewPaneVisible:n.previewPaneVisible,outputColumnName:_,isImageColumn:te})})}),F]})]}),n.previewPaneVisible&&(0,h.Y)(kn.V,{content:null!==pe&&void 0!==pe&&pe.value?(0,h.Y)(tn.f,{json:pe.value}):null,copyText:(null===pe||void 0===pe?void 0:pe.value)||"",headerText:null===pe||void 0===pe?void 0:pe.header,onClose:()=>i({previewPaneVisible:!1}),empty:(0,h.Y)(r.Empty,{description:(0,h.Y)(c.A,{id:"lTngfr",defaultMessage:"Select a cell to display preview"})})})]})},Pn=e=>{const{theme:t}=(0,a.u)();return e.disabled?(0,h.Y)("div",{css:(0,o.AH)({flex:1,backgroundColor:t.colors.backgroundSecondary,height:"100%",borderTop:`1px solid ${t.colors.border}`,borderLeft:`1px solid ${t.colors.border}`,paddingTop:t.spacing.lg,marginLeft:-1,zIndex:1,display:"flex",justifyContent:"center",alignItems:"center"},""),children:(0,h.Y)(r.Empty,{title:(0,h.Y)(c.A,{id:"2gxV/O",defaultMessage:"Evaluation not available when grouping is enabled"}),description:(0,h.Y)(c.A,{id:"kdTxC2",defaultMessage:"Disable run grouping in order to access the evaluation view"}),image:(0,h.Y)("div",{})})}):(0,h.Y)(On,{...e})};var Hn=n(30152),Vn=n(19415),Kn=n(36118),zn=n(73150),Gn=n(75627),jn=n(39045),qn=n(62758),Wn=n(63617),$n=n(55999),Jn=n(688),Qn=n(71932),Xn=n(40029),Zn=n(21039);const eo=(e,t,n,o,a,r)=>{var s,i;return{uuid:e.runUuid,displayName:(null===(s=e.runInfo)||void 0===s?void 0:s.runName)||e.runUuid,runInfo:e.runInfo,metrics:t[e.runUuid]||{},params:n[e.runUuid]||{},tags:o[e.runUuid]||{},images:a[e.runUuid]||{},color:r,pinned:e.pinned,pinnable:e.pinnable,metricsHistory:{},belongsToGroup:null===(i=e.runDateAndNestInfo)||void 0===i?void 0:i.belongsToGroup,hidden:e.hidden}},to=({isLoading:e,comparedRuns:t,metricKeyList:n,paramKeyList:r,experimentTags:i,compareRunCharts:l,compareRunSections:c,groupBy:u,autoRefreshEnabled:p,hideEmptyCharts:m,globalLineChartConfig:g,chartsSearchFilter:f,minWidth:_})=>{const y=(0,et.e)(),x=(0,Wt.LE)(),b=(0,qn.g_)(),{paramsByRunUuid:w,latestMetricsByRunUuid:C,tagsByRunUuid:Y,imagesByRunUuid:k}=(0,v.d4)((e=>({paramsByRunUuid:e.entities.paramsByRunUuid,latestMetricsByRunUuid:e.entities.latestMetricsByRunUuid,tagsByRunUuid:e.entities.tagsByRunUuid,imagesByRunUuid:e.entities.imagesByRunUuid}))),{theme:I}=(0,a.u)(),[A,S]=(0,s.useState)(!1),[M,R]=(0,s.useState)(null),[D,T]=(0,s.useState)(""),{formatMessage:L}=(0,V.A)(),F=(0,s.useMemo)((()=>(0,pt.Zp)(u)),[u]),[B,U]=(0,s.useState)(void 0),N=(0,s.useCallback)((e=>{R(e)}),[]);(0,s.useEffect)((()=>{A||e||S(!0)}),[A,e]);const O=(0,s.useMemo)((()=>{const e=i[d.S0],t=i[d.Q4];return(null===e||void 0===e?void 0:e.value)||(null===t||void 0===t?void 0:t.value)||n[0]||""}),[i,n]),P=(0,s.useMemo)((()=>{if(!u)return t.filter((e=>e.runInfo)).map((e=>eo(e,C,w,Y,k,x(e.runUuid))));return[...t.filter((e=>e.groupParentInfo&&!(0,pt.mC)(e.groupParentInfo))).map((e=>{var t;return((e,t)=>{var n,o,a;const r=null!==(n=e.groupParentInfo)&&void 0!==n&&n.aggregatedMetricData?(0,E.keyBy)((0,E.values)(null===(o=e.groupParentInfo)||void 0===o?void 0:o.aggregatedMetricData).map((({key:e,value:t,maxStep:n})=>({key:e,value:t,step:n,timestamp:0}))),"key"):{};return{uuid:e.rowUuid,displayName:(0,pt.QD)(e.groupParentInfo),groupParentInfo:e.groupParentInfo,metrics:r,params:(null===(a=e.groupParentInfo)||void 0===a?void 0:a.aggregatedParamData)||{},tags:{},images:{},color:t,pinned:e.pinned,pinnable:e.pinnable,metricsHistory:{},hidden:e.hidden}})(e,x(null===(t=e.groupParentInfo)||void 0===t?void 0:t.groupId))})),...t.filter((e=>{var t;return!e.groupParentInfo&&!(null!==(t=e.runDateAndNestInfo)&&void 0!==t&&t.belongsToGroup)})).map((e=>eo(e,C,w,Y,k,x(e.runUuid))))]}),[u,t,C,w,Y,k,x]),H=P.filter((e=>!e.hidden&&e.tags[d.Cr]));(0,$n.L)({runUuids:H.map((e=>e.uuid)),runUuidsIsActive:H.map((e=>{var t;return"RUNNING"===(null===(t=e.runInfo)||void 0===t?void 0:t.status)})),enabled:!0,autoRefreshEnabled:p}),(0,s.useEffect)((()=>{if((!c||!l)&&P.length>0){const{resultChartSet:e,resultSectionSet:t}=Hn.i$.getBaseChartAndSectionConfigs({primaryMetricKey:O,runsData:P,useParallelCoordinatesChart:!0});b((n=>({...n,compareRunCharts:e,compareRunSections:t})),!0)}}),[l,c,O,P,b]),(0,s.useEffect)((()=>{b((e=>{if(!e.compareRunCharts||!e.compareRunSections)return e;const{resultChartSet:t,resultSectionSet:n,isResultUpdated:o}=Hn.i$.updateChartAndSectionConfigs({compareRunCharts:e.compareRunCharts,compareRunSections:e.compareRunSections,runsData:P,isAccordionReordered:e.isAccordionReordered});return o?{...e,compareRunCharts:t,compareRunSections:n}:e}),!0)}),[P,b]);const K=(0,s.useCallback)((e=>{y((t=>({...t,runsPinned:t.runsPinned.includes(e)?t.runsPinned.filter((t=>t!==e)):[...t.runsPinned,e]})))}),[y]),z=(0,Tn.v)(t),G=(0,s.useCallback)((e=>z(En.oy.CUSTOM,e)),[z]),j=(0,qn.Ez)(),q=(0,qn.KP)(),W=(0,qn.iO)(),$=(0,qn.cA)(),J=(0,s.useMemo)((()=>({runs:P,onTogglePin:K,onHideRun:G})),[P,G,K]),Q=(0,s.useMemo)((()=>m?null===l||void 0===l?void 0:l.filter((e=>!e.deleted&&!(0,Kn.Cs)(P,e))):null===l||void 0===l?void 0:l.filter((e=>!e.deleted))),[P,l,m]);return A?(0,h.FD)("div",{css:(0,o.AH)({flex:1,borderTop:`1px solid ${I.colors.border}`,borderLeft:`1px solid ${I.colors.border}`,marginLeft:-1,position:"relative",backgroundColor:I.colors.backgroundSecondary,paddingLeft:I.spacing.md,paddingRight:I.spacing.md,paddingBottom:I.spacing.md,zIndex:1,overflowY:"auto",minWidth:_},""),"data-testid":"experiment-view-compare-runs-chart-area",children:[(0,h.FD)("div",{css:[{paddingTop:I.spacing.sm,paddingBottom:I.spacing.sm,display:"flex",gap:I.spacing.xs,position:"sticky",top:0,zIndex:Zn.K.SEARCH_BAR,backgroundColor:I.colors.backgroundSecondary,marginLeft:-I.spacing.md,marginRight:-I.spacing.md,paddingLeft:I.spacing.md,paddingRight:I.spacing.md},""],children:[(0,h.Y)(Xn.I,{chartsSearchFilter:f}),(0,h.Y)(Jn.f,{updateUIState:b,metricKeyList:n,globalLineChartConfig:g})]}),(0,h.Y)(Gn.W,{contextData:J,component:zn.X,children:(0,h.Y)(Qn.c_,{visibleChartCards:Q,children:(0,h.Y)(jn.J,{compareRunSections:c,compareRunCharts:Q,reorderCharts:W,insertCharts:$,chartData:P,startEditChart:N,removeChart:q,addNewChartCard:e=>t=>{R(Hn.i$.getEmptyChartCardByType(t,!1,void 0,e))},search:null!==f&&void 0!==f?f:"",groupBy:F,setFullScreenChart:U,autoRefreshEnabled:p,hideEmptyCharts:m,globalLineChartConfig:g})})}),M&&(0,h.Y)(Vn.z,{chartRunData:P,metricKeyList:n,paramKeyList:r,config:M,onSubmit:e=>{j(e),R(null)},onCancel:()=>R(null),groupBy:F,globalLineChartConfig:g}),(0,h.Y)(Wn._,{fullScreenChart:B,onCancel:()=>U(void 0),chartData:P,groupBy:F,tooltipContextValue:J,tooltipComponent:zn.X,autoRefreshEnabled:p,globalLineChartConfig:g})]}):(0,h.Y)(oo,{})},no=e=>{const t=(0,et.e)(),n=(0,s.useCallback)((e=>{t((t=>({...t,...e(t)})))}),[t]);return(0,h.Y)(qn.oB,{updateChartsUIState:n,children:(0,h.Y)(to,{...e})})},oo=()=>{const{theme:e}=(0,a.u)();return(0,h.Y)("div",{css:(0,o.AH)({flex:1,display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gridTemplateRows:"200px",gap:e.spacing.md,borderTop:`1px solid ${e.colors.border}`,borderLeft:`1px solid ${e.colors.border}`,marginLeft:-1,backgroundColor:e.colors.backgroundSecondary,padding:e.spacing.md,zIndex:1},""),children:new Array(6).fill(null).map(((e,t)=>(0,h.Y)(r.TableSkeleton,{lines:5,seed:t.toString()},t)))})};var ao=n(4972),ro=n(42550),so=n(25790),io=n(63609);var lo={name:"1vfb318",styles:"flex:1;display:flex;align-items:center;justify-content:center"};const co=({error:e})=>{const t=null===e||void 0===e?void 0:e.message;return(0,h.Y)("div",{css:lo,children:(0,h.Y)(r.Empty,{description:null!==t&&void 0!==t?t:(0,h.Y)(c.A,{id:"i+RyPC",defaultMessage:"Your request could not be fulfilled. Please try again."}),image:(0,h.Y)(a.W,{}),title:(0,h.Y)(c.A,{id:"2mRfvl",defaultMessage:"Request error"})})})};var uo=n(72661);var po=n(39771);const mo="CONTROLLER_NOTIFICATION_KEY";var go,ho=n(53962);class fo{static getApiUrl(e){return`/dispatcher/${e}`}static async cloneModifyRun(e){return await(0,ho.B2)({relativeUrl:this.getApiUrl("clone-modify-run"),data:e})}static async stopRun(e){return await(0,ho.B2)({relativeUrl:this.getApiUrl("stop-run"),data:e})}static async resumeRun(e){return await(0,ho.B2)({relativeUrl:this.getApiUrl("resume-run"),data:e})}static async deleteRun(e){return await(0,ho.B2)({relativeUrl:this.getApiUrl("delete-run"),data:e})}}go=fo,fo.healthCheck=()=>(0,ho.I2)({url:go.getApiUrl("health-check")}),fo.initDispatcher=e=>(0,ho.B2)({relativeUrl:go.getApiUrl("init-dispatcher"),data:e}),fo.getAllRunsUi=()=>(0,ho.I2)({url:go.getApiUrl("get-all-runs")}),fo.getRunUi=e=>(0,ho.B2)({relativeUrl:go.getApiUrl("get-run"),data:e}),fo.getRunningExperiment=()=>(0,ho.I2)({url:go.getApiUrl("get-running-experiment")}),fo.createExperiment=e=>(0,ho.B2)({relativeUrl:go.getApiUrl("create-experiment"),data:e}),fo.getAllExperimentNames=()=>(0,ho.I2)({url:go.getApiUrl("get-all-experiment-names")}),fo.getExperimentError=()=>(0,ho.I2)({url:go.getApiUrl("get-experiment-error")}),fo.setExperimentError=e=>(0,ho.B2)({relativeUrl:go.getApiUrl("set-experiment-error"),data:e}),fo.setExperimentStatus=e=>(0,ho.B2)({relativeUrl:go.getApiUrl("set-experiment-status"),data:e}),fo.getEtlControllerTaskStatus=e=>(0,ho.B2)({relativeUrl:go.getApiUrl("get-etl-controller-task-status"),data:e}),fo.setEtlControllerTask=e=>(0,ho.B2)({relativeUrl:go.getApiUrl("set-etl-controller-task"),data:e}),fo.getEtlControllerRunningTask=()=>(0,ho.I2)({url:go.getApiUrl("get-etl-controller-running-task")}),fo.getEtlControllerScheduledTask=()=>(0,ho.I2)({url:go.getApiUrl("get-etl-controller-scheduled-task")}),fo.getMlControllerRunningTasks=()=>(0,ho.I2)({url:go.getApiUrl("get-ml-controller-running-tasks")}),fo.getMlControllerScheduledTasks=()=>(0,ho.I2)({url:go.getApiUrl("get-ml-controller-scheduled-tasks")}),fo.getMlControllerTaskStatus=e=>(0,ho.B2)({relativeUrl:go.getApiUrl("get-ml-controller-task-status"),data:e}),fo.setMlControllerTask=e=>(0,ho.B2)({relativeUrl:go.getApiUrl("set-ml-controller-task"),data:e}),fo.getMlControllerCloneModifyTask=()=>(0,ho.I2)({url:go.getApiUrl("get-ml-controller-clone-modify-task")}),fo.getMlTrainControllerProgress=e=>(0,ho.I2)({url:go.getApiUrl("get-ml-train-controller-progress"),data:e}),fo.getRun=e=>(0,ho.B2)({relativeUrl:go.getApiUrl("get-run"),data:e}),fo.getRunsByStatus=e=>(0,ho.B2)({relativeUrl:go.getApiUrl("get-runs-by-status"),data:e}),fo.getAllRuns=()=>(0,ho.I2)({url:go.getApiUrl("get-all-runs")}),fo.resetAllTables=e=>(0,ho.B2)({relativeUrl:go.getApiUrl("reset-all-tables"),data:e}),fo.cancelCurrent=()=>(0,ho.I2)({url:go.getApiUrl("cancel-current")}),fo.getLogs=e=>(0,ho.B2)({relativeUrl:go.getApiUrl("get-experiment-logs"),data:e}),fo.getICLogs=e=>(0,ho.B2)({relativeUrl:go.getApiUrl("get-ic-logs"),data:e});var vo={name:"11jf4ye",styles:"display:flex;gap:8px"};const _o={container:{display:"flex",padding:"20px",gap:"20px",height:"100%",minHeight:"100%"},leftPanel:e=>({display:"flex",flexDirection:"column",gap:16,padding:12,backgroundColor:e.colors.backgroundSecondary,borderRadius:e.general.borderRadiusBase,flexShrink:0,alignItems:"stretch",minWidth:120}),actionsHeader:e=>({fontSize:"14px",fontWeight:600,color:e.colors.textSecondary,marginBottom:8,textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center"}),contentWrapper:{display:"flex",flexDirection:"column",gap:2,flex:1,minHeight:0,overflow:"hidden"},header:{display:"flex",flexDirection:"column",gap:4,marginBottom:4,paddingBottom:4,flexShrink:0},headerTitle:{fontSize:"20px",fontWeight:600,margin:0},headerSeparator:e=>({height:"1px",backgroundColor:e.colors.border,width:"100%",margin:"4px 0"}),headerDetails:{display:"flex",flexDirection:"column",gap:4},detailRow:{display:"flex",alignItems:"center",gap:8},detailLabel:e=>({fontSize:"14px",color:e.colors.textSecondary,fontWeight:500,minWidth:"100px",flexShrink:0}),detailValue:e=>({fontSize:"12px",fontFamily:"'Monaco', 'Menlo', 'Ubuntu Mono', monospace",lineHeight:1.4,color:e.colors.textPrimary}),sectionSeparator:e=>({height:"1px",backgroundColor:e.colors.border,width:"100%",margin:"4px 0"}),configSection:{display:"flex",flexDirection:"column",gap:12,flex:1,minHeight:0},configHeader:{fontSize:"16px",fontWeight:600,margin:0,color:"#666"},title:{fontSize:"16px",fontWeight:600},textAreaWrapper:{flex:1,minHeight:0,display:"flex",flexDirection:"column"},textArea:{name:"1s2itzc",styles:"height:100%!important;min-height:0!important;font-family:'Monaco','Menlo','Ubuntu Mono',monospace;font-size:12px;line-height:1.4;resize:none"},iconButton:{name:"94415v",styles:"&.ant-btn{border:1px solid rgba(0, 0, 0, 0.1);background:rgba(255, 255, 255, 0.1);box-shadow:none;width:100%!important;min-width:0!important;justify-content:flex-start;text-align:left;.ant-btn-icon{margin-right:8px;}&:hover,&:focus{background:rgba(255, 255, 255, 0.2);}&:disabled{width:100%!important;min-width:0!important;opacity:0.6;}}"}};var yo=({runUuid:e,runName:t,onClose:n,onHideRun:o,showControllerNotification:i,refreshRuns:l})=>{(0,v.wA)();const[d,c]=(0,s.useState)(!1),[u,p]=(0,s.useState)("{}"),[m,g]=(0,s.useState)(""),[f,_]=(0,s.useState)(!1),[y,x]=(0,s.useState)(""),[b,w]=(0,s.useState)(0);(0,s.useEffect)((()=>{(async()=>{try{const e=Number(t);if(!e)return void console.error("Run not found");const n=await fo.getRunUi({run_id:e});if(n&&"object"===typeof n&&"config"in n){const e=n.config;p(JSON.stringify(e,null,2)),g(JSON.stringify(e,null,2)),"status"in n&&"string"===typeof n.status&&x(n.status),"num_chunks_visited"in n&&"number"===typeof n.num_chunks_visited&&w(n.num_chunks_visited)}else console.error("Response does not contain a config object")}catch(e){console.error("Error fetching run configuration:",e)}})()}),[t]);return(0,h.FD)("div",{css:_o.container,children:[(0,h.FD)("div",{css:_o.leftPanel,children:[(0,h.Y)("div",{css:_o.actionsHeader,children:"Actions"}),(0,h.Y)(S.T,{content:"Resume run",componentId:"resume-run-tooltip",children:(0,h.Y)(a.B,{componentId:"resume-run-button",size:"middle",icon:(0,h.Y)(r.PlayIcon,{color:"success"}),css:_o.iconButton,onClick:async()=>{try{const e=Number(t),n=await fo.resumeRun({run_id:e});if(n&&"object"===typeof n&&"error"in n?n.error:null)return void(null===i||void 0===i||i("resume","error"));null===i||void 0===i||i("resume","success"),null===l||void 0===l||l()}catch(e){null===i||void 0===i||i("resume","error")}},disabled:"completed"===(null===y||void 0===y?void 0:y.toLowerCase()),children:"Resume"})}),(0,h.Y)(S.T,{content:"Stop run",componentId:"stop-run-tooltip",children:(0,h.Y)(a.B,{componentId:"stop-run-button",size:"middle",icon:(0,h.Y)(r.StopIcon,{color:"danger"}),css:_o.iconButton,onClick:async()=>{try{const e=Number(t),n=await fo.stopRun({run_id:e});if(n&&"object"===typeof n&&"error"in n?n.error:null)return void(null===i||void 0===i||i("stop","error"));null===i||void 0===i||i("stop","success"),null===l||void 0===l||l()}catch(e){null===i||void 0===i||i("stop","error")}},disabled:"completed"===(null===y||void 0===y?void 0:y.toLowerCase()),children:"Stop"})}),(0,h.Y)(S.T,{content:"Clone run",componentId:"clone-run-tooltip",children:(0,h.Y)(a.B,{componentId:"clone-run-button",size:"middle",icon:(0,h.Y)(r.CopyIcon,{color:"ai"}),onClick:()=>{c(!0),_(!1)},disabled:"completed"===(null===y||void 0===y?void 0:y.toLowerCase()),children:"Clone"})}),(0,h.Y)(S.T,{content:"Delete run",componentId:"delete-run-tooltip",children:(0,h.Y)(a.B,{componentId:"delete-run-button",size:"middle",icon:(0,h.Y)(r.TrashIcon,{color:"danger"}),onClick:async()=>{try{const a=Number(t),r=await fo.deleteRun({run_id:a});if(r&&"object"===typeof r&&"error"in r?r.error:null)return void(null===i||void 0===i||i("delete","error"));o&&"function"===typeof o&&o(e),null===i||void 0===i||i("delete","success"),null===l||void 0===l||l(),null===n||void 0===n||n()}catch(a){null===i||void 0===i||i("delete","error")}},disabled:"completed"===(null===y||void 0===y?void 0:y.toLowerCase()),children:"Delete"})})]}),(0,h.FD)("div",{css:_o.contentWrapper,children:[(0,h.FD)("div",{css:_o.header,children:[(0,h.Y)(a.T.Title,{level:4,css:_o.headerTitle,children:"Run Details"}),(0,h.Y)("div",{css:_o.headerSeparator}),(0,h.FD)("div",{css:_o.headerDetails,children:[(0,h.FD)("div",{css:_o.detailRow,children:[(0,h.Y)("span",{css:_o.detailLabel,children:"Run Name:"}),(0,h.Y)("span",{css:_o.detailValue,children:t})]}),(0,h.FD)("div",{css:_o.detailRow,children:[(0,h.Y)("span",{css:_o.detailLabel,children:"Run Status:"}),(0,h.Y)("span",{css:_o.detailValue,children:y})]}),(0,h.FD)("div",{css:_o.detailRow,children:[(0,h.Y)("span",{css:_o.detailLabel,children:"Chunk Number:"}),(0,h.Y)("span",{css:_o.detailValue,children:b})]})]})]}),(0,h.Y)("div",{css:_o.sectionSeparator}),(0,h.FD)("div",{css:_o.configSection,children:[(0,h.Y)(a.T.Title,{level:5,css:_o.configHeader,children:"Run Configuration"}),(0,h.Y)(S.T,{content:d?"You can now edit the config":"Click 'Clone' to edit this config",componentId:"edit-run-tooltip",children:(0,h.Y)("div",{css:_o.textAreaWrapper,children:(0,h.Y)(M.I.TextArea,{componentId:"config-textarea",value:u,onChange:e=>p(e.target.value),readOnly:!d,css:_o.textArea,autoSize:!1})})})]}),d&&(0,h.FD)(h.FK,{children:[(0,h.Y)(r.Checkbox,{componentId:"warm-start-checkbox",isChecked:f,onChange:()=>_(!f),children:"Warm start?"}),(0,h.FD)("div",{css:vo,children:[(0,h.Y)(a.B,{componentId:"save-run-button",size:"middle",type:"primary",onClick:async()=>{try{const o=Number(t);let a;try{a=JSON.parse(u)}catch(e){return console.error("Error parsing config JSON:",e),void(null===i||void 0===i||i("clone_modify","error","Invalid JSON configuration"))}const r=await fo.cloneModifyRun({run_id:o,config:a,warm_start:f});let s=null;if("string"===typeof r)try{const e=JSON.parse(r);!1===e.result&&e.err_msg&&(s=e.err_msg)}catch(n){s=r}else if(r&&"object"===typeof r){const e=r;!1===e.result&&e.err_msg?s=e.err_msg:e.error&&(s=e.error)}if(s)return null===i||void 0===i||i("clone_modify","error",s),void console.error("Clone/Modify error:",s);null===i||void 0===i||i("clone_modify","success"),null===l||void 0===l||l(),c(!1)}catch(o){null===i||void 0===i||i("clone_modify","error"),console.error("Clone/Modify error:",o)}},children:"Submit"}),(0,h.Y)(a.B,{componentId:"cancel-run-button",size:"middle",onClick:()=>{c(!1),p(m),_(!1)},children:"Cancel"})]})]})]})]})};var xo={name:"187r2bh",styles:"flex:1;overflow-y:auto;padding:20px"};var bo=({isOpen:e,onClose:t,children:n,width:r=400,showBackdrop:i=!0,closeOnBackdropClick:l=!0,closeOnEscape:d=!0,className:c,style:u,animationDuration:p=300,disableBodyScroll:m=!0,customHeader:g,showHeader:f=!0})=>{const{theme:v}=(0,a.u)(),_=(0,s.useRef)(null),y=(0,s.useRef)(null);(0,s.useEffect)((()=>{if(!d)return;const n=n=>{"Escape"===n.key&&e&&t()};return e&&document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n)}}),[e,t,d]),(0,s.useEffect)((()=>{if(m)return document.body.style.overflow=e?"hidden":"",()=>{document.body.style.overflow=""}}),[e,m]);const x="number"===typeof r?`${r}px`:r;return(0,h.FD)(h.FK,{children:[i&&(0,h.Y)("div",{ref:y,css:(0,o.AH)("position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0, 0, 0, 0.5);z-index:1000;opacity:",e?1:0,";visibility:",e?"visible":"hidden",";transition:all ",p,"ms ease-in-out;"),onClick:e=>{l&&e.target===y.current&&t()}}),(0,h.FD)("div",{ref:_,css:(0,o.AH)("position:fixed;top:0;right:",e?0:`-${x}`,";width:",x,";height:100vh;background-color:",v.colors.backgroundPrimary,";box-shadow:-2px 0 8px rgba(0, 0, 0, 0.15);z-index:1001;transition:right ",p,"ms ease-in-out;display:flex;flex-direction:column;overflow:hidden;"),className:c,style:u,onClick:e=>{e.stopPropagation()},children:[(f||g)&&(0,h.Y)("div",{css:(0,o.AH)("display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid ",v.colors.border,";background-color:",v.colors.backgroundSecondary,";min-height:60px;"),children:g||(0,h.FD)(h.FK,{children:[(0,h.Y)("div",{css:(0,o.AH)("font-size:18px;font-weight:600;color:",v.colors.textPrimary,";"),children:"RapidFire"}),(0,h.Y)("button",{onClick:t,css:(0,o.AH)("background:none;border:none;cursor:pointer;padding:8px;border-radius:4px;display:flex;align-items:center;justify-content:center;color:",v.colors.textSecondary,";transition:all 0.2s ease;&:hover{background-color:",v.colors.backgroundSecondary,";color:",v.colors.textPrimary,";}&:focus{outline:2px solid ",v.colors.primary,";outline-offset:2px;}"),"aria-label":"Close drawer",children:(0,h.Y)(a.C,{})})]})}),(0,h.Y)("div",{css:xo,children:n})]})]})};var wo=({logs:e,onScrollToBottom:t,emptyStateMessage:n="No logs available. If this is a new cluster, logs will appear here once the cluster starts."})=>{const[o,a]=(0,s.useState)([]),r=(0,s.useRef)(null),[i,l]=(0,s.useState)(!0);(0,s.useEffect)((()=>{a(e)}),[e]),(0,s.useEffect)((()=>{r.current&&i&&(r.current.scrollTop=r.current.scrollHeight)}),[o,i]);return(0,h.Y)("div",{ref:r,className:"terminal-container",style:{backgroundColor:"#000",color:"#fff",fontFamily:"monospace",padding:"20px",height:"100%",width:"100%",overflowY:"auto",borderRadius:"5px",boxShadow:"0 0 10px rgba(0,0,0,0.5)",position:"relative"},onScroll:()=>{if(!r.current)return;const{scrollTop:e,scrollHeight:n,clientHeight:o}=r.current,a=n-e-o<50;l(a),a&&t&&t()},children:o.length>0?(0,h.Y)("div",{style:{minHeight:"100%"},children:o.map(((e,t)=>(0,h.Y)("pre",{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-all",lineHeight:"1.5"},children:e},t)))}):(0,h.Y)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",color:"#888",width:"80%"},children:n})})},Co=n(41261);const Yo=e=>e?3e4:3e5;const ko=()=>{const e=new Date;return e.setMilliseconds(0),e};var Io={name:"w1atjl",styles:"width:100%;height:100%"},Ao={name:"w1atjl",styles:"width:100%;height:100%"};const So=s.memo((e=>{var t,n;const[i]=(0,Be.an)(),{theme:l}=(0,a.u)(),c=(0,et.e)(),{experiments:u,runsData:p,uiState:m,searchFacetsState:g,isLoadingRuns:f,loadMoreRuns:_,moreRunsAvailable:y,requestError:x,refreshRuns:b}=e,C=u.length>1,[Y,k]=(0,s.useState)(new St),{experimentId:I}=u[0],A=(0,Et.S)(I),[S,M]=(0,s.useState)("true"===A.getItem("expandRows"));(0,s.useEffect)((()=>{A.setItem("expandRows",S)}),[S,A]);const{paramKeyList:R,metricKeyList:D,tagsList:T,paramsList:L,metricsList:F,runInfos:B,runUuidsMatchingFilter:U,datasetsList:N,inputsOutputsList:O}=p,P=null===(t=u[0])||void 0===t?void 0:t.name,{data:K=[],isLoading:z,error:G}=((e,t=!0)=>(0,Co.I)(["experiment-logs",e],(async()=>{const t=await fo.getLogs({experiment_name:e});return Array.isArray(t)?t:[]}),{enabled:t&&!!e,staleTime:3e4,cacheTime:6e5,retry:2,refetchOnWindowFocus:!1}))(P,"LOGS"===i),{data:j=[],isLoading:q,error:W}=((e,t=!0)=>{const{data:n}=(0,Co.I)(["running-experiment"],(async()=>await fo.getRunningExperiment()),{enabled:t&&!!e,staleTime:1e4,cacheTime:3e4,retry:1,refetchOnWindowFocus:!1}),o="RUNNING"===(null===n||void 0===n?void 0:n.status);return(0,Co.I)(["experiment-ic-logs",e],(async()=>{const t=await fo.getICLogs({experiment_name:e});return Array.isArray(t)?t:[]}),{enabled:t&&!!e,staleTime:Yo(o),cacheTime:6e5,retry:2,refetchOnWindowFocus:!1})})(P,"IC_LOGS"===i),$=(0,v.d4)((({entities:e})=>e.modelVersionsByRunUuid)),J=(0,s.useMemo)((()=>B.map(((e,t)=>{var n,o;return{runInfo:e,params:L[t],metrics:F[t],tags:T[t],datasets:N[t],inputs:(null===O||void 0===O||null===(n=O[t])||void 0===n?void 0:n.inputs)||{},outputs:(null===O||void 0===O||null===(o=O[t])||void 0===o?void 0:o.outputs)||{}}}))),[N,F,L,B,T,O]),{orderByKey:Q,searchFilter:X}=g,{runsPinned:Z,runsExpanded:ee,runsHidden:te,runListHidden:ne}=m,oe="TABLE"!==i,ae=(0,s.useCallback)((e=>k((t=>({...t,...e})))),[]),re=(0,s.useCallback)((()=>{ae({columnSelectorVisible:!0})}),[ae]),se=(0,s.useMemo)((()=>!Q&&!X||Q===d.T8.DATE),[Q,X]),[ie,le]=(0,s.useState)(ko);(0,s.useEffect)((()=>{le(ko)}),[B]);const de=(0,s.useMemo)((()=>w.A.getVisibleTagKeyList(T)),[T]),[ce,ue]=(0,s.useState)(!1),[pe,me]=(0,s.useState)(),[ge,he]=(0,s.useState)(!1),[fe,ve]=(0,s.useState)(null),_e=(0,s.useMemo)((()=>u.map((({experimentId:e})=>e))),[u]),ye=(0,H.ht)(),xe=(({experimentIds:e,enabled:t=!0})=>{const{data:n}=(0,io.e)({experimentIds:e},{enabled:t});return(0,s.useMemo)((()=>null===n||void 0===n?void 0:n.reduce(((e,t)=>{var n;const{source_run_id:o}=null!==(n=t.info)&&void 0!==n?n:{};return o?(e[o]||(e[o]=[]),e[o].push(t),e):e}),{})),[n])})({experimentIds:_e,enabled:!ye}),be=(({runData:e,enabled:t})=>{const n=(0,s.useMemo)((()=>{if(!t)return{};const n={};for(const{runInfo:t,inputs:r,outputs:s}of e){var o,a;const e=t.runUuid,i=[...(null===r||void 0===r||null===(o=r.modelInputs)||void 0===o?void 0:o.map((e=>e.modelId)))||[],...(null===s||void 0===s||null===(a=s.modelOutputs)||void 0===a?void 0:a.map((e=>e.modelId)))||[]];e&&i.length>0&&(n[e]=(0,E.uniq)(i))}return n}),[e,t]),o=(0,s.useMemo)((()=>t?(0,E.uniq)(Object.values(n).flat()):[]),[n,t]),a=(0,uo.o)({modelIds:o},{enabled:t&&o.length>0});return(0,s.useMemo)((()=>a.data?Object.entries(n).reduce(((e,[t,n])=>{var o,r;return e[t]=null!==(o=null===(r=a.data)||void 0===r?void 0:r.filter((e=>{var t;return n.includes((null===(t=e.info)||void 0===t?void 0:t.model_id)||"")})))&&void 0!==o?o:[],e}),{}):{}),[n,a.data])})({runData:J,enabled:ye}),we=ye?be:xe,Ce=(0,Mt.ZU)({experiments:u,paramKeyList:R,metricKeyList:D,modelVersionsByRunUuid:$,runsExpanded:ee,tagKeyList:de,nestChildren:se,referenceTime:ie,runData:J,runUuidsMatchingFilter:U,runsPinned:Z,runsHidden:te,groupBy:m.groupBy,groupsExpanded:m.groupsExpanded,runsHiddenMode:m.runsHiddenMode,runsVisibilityMap:m.runsVisibilityMap,useGroupedValuesInCharts:m.useGroupedValuesInCharts,searchFacetsState:g,loggedModelsV3ByRunUuid:we}),[Ye,ke]=(0,r.useLegacyNotification)(),Ie=Dt(Ye),Ae=(e=>{const{formatMessage:t}=(0,V.A)(),n=(0,s.useCallback)(((e,n)=>({resume:{success:t({id:"JC7Ug7",defaultMessage:"Run resumed successfully"}),error:t({id:"xnLgNA",defaultMessage:"Failed to resume run"})},clone_modify:{success:t({id:"KaBKuO",defaultMessage:"Run cloned and modified successfully"}),error:t({id:"RMIYqR",defaultMessage:"Failed to clone and modify run"})},stop:{success:t({id:"+0pcPC",defaultMessage:"Run stopped successfully"}),error:t({id:"NwnW5a",defaultMessage:"Failed to stop run"})},delete:{success:t({id:"lXsHPx",defaultMessage:"Run deleted successfully, page should refresh"}),error:t({id:"VBdZNK",defaultMessage:"Failed to delete run"})}}[e][n])),[t]);return(0,s.useCallback)(((t,o,a)=>{e.close(mo),e[o]({message:a||n(t,o),duration:120,placement:"topRight",key:mo})}),[e,n])})(Ye),[Se,Me]=(0,s.useState)(295),Re=(0,s.useCallback)((()=>{y&&!f&&_().then((e=>{Ie(e,B)}))}),[y,f,_,B,Ie]),De=(0,s.useCallback)(((e,t)=>{me({datasetWithTags:e,runData:t}),ue(!0)}),[]),Te=(0,s.useCallback)(((e,t)=>{ve({runUuid:e,runName:t}),he(!0)}),[]),Ee=(0,s.useCallback)((()=>{he(!1),ve(null)}),[]),Le=(0,ao.$)(),Fe=m.autoRefreshEnabled&&(0,H.Hn)()&&Le,Ue=null===(n=m.useGroupedValuesInCharts)||void 0===n||n,Ne=x instanceof Error&&!f?(0,h.Y)(co,{error:x}):(0,h.Y)(At.P,{experiments:u,runsData:p,searchFacetsState:g,viewState:Y,isLoading:f,updateViewState:ae,onAddColumnClicked:re,rowsData:Ce,loadMoreRunsFunc:Re,moreRunsAvailable:y,onOpenController:Te,onDatasetSelected:De,expandRows:S,uiState:m,compareRunsMode:i,showControllerNotification:Ae}),Oe=(0,s.useMemo)((()=>u.map((e=>e.experimentId)).sort().join(",")),[u]),{resizableMaxWidth:Pe,ref:He}=(0,po.b)(350);return(0,h.Y)(Je,{visibleRuns:Ce,refreshRuns:b,children:(0,h.FD)(so.Co,{children:[(0,h.Y)(It,{viewState:Y,updateViewState:ae,runsData:p,searchFacetsState:g,experimentId:I,requestError:x,expandRows:S,updateExpandRows:M,refreshRuns:b,uiState:m,isLoading:f,isComparingExperiments:C}),(0,h.FD)("div",{ref:He,css:(0,o.AH)({minHeight:225,height:"100%",position:"relative",display:"LOGS"===i||"IC_LOGS"===i?"block":"flex",width:"LOGS"===i||"IC_LOGS"===i?"100%":"auto"},""),children:["LOGS"===i?(0,h.Y)("div",{css:Io,children:(0,h.Y)(wo,{logs:z?["Loading experiment logs..."]:G?["Error fetching experiment logs..."]:K,emptyStateMessage:"No experiment logs available yet..."})}):"IC_LOGS"===i?(0,h.Y)("div",{css:Ao,children:(0,h.Y)(wo,{logs:q?["Loading interactive control logs..."]:W?["Error fetching interactive control logs..."]:j,emptyStateMessage:"No interactive control logs available yet..."})}):oe?(0,h.Y)(ro.t,{onResize:Me,runListHidden:ne,width:Se,maxWidth:Pe,children:Ne}):Ne,"CHART"===i&&(0,h.Y)(no,{isLoading:f,comparedRuns:Ce,metricKeyList:p.metricKeyList,paramKeyList:p.paramKeyList,experimentTags:p.experimentTags,compareRunCharts:m.compareRunCharts,compareRunSections:m.compareRunSections,groupBy:Ue?m.groupBy:null,autoRefreshEnabled:Fe,hideEmptyCharts:m.hideEmptyCharts,globalLineChartConfig:m.globalLineChartConfig,chartsSearchFilter:m.chartsSearchFilter,storageKey:Oe,minWidth:350}),"ARTIFACT"===i&&(0,h.Y)(Pn,{comparedRuns:Ce,viewState:Y,updateViewState:ae,onDatasetSelected:De,disabled:Boolean(m.groupBy)}),ke,pe&&(0,h.Y)(Tt.O,{isOpen:ce,setIsOpen:ue,selectedDatasetWithRun:pe,setSelectedDatasetWithRun:me}),(0,h.Y)(bo,{isOpen:ge&&null!==fe,onClose:Ee,width:700,showBackdrop:!0,closeOnBackdropClick:!0,closeOnEscape:!0,customHeader:(0,h.FD)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",padding:"0 20px"},children:[(0,h.Y)("div",{style:{fontSize:"18px",fontWeight:"600",color:l.colors.textPrimary},children:"Interactive Controller"}),(0,h.Y)("button",{onClick:Ee,style:{background:"none",border:"none",cursor:"pointer",padding:"8px",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",color:l.colors.textSecondary,fontSize:"16px"},children:"\xd7"})]}),children:fe&&(0,h.Y)(yo,{runUuid:fe.runUuid,runName:fe.runName,onClose:Ee,showControllerNotification:Ae,onHideRun:e=>{c((t=>({...t,runsHidden:t.runsHidden.includes(e)?t.runsHidden.filter((t=>t!==e)):[...t.runsHidden,e]}))),null===b||void 0===b||b()},refreshRuns:b})})]})]})})}));var Mo=n(89736);var Ro=n(32614);function Do(e){try{return Ro.A.getStoreForComponent("ExperimentPage",e).loadComponentState()}catch{return w.A.logErrorAndNotifyUser(`Error: malformed persisted search state for experiment(s) ${e}`),{...(0,En.uY)(),...(0,Ze.G)()}}}const To=(e,t,n,o=!1)=>{const a=(0,Xe.Px)(),r=(0,s.useMemo)((()=>n?JSON.stringify(n.sort()):null),[n]);(0,s.useEffect)((()=>{if(!o&&!t){const e=r?Do(r):null,t=(0,E.pick)({...(0,Ze.G)(),...e},Xe.sO);a(t,{replace:!0})}}),[t,r,o]),(0,s.useEffect)((()=>{var n,a;t&&r&&!o&&(n={...t,...e},a=r,Ro.A.getStoreForComponent("ExperimentPage",a).saveComponentState(n))}),[t,e,r,o])};var Eo=n(6604),Lo=n(32378),Fo=n(85017),Bo=n(26458);const Uo=(e,t)=>{const{experiments:n}=t,o=t.experimentIds||n.map((e=>e.experimentId)),a=o.length>1,r=(e.entities.runInfoOrderByUuid||[]).map((t=>e.entities.runInfosByUuid[t])).filter((({experimentId:e})=>o.includes(e))).map((({runUuid:e})=>e)),{modelVersionsByRunUuid:s,runUuidsMatchingFilter:i}=e.entities,l=((e,t,{lifecycleFilter:n=Lo.gy.ACTIVE,modelVersionFilter:o=Lo.EL.ALL_RUNS,datasetsFilter:a=[]})=>{const{modelVersionsByRunUuid:r}=t.entities;return e.map((e=>[(0,Bo.K4)(e,t),(0,Bo.jF)(e,t)])).filter((([e,t])=>n===Lo.gy.ACTIVE?"active"===e.lifecycleStage:"deleted"===e.lifecycleStage)).filter((([e,t])=>o===Lo.EL.ALL_RUNS||(o===Lo.EL.WITH_MODEL_VERSIONS?e.runUuid in r:o===Lo.EL.WTIHOUT_MODEL_VERSIONS?!(e.runUuid in r):(console.warn("Invalid input to model version filter - defaulting to showing all runs."),!0)))).filter((([e,t])=>!a||0===a.length||!!t&&t.some((e=>{const t=e.dataset.name,n=e.dataset.digest;return a.some((({name:e,digest:o})=>e===t&&o===n))})))).map((([e,t])=>e))})(r,e,t),d=new Set,c=new Set,u=l.map((t=>e.entities.runDatasetsByUuid[t.runUuid])),p=l.map((t=>e.entities.runInputsOutputsByUuid[t.runUuid])),m=l.map((t=>{const n=(0,Fo.d0)(t.runUuid,e),o=Object.values(n||{}).filter((e=>e.key.trim().length>0));return o.forEach((e=>{d.add(e.key)})),o})),g=l.map((t=>{const n=Object.values((0,Bo.tI)(t.runUuid,e)).filter((e=>e.key.trim().length>0));return n.forEach((e=>{c.add(e.key)})),n})),h=l.map((t=>(0,E.pickBy)((0,Bo.X3)(t.runUuid,e),(e=>e.key.trim().length>0)))),f=o[0];return{modelVersionsByRunUuid:s,experimentTags:a?{}:(0,Bo.xy)(f,e),runInfos:l,paramsList:g,tagsList:h,metricsList:m,runUuidsMatchingFilter:i,datasetsList:u,inputsOutputsList:p,metricKeyList:Array.from(d.values()).sort(),paramKeyList:Array.from(c.values()).sort()}};var No=n(69708),Oo=n(39416),Po=n(62448);const Ho=(e,t,n)=>{if(!e||!t.length)return null;return{...(0,Eo.TB)(t,{...e,runsPinned:n},Date.now()),requestedFacets:e}},Vo=(e,t,n,o=!1)=>{const a=(0,v.wA)(),[r,i]=(0,s.useState)((()=>Ko())),d=(0,s.useMemo)((()=>n?JSON.stringify(n.sort()):null),[n]),[c,u]=(0,s.useState)(!0),[p,m]=(0,s.useState)(!0),[g,h]=(0,s.useState)(null),[f,_]=(0,s.useState)(null),y=(0,s.useRef)([]),x=(0,s.useRef)(null),b=(0,s.useRef)(null),C=(0,s.useRef)(null);(0,s.useEffect)((()=>{o||(m(!0),i(Ko()))}),[d,o]);const Y=(0,s.useCallback)(((e,t,n)=>{i(Uo(e,{datasetsFilter:n.datasetsFilter,lifecycleFilter:n.lifecycleFilter,modelVersionFilter:n.modelVersionFilter,experiments:[],experimentIds:t}))}),[]);(0,s.useEffect)((()=>{y.current=e.runsPinned}),[e.runsPinned]);const k=(0,s.useCallback)((e=>{(0,Eo.iH)(e||[],No.hY,a).catch((e=>{var t;const n=null!==(t=e instanceof L.s?(0,Po.h)(e):e)&&void 0!==t?t:e,o=n instanceof L.s?n.getMessageField():n.message;w.A.displayGlobalErrorNotification(`Failed to load model versions for runs: ${o}`)}))}),[a]),I=(0,s.useCallback)(((e,t={})=>a(((n,o)=>(t.isAutoRefreshing||(u(!0),b.current=e),n((e.pageToken?l.e$:l.bn)(e)).then((async({value:n})=>{var a;return x.current=Date.now(),u(!1),m(!1),_(null),b.current&&null!==(a=t.discardResultsFn)&&void 0!==a&&a.call(t,b.current,n)||(C.current=e,h(n.next_page_token||null),Y(o(),e.experimentIds,e.requestedFacets),k(n.runs||[])),n})).catch((e=>{if(u(!1),m(!1),(0,H.Ng)()){if(e instanceof Oo.ZR)return void _(e);const t=(0,Po.h)(e);if(t)return void _(t)}_(e),(0,H.Ng)()||w.A.logErrorAndNotifyUser(e)})))))),[a,Y,k]);(0,s.useEffect)((()=>{if(o)return;const e=Ho(t,n,y.current);e&&I(e)}),[I,a,o,t,n]);const A=(0,s.useCallback)((()=>{C.current&&I({...C.current,pageToken:void 0})}),[I]);return(({experimentIds:e,lastFetchedTime:t,fetchRuns:n,searchFacets:o,enabled:a,cachedPinnedRuns:r,runsData:i,isLoadingRuns:d})=>{const c=(0,s.useRef)(void 0),u=(0,s.useRef)(d),p=(0,s.useRef)(a),m=(0,s.useRef)(i.runInfos);m.current=i.runInfos,u.current=d,p.current=a,(0,s.useEffect)((()=>{if(window.clearTimeout(c.current),!a||d)return;const s=async()=>{const a=Boolean(t.current),i=t.current?Date.now()-t.current:0;if(o&&a&&i>=Eo.t4){const t=m.current.length,a=Math.max(1,Math.ceil(t/l.Aj))*l.Aj,s={...(0,Eo.TB)(e,{...o,runsPinned:r.current},Date.now()),requestedFacets:o,maxResults:a};let i,d=0,c=0;const u=(e,n)=>{var o,r;return!!(c+(null!==(o=null===n||void 0===n||null===(r=n.runs)||void 0===r?void 0:r.length)&&void 0!==o?o:0)<a&&null!==n&&void 0!==n&&n.next_page_token)||!p.current||t>a||!(0,E.isEqual)(e.requestedFacets,s.requestedFacets)};for(;(0===d||i)&&!(c>=a);){d++;const e=await n({...s,pageToken:i},{isAutoRefreshing:!0,discardResultsFn:u});c+=(0,E.isArray)(null===e||void 0===e?void 0:e.runs)?e.runs.length:0,i=null===e||void 0===e?void 0:e.next_page_token}}window.clearTimeout(c.current),p.current&&(c.current=window.setTimeout(s,Eo.t4))};return s(),()=>{clearTimeout(c.current)}}),[e,n,o,a,r,t,d])})({experimentIds:n,fetchRuns:I,searchFacets:t,enabled:e.autoRefreshEnabled&&(0,H.Hn)(),cachedPinnedRuns:y,runsData:r,isLoadingRuns:c,lastFetchedTime:x}),{isLoadingRuns:c,moreRunsAvailable:Boolean(g),refreshRuns:A,loadMoreRuns:async()=>{const e=Ho(t,n,y.current);return g&&e?I({...e,pageToken:g}):[]},isInitialLoadingRuns:p,runsData:r,requestError:f}},Ko=()=>({datasetsList:[],experimentTags:{},metricKeyList:[],metricsList:[],modelVersionsByRunUuid:{},paramKeyList:[],paramsList:[],runInfos:[],runUuidsMatchingFilter:[],tagsList:[],inputsOutputsList:[]}),zo=(e,t,n=!1)=>{const[o]=(0,m.ok)(),a=(0,V.A)(),r=o.get(d.ex),i=Boolean(r),l=(0,Xe.Px)(),[c,u]=(0,s.useState)(null),[p,h]=(0,s.useState)(null),[f,v]=(0,s.useState)(null),[_,y]=(0,s.useState)(null);(0,s.useEffect)((()=>{if(!r||!t)return;const e=t.tags.find((({key:e})=>e===`${d.o6}${r}`));if(!e)return u(null),h(null),v(`Error loading shared view state: share key ${r} does not exist`),void y(a.formatMessage({id:"s2L+xL",defaultMessage:'Error loading shared view state: share key "{viewStateShareKey}" does not exist'},{viewStateShareKey:r}));(async e=>{try{const t=await(async e=>(0,xt.ib)(e)?JSON.parse(await(0,xt.U1)(e)):JSON.parse(e))(e.value),n=(0,E.pick)(t,Xe.sO),o=(0,E.pick)(t,En.HC);u(n),h(o),v(null),y(null)}catch(t){u(null),h(null),v("Error loading shared view state: share key is invalid"),y(a.formatMessage({id:"Isig6r",defaultMessage:"Error loading shared view state: share key is invalid"}))}})(e)}),[t,r,a]),(0,s.useEffect)((()=>{c&&!n&&l(c,{replace:!0})}),[c,n]),(0,s.useEffect)((()=>{p&&!n&&e(p)}),[e,p,n]);const x=(0,m.Zp)();return(0,s.useEffect)((()=>{n||f&&t&&(w.A.logErrorAndNotifyUser(new Error(f)),w.A.displayGlobalErrorNotification(_,3),x(g.Ay.getExperimentPageRoute(t.experimentId),{replace:!0}))}),[f,_,t,x,n]),{isViewStateShared:i,sharedStateError:f}},Go=[(e,t,n,o)=>{if(o)return t;const a=n.runInfos.filter(((e,t)=>{var o,a;return(null===(o=n.tagsList[t])||void 0===o||null===(a=o[d.yU])||void 0===a?void 0:a.value)===d.m4})).map((({runUuid:e})=>e)),r=(0,E.compact)(n.runInfos.map((({runUuid:e},t)=>{var o;return a.includes(e)&&(null===(o=n.tagsList[t])||void 0===o?void 0:o[_.Ol].value)})));return r.length?{...t,runsExpanded:r.reduce(((e,t)=>({...e,[t]:!0})),t.runsExpanded)}:t}],jo=(0,En.uY)(),qo=(e,t)=>{if(0===e.runInfos.length||0===t.length)return null;const n=t.map((e=>e.experimentId)).sort(),o=e.runInfos.map((e=>e.runUuid)).sort();return`${n.join(":")}:${o.join(":")}`};var Wo=n(62702),$o=n(54786),Jo=n(45194);var Qo={name:"1g7ixto",styles:"height:100%;display:flex;align-items:center;justify-content:center"};const Xo=()=>(0,h.Y)("div",{css:Qo,children:(0,h.Y)(r.Empty,{description:(0,h.Y)(c.A,{id:"VMVNTR",defaultMessage:"Requested experiment was not found."}),image:(0,h.Y)(r.NoIcon,{}),title:(0,h.Y)(c.A,{id:"/sk75d",defaultMessage:"Experiment not found"})})});var Zo={name:"1g7ixto",styles:"height:100%;display:flex;align-items:center;justify-content:center"};const ea=()=>(0,h.Y)("div",{css:Zo,children:(0,h.Y)(r.Empty,{description:(0,h.Y)(c.A,{id:"PSFpHG",defaultMessage:"You don't have permissions to open requested experiment."}),image:(0,h.Y)(r.NoIcon,{}),title:(0,h.Y)(c.A,{id:"cIV9pX",defaultMessage:"Permission denied"})})});var ta={name:"1wnowod",styles:"display:flex;align-items:center;justify-content:center"};const na=({error:e,image:t,title:n,button:o,className:s})=>(0,h.Y)("div",{css:ta,className:s,children:(0,h.Y)(r.Empty,{description:e.message,image:null!==t&&void 0!==t?t:(0,h.Y)(a.W,{}),title:null!==n&&void 0!==n?n:(0,h.Y)(c.A,{id:"G/zTTY",defaultMessage:"Error"}),button:o})});var oa=n(22647),aa=n(11039),ra=n(83667),sa=n(62230),ia=n(7355),la=n(15543);var da={name:"13udsys",styles:"height:100%"},ca={name:"1h8i7is",styles:"overflow-y:hidden;flex-shrink:0;transition:max-height .12s"};const ua=({showHeader:e=!0})=>{var t,n,c;const u=(0,v.wA)(),{theme:p}=(0,a.u)(),[m,g,_]=(0,Xe.sR)(),[y]=(0,Be.an)(),x=(b=g,(0,v.d4)((e=>b.map((t=>e.entities.experimentsById[t])).filter(Boolean)),((e,t)=>(0,E.isEqual)(e,t))));var b;const[C]=x,{fetchExperiments:Y,isLoadingExperiment:k,requestError:I}=(()=>{const e=(0,s.useContext)(Mo.Y);if(!e)throw new Error("Trying to use GetExperimentsContext actions outside of the context!");return e})(),{elementHeight:A,observeHeight:S}=(e=>{const[t,n]=(0,s.useState)(null),[o,a]=(0,s.useState)(void 0);return(0,s.useEffect)((()=>{if(!t||!window.ResizeObserver)return;const n=new ResizeObserver((([t])=>{null===e||void 0===e||e(t),t.target.scrollHeight&&a(t.target.scrollHeight)}));return n.observe(t),()=>n.disconnect()}),[t,e]),{elementHeight:o,observeHeight:n}})(),[M,R]=(0,s.useState)(!1),[D,T]=(0,s.useState)(!0),[F,B,U]=(e=>{const t=(0,s.useMemo)((()=>JSON.stringify(e.sort())),[e]),[n,o]=(0,s.useState)(null),[{uiState:a,isSeeded:r,isFirstVisit:i},l]=((0,Xe.Px)(),(0,s.useReducer)(((e,t)=>{if("UPDATE_UI_STATE"===t.type){const n="function"===typeof t.payload?t.payload(e.uiState):t.payload;return{...e,uiState:n}}return"INITIAL_UI_STATE_SEEDED"===t.type?e.isSeeded?e:{...e,isSeeded:!0}:"LOAD_NEW_EXPERIMENT"===t.type?{uiState:t.payload.uiState,isFirstVisit:t.payload.isFirstVisit,currentPersistKey:t.payload.newPersistKey,isSeeded:t.payload.isSeeded}:e}),void 0,(()=>{const e=Do(t),n=Boolean((0,E.keys)(e||{}).length),o=n?(0,E.pick)(e,En.HC):{};return{uiState:{...jo,...o},isSeeded:n,isFirstVisit:!n,currentPersistKey:t}}))),d=(0,s.useCallback)((e=>{l({type:"UPDATE_UI_STATE",payload:e})}),[]),c=(0,s.useCallback)(((e,t)=>{if(!i||0===e.length||0===t.runInfos.length)return;const a=qo(t,e);n===a&&r||r&&!(0,H.kj)()||(d((n=>Go.reduce(((n,o)=>o(e,n,t,r)),{...n}))),o(a),r||l({type:"INITIAL_UI_STATE_SEEDED"}))}),[r,i,d,n]);return(0,s.useEffect)((()=>{const e=Do(t),n=(0,E.pick)(e,En.HC),o=Boolean((0,E.keys)(e||{}).length),a=!o;l({type:"LOAD_NEW_EXPERIMENT",payload:{uiState:{...jo,...n},isSeeded:o,isFirstVisit:a,newPersistKey:t}})}),[t]),[a,d,c]})(g),{isViewStateShared:N}=zo(B,(0,E.first)(x)),O=F.viewMaximized,{isLoadingRuns:P,loadMoreRuns:V,runsData:K,moreRunsAvailable:z,requestError:G,refreshRuns:j}=Vo(F,m,g);(0,s.useEffect)((()=>{g.every((e=>x.find((t=>t.experimentId===e))))||Y(g)}),[Y,g,x]),(0,s.useEffect)((()=>{U(x,K)}),[U,x,K]),(0,s.useEffect)((()=>{const e=(0,l.wT)(g);u(e).catch((e=>{(0,H.Ng)()||w.A.logErrorAndNotifyUser(e)}))}),[u,g]);const q=g.length>1;To(F,m,g,N||_);const W=Boolean(!k&&x[0]&&K&&m),{mutate:$,isLoading:J}=(0,sa.G)((()=>{if(!q)return u((0,l.yc)(g[0]))})),Q=(0,ra.BH)(null===(t=(0,E.first)(x))||void 0===t?void 0:t.tags),X=null===(n=(0,E.first)(x))||void 0===n?void 0:n.experimentId,{inferredExperimentKind:Z,isLoading:ee,dismiss:te}=(0,ia.F)({experimentId:X,isLoadingExperiment:k,enabled:e&&!q&&(0,H.XQ)()&&!Q,experimentTags:null===(c=(0,E.first)(x))||void 0===c?void 0:c.tags,updateExperimentKind:$});if(I instanceof Oo.m_||I instanceof L.s&&I.getErrorCode()===i.tG.RESOURCE_DOES_NOT_EXIST)return(0,h.Y)(Xo,{});if(I instanceof Oo.i_||I instanceof L.s&&I.getErrorCode()===i.tG.PERMISSION_DENIED)return(0,h.Y)(ea,{});if(I instanceof Error)return(0,h.Y)(na,{css:da,error:I});if(!W)return(0,h.Y)(r.LegacySkeleton,{});le()(m,"searchFacets should be initialized at this point");const ne=k||!x[0];if(Z===d.Gk.NO_INFERRED_TYPE&&(0,H.XQ)())return(0,h.Y)(la.T,{onConfirm:e=>{X&&$({experimentId:X,kind:e},{onSettled:te})},onDismiss:te});return(0,h.Y)(et.i,{setUIState:B,children:(0,h.FD)("div",{css:pa.experimentViewWrapper,children:[ne?(0,h.Y)(r.LegacySkeleton,{title:!0,paragraph:!1,active:!0}):e?(0,h.Y)(h.FK,{children:q?(0,h.Y)(f,{experiments:x}):(0,h.FD)(h.FK,{children:[(0,H.w7)()?(0,h.FD)(h.FK,{children:[(0,h.Y)(oa.i,{experiment:C,searchFacetsState:m||void 0,uiState:F,setEditing:R,experimentKindSelector:!q&&X?(0,h.Y)(aa.f,{value:Q,inferredExperimentKind:Z,onChange:e=>$({experimentId:X,kind:e}),isUpdating:J||ee,readOnly:!1},Z):null}),(0,h.Y)("div",{css:(0,o.AH)({width:"100%",borderTop:`1px solid ${p.colors.border}`,marginTop:p.spacing.sm,marginBottom:p.spacing.sm},"")})]}):(0,h.Y)($o.i,{experiment:C,searchFacetsState:m||void 0,uiState:F,showAddDescriptionButton:D,setEditing:R}),(0,h.Y)("div",{style:{maxHeight:O?0:A},css:ca,children:(0,h.Y)("div",{ref:S,children:(0,h.Y)(Wo.A,{experiment:C,setShowAddDescriptionButton:T,editing:M,setEditing:R})})})]})}):(0,h.FD)(h.FK,{children:[null,null]}),"TRACES"===y?(0,h.Y)(Jo.$,{experimentIds:g}):(0,h.Y)(So,{isLoading:!1,experiments:x,isLoadingRuns:P,runsData:K,searchFacetsState:m,loadMoreRuns:V,moreRunsAvailable:z,requestError:G,refreshRuns:j,uiState:F})]})})},pa={experimentViewWrapper:{height:"100%",display:"flex",flexDirection:"column"}}},89736:function(e,t,n){n.d(t,{Y:function(){return u},Z:function(){return p}});var o=n(9133),a=n(31014),r=n(62448),s=n(91144),i=n(68621),l=n(76010),d=n(10811),c=n(50111);const u=(0,a.createContext)(null),p=({children:e,actions:t})=>{const[n,p]=(0,a.useState)([]),[m,g]=(0,a.useState)(!1),[h,f]=(0,a.useState)(null),v=(0,d.wA)(),_=(0,a.useCallback)((e=>{f(null),(()=>{const n=e.map((e=>{const n=t.getExperimentApi(e);return v(n).catch((e=>{(0,s.Ng)()||l.A.logErrorAndNotifyUser(e)})),n.meta.id}));p((e=>(0,o.isEqual)(n,e)?e:n))})()}),[t,v]),y=(0,a.useMemo)((()=>({fetchExperiments:_,isLoadingExperiment:m,requestError:h,actions:t})),[t,_,m,h]);return(0,c.Y)(u.Provider,{value:y,children:(0,c.Y)(i.Ay,{shouldOptimisticallyRender:!0,requestIds:n,children:(t,o,a)=>(g(a.some((e=>n.includes(e.id)&&e.active))),h||a.forEach((e=>{if(e.error){if((0,s.Ng)()){const t=(0,r.h)(e.error);if(t)return void f(t)}f(e.error)}})),e)})})}},96070:function(e,t,n){n.d(t,{$K:function(){return i},M8:function(){return u},jP:function(){return c},tY:function(){return s}});var o=n(31014),a=n(98590),r=n(50111);const s=e=>e.filter((e=>!e.startsWith(a.nt))).map((e=>e.includes('"')||e.includes(" ")||e.includes(".")?`\`${e}\``:e.includes("`")?`"${e}"`:e)),i=(e,t)=>[{label:"Metrics",options:e.metricNames.map((e=>({value:`metrics.${e}`})))},{label:"Parameters",options:e.paramNames.map((e=>({value:`params.${e}`})))},{label:"Tags",options:e.tagNames.map((e=>({value:`tags.${e}`})))},{label:"Attributes",options:t}];var l={name:"lugakg",styles:"font-weight:normal"};const d=(e,t)=>{const n=e.split(RegExp(t.replace(".","\\."),"ig")),a=e.match(RegExp(t.replace(".","\\."),"ig"));return(0,r.Y)("span",{css:l,"data-testid":e,children:n.map(((e,t)=>(0,r.FD)(o.Fragment,{children:[e,t!==n.length-1&&a&&(0,r.Y)("b",{children:a[t]})]},t)))})},c=e=>{const t=/>|<|>=|<=|=|!=|like|ilike/gi,n=(e=>{const t=/and[\s]+/gi,n=[];let o,a;for(;a=t.lastIndex,o=t.exec(e);)n.push({clause:e.substring(a,o.index),startIndex:a});return n.push({clause:e.substring(a),startIndex:a}),n})(e),o=[];return n.forEach((e=>{const n=e.clause.split(t)[0],{startIndex:a}=e;o.push({name:n,startIndex:0+a,endIndex:n.length+a})})),o},u=(e,t,n)=>e.map((e=>{const o=e.options.filter((e=>e.value.toLowerCase().includes(t.name.toLowerCase().trim()))).map((e=>({value:e.value,label:d(e.value,t.name.trim())}))),a=n[e.label],r=[...o.slice(0,a),...o.length>a?[{label:"...",value:`..._${e.label}`}]:[]];return{label:e.label,options:r}})).filter((e=>e.options.length>0))}}]);
//# sourceMappingURL=7863.7f2f62cc.chunk.js.map