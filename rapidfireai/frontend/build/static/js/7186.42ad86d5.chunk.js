"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[7186],{52416:function(e,t,a){var n=a(5738),o=a(47216),r=a(20184),i=r.axisHoverFormat,l=r.descriptionOnlyNumbers,s=a(97451),c=a(34418).T,p=a(5153),u=a(87241).extendFlat,h=a(166),d=h.COMPARISON_OPS2,f=h.INTERVAL_OPS,v=o.line;e.exports=u({z:n.z,x:n.x,x0:n.x0,dx:n.dx,y:n.y,y0:n.y0,dy:n.dy,xperiod:n.xperiod,yperiod:n.yperiod,xperiod0:o.xperiod0,yperiod0:o.yperiod0,xperiodalignment:n.xperiodalignment,yperiodalignment:n.yperiodalignment,text:n.text,hovertext:n.hovertext,transpose:n.transpose,xtype:n.xtype,ytype:n.ytype,xhoverformat:i("x"),yhoverformat:i("y"),zhoverformat:i("z",1),hovertemplate:n.hovertemplate,hoverongaps:n.hoverongaps,connectgaps:u({},n.connectgaps,{description:["Determines whether or not gaps","(i.e. {nan} or missing values)","in the `z` data are filled in.","It is defaulted to true if `z` is a","one dimensional array","otherwise it is defaulted to false."].join(" ")}),fillcolor:{valType:"color",editType:"calc",description:["Sets the fill color if `contours.type` is *constraint*.","Defaults to a half-transparent variant of the line color,","marker color, or marker line color, whichever is available."].join(" ")},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0},description:["Determines whether or not the contour level attributes are","picked by an algorithm.","If *true*, the number of contour levels can be set in `ncontours`.","If *false*, set the contour level attributes in `contours`."].join(" ")},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc",description:["Sets the maximum number of contour levels. The actual number","of contours will be chosen automatically to be less than or","equal to the value of `ncontours`.","Has an effect only if `autocontour` is *true* or if","`contours.size` is missing."].join(" ")},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc",description:["If `levels`, the data is represented as a contour plot with multiple","levels displayed. If `constraint`, the data is represented as constraints","with the invalid region shaded as specified by the `operation` and","`value` parameters."].join(" ")},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1},description:["Sets the starting contour level value.","Must be less than `contours.end`"].join(" ")},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1},description:["Sets the end contour level value.","Must be more than `contours.start`"].join(" ")},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1},description:["Sets the step between each contour level.","Must be positive."].join(" ")},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc",description:["Determines the coloring method showing the contour values.","If *fill*, coloring is done evenly between each contour level","If *heatmap*, a heatmap gradient coloring is applied","between each contour level.","If *lines*, coloring is done on the contour lines.","If *none*, no coloring is applied on this trace."].join(" ")},showlines:{valType:"boolean",dflt:!0,editType:"plot",description:["Determines whether or not the contour lines are drawn.","Has an effect only if `contours.coloring` is set to *fill*."].join(" ")},showlabels:{valType:"boolean",dflt:!1,editType:"plot",description:["Determines whether to label the contour lines with their values."].join(" ")},labelfont:p({editType:"plot",colorEditType:"style",description:["Sets the font used for labeling the contour levels.","The default color comes from the lines, if shown.","The default family and size come from `layout.font`."].join(" ")}),labelformat:{valType:"string",dflt:"",editType:"plot",description:l("contour label")},operation:{valType:"enumerated",values:[].concat(d).concat(f),dflt:"=",editType:"calc",description:["Sets the constraint operation.","*=* keeps regions equal to `value`","*<* and *<=* keep regions less than `value`","*>* and *>=* keep regions greater than `value`","*[]*, *()*, *[)*, and *(]* keep regions inside `value[0]` to `value[1]`","*][*, *)(*, *](*, *)[* keep regions outside `value[0]` to value[1]`","Open vs. closed intervals make no difference to constraint display, but","all versions are allowed for consistency with filter transforms."].join(" ")},value:{valType:"any",dflt:0,editType:"calc",description:["Sets the value or values of the constraint boundary.","When `operation` is set to one of the comparison values","("+d+")","*value* is expected to be a number.","When `operation` is set to one of the interval values","("+f+")","*value* is expected to be an array of two numbers where the first","is the lower bound and the second is the upper bound."].join(" ")},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:u({},v.color,{editType:"style+colorbars",description:["Sets the color of the contour level.","Has no effect if `contours.coloring` is set to *lines*."].join(" ")}),width:{valType:"number",min:0,editType:"style+colorbars",description:["Sets the contour line width in (in px)","Defaults to *0.5* when `contours.type` is *levels*.","Defaults to *2* when `contour.type` is *constraint*."].join(" ")},dash:c,smoothing:u({},v.smoothing,{description:["Sets the amount of smoothing for the contour lines,","where *0* corresponds to no smoothing."].join(" ")}),editType:"plot"}},s("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},56240:function(e,t,a){var n=a(47624),o=a(63846),r=a(22632),i=a(23003);e.exports=function(e,t){var a=o(e,t),l=a[0].z;r(t,l);var s,c=t.contours,p=n.extractOpts(t);if("heatmap"===c.coloring&&p.auto&&!1===t.autocontour){var u=c.start,h=i(c),d=c.size||1,f=Math.floor((h-u)/d)+1;isFinite(d)||(d=1,f=1);var v=u-d/2;s=[v,v+f*d]}else s=l;return n.calc(e,t,{vals:s,cLetter:"z"}),a}},76142:function(e){e.exports=function(e,t){var a,n=e[0],o=n.z;switch(t.type){case"levels":var r=Math.min(o[0][0],o[0][1]);for(a=0;a<e.length;a++){var i=e[a];i.prefixBoundary=!i.edgepaths.length&&(r>i.level||i.starts.length&&r===i.level)}break;case"constraint":if(n.prefixBoundary=!1,n.edgepaths.length)return;var l=n.x.length,s=n.y.length,c=-1/0,p=1/0;for(a=0;a<s;a++)p=Math.min(p,o[a][0]),p=Math.min(p,o[a][l-1]),c=Math.max(c,o[a][0]),c=Math.max(c,o[a][l-1]);for(a=1;a<l-1;a++)p=Math.min(p,o[0][a]),p=Math.min(p,o[s-1][a]),c=Math.max(c,o[0][a]),c=Math.max(c,o[s-1][a]);var u,h,d=t.value;switch(t._operation){case">":d>c&&(n.prefixBoundary=!0);break;case"<":(d<p||n.starts.length&&d===p)&&(n.prefixBoundary=!0);break;case"[]":u=Math.min(d[0],d[1]),((h=Math.max(d[0],d[1]))<p||u>c||n.starts.length&&h===p)&&(n.prefixBoundary=!0);break;case"][":u=Math.min(d[0],d[1]),h=Math.max(d[0],d[1]),u<p&&h>c&&(n.prefixBoundary=!0)}}}},68201:function(e,t,a){var n=a(47624),o=a(71686),r=a(23003);e.exports={min:"zmin",max:"zmax",calc:function(e,t,a){var i=t.contours,l=t.line,s=i.size||1,c=i.coloring,p=o(t,{isColorbar:!0});if("heatmap"===c){var u=n.extractOpts(t);a._fillgradient=u.reversescale?n.flipScale(u.colorscale):u.colorscale,a._zrange=[u.min,u.max]}else"fill"===c&&(a._fillcolor=p);a._line={color:"lines"===c?p:l.color,width:!1!==i.showlines?l.width:0,dash:l.dash},a._levels={start:i.start,end:r(i),size:s}}}},14612:function(e){e.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},99727:function(e,t,a){var n=a(83491),o=a(19952),r=a(31454),i=r.addOpacity,l=r.opacity,s=a(166),c=s.CONSTRAINT_REDUCTION,p=s.COMPARISON_OPS2;e.exports=function(e,t,a,r,s,u){var h,d,f,v=t.contours,g=a("contours.operation");(v._operation=c[g],function(e,t){var a;-1===p.indexOf(t.operation)?(e("contours.value",[0,1]),Array.isArray(t.value)?t.value.length>2?t.value=t.value.slice(2):0===t.length?t.value=[0,1]:t.length<2?(a=parseFloat(t.value[0]),t.value=[a,a+1]):t.value=[parseFloat(t.value[0]),parseFloat(t.value[1])]:n(t.value)&&(a=parseFloat(t.value),t.value=[a,a+1])):(e("contours.value",0),n(t.value)||(Array.isArray(t.value)?t.value=parseFloat(t.value[0]):t.value=0))}(a,v),"="===g?h=v.showlines=!0:(h=a("contours.showlines"),f=a("fillcolor",i((e.line||{}).color||s,.5))),h)&&(d=a("line.color",f&&l(f)?i(t.fillcolor,1):s),a("line.width",2),a("line.dash"));a("line.smoothing"),o(a,r,d,u)}},48847:function(e,t,a){var n=a(166),o=a(83491);function r(e,t){var a,r=Array.isArray(t);function i(e){return o(e)?+e:null}return-1!==n.COMPARISON_OPS2.indexOf(e)?a=i(r?t[0]:t):-1!==n.INTERVAL_OPS.indexOf(e)?a=r?[i(t[0]),i(t[1])]:[i(t),i(t)]:-1!==n.SET_OPS.indexOf(e)&&(a=r?t.map(i):[i(t)]),a}function i(e){return function(t){t=r(e,t);var a=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]);return{start:a,end:n,size:n-a}}}function l(e){return function(t){return{start:t=r(e,t),end:1/0,size:1/0}}}e.exports={"[]":i("[]"),"][":i("]["),">":l(">"),"<":l("<"),"=":l("=")}},20567:function(e){e.exports=function(e,t,a,n){var o=n("contours.start"),r=n("contours.end"),i=!1===o||!1===r,l=a("contours.size");!(i?t.autocontour=!0:a("autocontour",!1))&&l||a("ncontours")}},77599:function(e,t,a){var n=a(47401);function o(e){return n.extendFlat({},e,{edgepaths:n.extendDeep([],e.edgepaths),paths:n.extendDeep([],e.paths),starts:n.extendDeep([],e.starts)})}e.exports=function(e,t){var a,r,i,l=function(e){return e.reverse()},s=function(e){return e};switch(t){case"=":case"<":return e;case">":for(1!==e.length&&n.warn("Contour data invalid for the specified inequality operation."),r=e[0],a=0;a<r.edgepaths.length;a++)r.edgepaths[a]=l(r.edgepaths[a]);for(a=0;a<r.paths.length;a++)r.paths[a]=l(r.paths[a]);for(a=0;a<r.starts.length;a++)r.starts[a]=l(r.starts[a]);return e;case"][":var c=l;l=s,s=c;case"[]":for(2!==e.length&&n.warn("Contour data invalid for the specified inequality range operation."),r=o(e[0]),i=o(e[1]),a=0;a<r.edgepaths.length;a++)r.edgepaths[a]=l(r.edgepaths[a]);for(a=0;a<r.paths.length;a++)r.paths[a]=l(r.paths[a]);for(a=0;a<r.starts.length;a++)r.starts[a]=l(r.starts[a]);for(;i.edgepaths.length;)r.edgepaths.push(s(i.edgepaths.shift()));for(;i.paths.length;)r.paths.push(s(i.paths.shift()));for(;i.starts.length;)r.starts.push(s(i.starts.shift()));return[r]}}},52855:function(e,t,a){var n=a(47401),o=a(7497),r=a(75781),i=a(99727),l=a(20567),s=a(67137),c=a(52416);e.exports=function(e,t,a,p){function u(a,o){return n.coerce(e,t,c,a,o)}if(o(e,t,u,p)){r(e,t,p,u),u("xhoverformat"),u("yhoverformat"),u("text"),u("hovertext"),u("hovertemplate"),u("hoverongaps");var h="constraint"===u("contours.type");u("connectgaps",n.isArray1D(t.z)),h?i(e,t,u,p,a):(l(e,t,u,(function(a){return n.coerce2(e,t,c,a)})),s(e,t,u,p))}else t.visible=!1}},54460:function(e,t,a){var n=a(47401),o=a(48847),r=a(23003);e.exports=function(e,t,a){for(var i="constraint"===e.type?o[e._operation](e.value):e,l=i.size,s=[],c=r(i),p=a.trace._carpetTrace,u=p?{xaxis:p.aaxis,yaxis:p.baxis,x:a.a,y:a.b}:{xaxis:t.xaxis,yaxis:t.yaxis,x:a.x,y:a.y},h=i.start;h<c;h+=l)if(s.push(n.extendFlat({level:h,crossings:{},starts:[],edgepaths:[],paths:[],z:a.z,smoothing:a.trace.line.smoothing},u)),s.length>1e3){n.warn("Too many contours, clipping at 1000",e);break}return s}},23003:function(e){e.exports=function(e){return e.end+e.size/1e6}},26809:function(e,t,a){var n=a(47401),o=a(14612);function r(e,t,a,n){return Math.abs(e[0]-t[0])<a&&Math.abs(e[1]-t[1])<n}function i(e,t){var a=e[2]-t[2],n=e[3]-t[3];return Math.sqrt(a*a+n*n)}function l(e,t,a,l,c){var p,u=t.join(","),h=e.crossings[u],d=function(e,t,a){var n=0,r=0;e>20&&t?208===e||1114===e?n=0===a[0]?1:-1:r=0===a[1]?1:-1:-1!==o.BOTTOMSTART.indexOf(e)?r=1:-1!==o.LEFTSTART.indexOf(e)?n=1:-1!==o.TOPSTART.indexOf(e)?r=-1:n=-1;return[n,r]}(h,a,t),f=[s(e,t,[-d[0],-d[1]])],v=e.z.length,g=e.z[0].length,x=t.slice(),m=d.slice();for(p=0;p<1e4;p++){if(h>20?(h=o.CHOOSESADDLE[h][(d[0]||d[1])<0?0:1],e.crossings[u]=o.SADDLEREMAINDER[h]):delete e.crossings[u],!(d=o.NEWDELTA[h])){n.log("Found bad marching index:",h,t,e.level);break}f.push(s(e,t,d)),t[0]+=d[0],t[1]+=d[1],u=t.join(","),r(f[f.length-1],f[f.length-2],l,c)&&f.pop();var y=d[0]&&(t[0]<0||t[0]>g-2)||d[1]&&(t[1]<0||t[1]>v-2);if(t[0]===x[0]&&t[1]===x[1]&&d[0]===m[0]&&d[1]===m[1]||a&&y)break;h=e.crossings[u]}1e4===p&&n.log("Infinite loop in contour?");var b,T,w,L,M,A,S,z,k,_,O,I=r(f[0],f[f.length-1],l,c),E=0,D=.2*e.smoothing,C=[],R=0;for(p=1;p<f.length;p++)E+=S=i(f[p],f[p-1]),C.push(S);var B=E/C.length*D;function j(e){return f[e%f.length]}for(p=f.length-2;p>=R;p--)if((b=C[p])<B){for(w=0,T=p-1;T>=R&&b+C[T]<B;T--)b+=C[T];if(I&&p===f.length-2)for(w=0;w<T&&b+C[w]<B;w++)b+=C[w];M=p-T+w+1,A=Math.floor((p+T+w+2)/2),L=I||p!==f.length-2?I||-1!==T?M%2?j(A):[(j(A)[0]+j(A+1)[0])/2,(j(A)[1]+j(A+1)[1])/2]:f[0]:f[f.length-1],f.splice(T+1,p-T+1,L),p=T+1,w&&(R=w),I&&(p===f.length-2?f[w]=f[f.length-1]:0===p&&(f[f.length-1]=f[0]))}for(f.splice(0,R),p=0;p<f.length;p++)f[p].length=2;if(!(f.length<2))if(I)f.pop(),e.paths.push(f);else{a||n.log("Unclosed interior contour?",e.level,x.join(","),f.join("L"));var N=!1;for(z=0;z<e.edgepaths.length;z++)if(_=e.edgepaths[z],!N&&r(_[0],f[f.length-1],l,c)){f.pop(),N=!0;var P=!1;for(k=0;k<e.edgepaths.length;k++)if(r((O=e.edgepaths[k])[O.length-1],f[0],l,c)){P=!0,f.shift(),e.edgepaths.splice(z,1),k===z?e.paths.push(f.concat(O)):(k>z&&k--,e.edgepaths[k]=O.concat(f,_));break}P||(e.edgepaths[z]=f.concat(_))}for(z=0;z<e.edgepaths.length&&!N;z++)r((_=e.edgepaths[z])[_.length-1],f[0],l,c)&&(f.shift(),e.edgepaths[z]=_.concat(f),N=!0);N||e.edgepaths.push(f)}}function s(e,t,a){var n=t[0]+Math.max(a[0],0),o=t[1]+Math.max(a[1],0),r=e.z[o][n],i=e.xaxis,l=e.yaxis;if(a[1]){var s=(e.level-r)/(e.z[o][n+1]-r);return[i.c2p((1-s)*e.x[n]+s*e.x[n+1],!0),l.c2p(e.y[o],!0),n+s,o]}var c=(e.level-r)/(e.z[o+1][n]-r);return[i.c2p(e.x[n],!0),l.c2p((1-c)*e.y[o]+c*e.y[o+1],!0),n,o+c]}e.exports=function(e,t,a){var o,r,i,s;for(t=t||.01,a=a||.01,r=0;r<e.length;r++){for(i=e[r],s=0;s<i.starts.length;s++)l(i,i.starts[s],"edge",t,a);for(o=0;Object.keys(i.crossings).length&&o<1e4;)o++,l(i,Object.keys(i.crossings)[0].split(",").map(Number),void 0,t,a);1e4===o&&n.log("Infinite loop in contour?")}}},51303:function(e,t,a){var n=a(31454),o=a(77301);e.exports=function(e,t,a,r,i){i||(i={}),i.isContour=!0;var l=o(e,t,a,r,i);return l&&l.forEach((function(e){var t=e.trace;"constraint"===t.contours.type&&(t.fillcolor&&n.opacity(t.fillcolor)?e.color=n.addOpacity(t.fillcolor,1):t.contours.showlines&&n.opacity(t.line.color)&&(e.color=n.addOpacity(t.line.color,1)))})),l}},37085:function(e,t,a){e.exports={attributes:a(52416),supplyDefaults:a(52855),calc:a(56240),plot:a(22818).plot,style:a(72960),colorbar:a(68201),hoverPoints:a(51303),moduleType:"trace",name:"contour",basePlotModule:a(66807),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{description:["The data from which contour lines are computed is set in `z`.","Data in `z` must be a {2D array} of numbers.","Say that `z` has N rows and M columns, then by default,","these N rows correspond to N y coordinates","(set in `y` or auto-generated) and the M columns","correspond to M x coordinates (set in `x` or auto-generated).","By setting `transpose` to *true*, the above behavior is flipped."].join(" ")}}},19952:function(e,t,a){var n=a(47401);e.exports=function(e,t,a,o){if(o||(o={}),e("contours.showlabels")){var r=t.font;n.coerceFont(e,"contours.labelfont",{family:r.family,size:r.size,color:a}),e("contours.labelformat")}!1!==o.hasHover&&e("zhoverformat")}},71686:function(e,t,a){var n=a(62258),o=a(47624),r=a(23003);e.exports=function(e){var t=e.contours,a=t.start,i=r(t),l=t.size||1,s=Math.floor((i-a)/l)+1,c="lines"===t.coloring?0:1,p=o.extractOpts(e);isFinite(l)||(l=1,s=1);var u,h,d=p.reversescale?o.flipScale(p.colorscale):p.colorscale,f=d.length,v=new Array(f),g=new Array(f);if("heatmap"===t.coloring){var x=p.min,m=p.max;for(h=0;h<f;h++)u=d[h],v[h]=u[0]*(m-x)+x,g[h]=u[1];var y=n.extent([x,m,t.start,t.start+l*(s-1)]),b=y[x<m?0:1],T=y[x<m?1:0];b!==x&&(v.splice(0,0,b),g.splice(0,0,g[0])),T!==m&&(v.push(T),g.push(g[g.length-1]))}else for(h=0;h<f;h++)u=d[h],v[h]=(u[0]*(s+c-1)-c/2)*l+a,g[h]=u[1];return o.makeColorScaleFunc({domain:v,range:g},{noNumericCheck:!0})}},4361:function(e,t,a){var n=a(14612);function o(e,t){var a=(t[0][0]>e?0:1)+(t[0][1]>e?0:2)+(t[1][1]>e?0:4)+(t[1][0]>e?0:8);return 5===a||10===a?e>(t[0][0]+t[0][1]+t[1][0]+t[1][1])/4?5===a?713:1114:5===a?104:208:15===a?0:a}e.exports=function(e){var t,a,r,i,l,s,c,p,u,h=e[0].z,d=h.length,f=h[0].length,v=2===d||2===f;for(a=0;a<d-1;a++)for(i=[],0===a&&(i=i.concat(n.BOTTOMSTART)),a===d-2&&(i=i.concat(n.TOPSTART)),t=0;t<f-1;t++)for(r=i.slice(),0===t&&(r=r.concat(n.LEFTSTART)),t===f-2&&(r=r.concat(n.RIGHTSTART)),l=t+","+a,s=[[h[a][t],h[a][t+1]],[h[a+1][t],h[a+1][t+1]]],u=0;u<e.length;u++)(c=o((p=e[u]).level,s))&&(p.crossings[l]=c,-1!==r.indexOf(c)&&(p.starts.push([t,a]),v&&-1!==r.indexOf(c,r.indexOf(c)+1)&&p.starts.push([t,a])))}},22818:function(e,t,a){var n=a(62258),o=a(47401),r=a(41707),i=a(47624),l=a(43995),s=a(37762),c=a(58947),p=a(45396),u=a(4361),h=a(26809),d=a(54460),f=a(77599),v=a(76142),g=a(14612),x=g.LABELOPTIMIZER;function m(e,t){var a,n,i,l,s,c,p,u="",h=0,d=e.edgepaths.map((function(e,t){return t})),f=!0;function v(e){return Math.abs(e[1]-t[2][1])<.01}function g(e){return Math.abs(e[0]-t[0][0])<.01}function x(e){return Math.abs(e[0]-t[2][0])<.01}for(;d.length;){for(c=r.smoothopen(e.edgepaths[h],e.smoothing),u+=f?c:c.replace(/^M/,"L"),d.splice(d.indexOf(h),1),a=e.edgepaths[h][e.edgepaths[h].length-1],l=-1,i=0;i<4;i++){if(!a){o.log("Missing end?",h,e);break}for(p=a,Math.abs(p[1]-t[0][1])<.01&&!x(a)?n=t[1]:g(a)?n=t[0]:v(a)?n=t[3]:x(a)&&(n=t[2]),s=0;s<e.edgepaths.length;s++){var m=e.edgepaths[s][0];Math.abs(a[0]-n[0])<.01?Math.abs(a[0]-m[0])<.01&&(m[1]-a[1])*(n[1]-m[1])>=0&&(n=m,l=s):Math.abs(a[1]-n[1])<.01?Math.abs(a[1]-m[1])<.01&&(m[0]-a[0])*(n[0]-m[0])>=0&&(n=m,l=s):o.log("endpt to newendpt is not vert. or horz.",a,n,m)}if(a=n,l>=0)break;u+="L"+n}if(l===e.edgepaths.length){o.log("unclosed perimeter path");break}h=l,(f=-1===d.indexOf(h))&&(h=d[0],u+="Z")}for(h=0;h<e.paths.length;h++)u+=r.smoothclosed(e.paths[h],e.smoothing);return u}function y(e,t,a,n){var r=t.width/2,i=t.height/2,l=e.x,s=e.y,c=e.theta,p=Math.cos(c)*r,u=Math.sin(c)*r,h=(l>n.center?n.right-l:l-n.left)/(p+Math.abs(Math.sin(c)*i)),d=(s>n.middle?n.bottom-s:s-n.top)/(Math.abs(u)+Math.cos(c)*i);if(h<1||d<1)return 1/0;var f=x.EDGECOST*(1/(h-1)+1/(d-1));f+=x.ANGLECOST*c*c;for(var v=l-p,g=s-u,m=l+p,y=s+u,b=0;b<a.length;b++){var T=a[b],w=Math.cos(T.theta)*T.width/2,L=Math.sin(T.theta)*T.width/2,M=2*o.segmentDistance(v,g,m,y,T.x-w,T.y-L,T.x+w,T.y+L)/(t.height+T.height),A=T.level===t.level,S=A?x.SAMELEVELDISTANCE:1;if(M<=S)return 1/0;f+=x.NEIGHBORCOST*(A?x.SAMELEVELFACTOR:1)/(M-S)}return f}function b(e){var t,a,n=e.trace._emptypoints,o=[],r=e.z.length,i=e.z[0].length,l=[];for(t=0;t<i;t++)l.push(1);for(t=0;t<r;t++)o.push(l.slice());for(t=0;t<n.length;t++)o[(a=n[t])[0]][a[1]]=0;return e.zmask=o,o}t.plot=function(e,a,i,l){var s=a.xaxis,c=a.yaxis;o.makeTraceGroups(l,i,"contour").each((function(i){var l=n.select(this),x=i[0],y=x.trace,T=x.x,w=x.y,L=y.contours,M=d(L,a,x),A=o.ensureSingle(l,"g","heatmapcoloring"),S=[];"heatmap"===L.coloring&&(S=[i]),p(e,a,S,A),u(M),h(M);var z=s.c2p(T[0],!0),k=s.c2p(T[T.length-1],!0),_=c.c2p(w[0],!0),O=c.c2p(w[w.length-1],!0),I=[[z,O],[k,O],[k,_],[z,_]],E=M;"constraint"===L.type&&(E=f(M,L._operation)),function(e,t,a){var n=o.ensureSingle(e,"g","contourbg").selectAll("path").data("fill"===a.coloring?[0]:[]);n.enter().append("path"),n.exit().remove(),n.attr("d","M"+t.join("L")+"Z").style("stroke","none")}(l,I,L),function(e,t,a,r){var i="fill"===r.coloring||"constraint"===r.type&&"="!==r._operation,l="M"+a.join("L")+"Z";i&&v(t,r);var s=o.ensureSingle(e,"g","contourfill").selectAll("path").data(i?t:[]);s.enter().append("path"),s.exit().remove(),s.each((function(e){var t=(e.prefixBoundary?l:"")+m(e,a);t?n.select(this).attr("d",t).style("stroke","none"):n.select(this).remove()}))}(l,E,I,L),function(e,a,i,l,s){var c=o.ensureSingle(e,"g","contourlines"),p=!1!==s.showlines,u=s.showlabels,h=p&&u,d=t.createLines(c,p||u,a),f=t.createLineClip(c,h,i,l.trace.uid),v=e.selectAll("g.contourlabels").data(u?[0]:[]);if(v.exit().remove(),v.enter().append("g").classed("contourlabels",!0),u){var x=[],m=[];o.clearLocationCache();var y=t.labelFormatter(i,l),b=r.tester.append("text").attr("data-notex",1).call(r.font,s.labelfont),T=a[0].xaxis,w=a[0].yaxis,L=T._length,M=w._length,A=T.range,S=w.range,z=o.aggNums(Math.min,null,l.x),k=o.aggNums(Math.max,null,l.x),_=o.aggNums(Math.min,null,l.y),O=o.aggNums(Math.max,null,l.y),I=Math.max(T.c2p(z,!0),0),E=Math.min(T.c2p(k,!0),L),D=Math.max(w.c2p(O,!0),0),C=Math.min(w.c2p(_,!0),M),R={};A[0]<A[1]?(R.left=I,R.right=E):(R.left=E,R.right=I),S[0]<S[1]?(R.top=D,R.bottom=C):(R.top=C,R.bottom=D),R.middle=(R.top+R.bottom)/2,R.center=(R.left+R.right)/2,x.push([[R.left,R.top],[R.right,R.top],[R.right,R.bottom],[R.left,R.bottom]]);var B=Math.sqrt(L*L+M*M),j=g.LABELDISTANCE*B/Math.max(1,a.length/g.LABELINCREASE);d.each((function(e){var a=t.calcTextOpts(e.level,y,b,i);n.select(this).selectAll("path").each((function(){var e=this,n=o.getVisibleSegment(e,R,a.height/2);if(n&&!(n.len<(a.width+a.height)*g.LABELMIN))for(var r=Math.min(Math.ceil(n.len/j),g.LABELMAX),i=0;i<r;i++){var l=t.findBestTextLocation(e,n,a,m,R);if(!l)break;t.addLabelData(l,a,m,x)}}))})),b.remove(),t.drawLabels(v,m,i,f,h?x:null)}u&&!p&&d.remove()}(l,M,e,x,L),function(e,t,a,n,i){var l=n.trace,s=a._fullLayout._clips,c="clip"+l.uid,p=s.selectAll("#"+c).data(l.connectgaps?[]:[0]);if(p.enter().append("clipPath").classed("contourclip",!0).attr("id",c),p.exit().remove(),!1===l.connectgaps){var d={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:t.xaxis,yaxis:t.yaxis,x:n.x,y:n.y,z:b(n),smoothing:0};u([d]),h([d]),v([d],{type:"levels"}),o.ensureSingle(p,"path","").attr("d",(d.prefixBoundary?"M"+i.join("L")+"Z":"")+m(d,i))}else c=null;r.setClipUrl(e,c,a)}(l,a,e,x,I)}))},t.createLines=function(e,t,a){var n=a[0].smoothing,o=e.selectAll("g.contourlevel").data(t?a:[]);if(o.exit().remove(),o.enter().append("g").classed("contourlevel",!0),t){var i=o.selectAll("path.openline").data((function(e){return e.pedgepaths||e.edgepaths}));i.exit().remove(),i.enter().append("path").classed("openline",!0),i.attr("d",(function(e){return r.smoothopen(e,n)})).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var l=o.selectAll("path.closedline").data((function(e){return e.ppaths||e.paths}));l.exit().remove(),l.enter().append("path").classed("closedline",!0),l.attr("d",(function(e){return r.smoothclosed(e,n)})).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return o},t.createLineClip=function(e,t,a,n){var o=t?"clipline"+n:null,i=a._fullLayout._clips.selectAll("#"+o).data(t?[0]:[]);return i.exit().remove(),i.enter().append("clipPath").classed("contourlineclip",!0).attr("id",o),r.setClipUrl(e,o,a),i},t.labelFormatter=function(e,t){var a=e._fullLayout,n=t.trace,o=n.contours,r={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(o.labelformat)r.tickformat=o.labelformat,c(r,a);else{var l=i.extractOpts(n);if(l&&l.colorbar&&l.colorbar._axis)r=l.colorbar._axis;else{if("constraint"===o.type){var p=o.value;Array.isArray(p)?r.range=[p[0],p[p.length-1]]:r.range=[p,p]}else r.range=[o.start,o.end],r.nticks=(o.end-o.start)/o.size;r.range[0]===r.range[1]&&(r.range[1]+=r.range[0]||1),r.nticks||(r.nticks=1e3),c(r,a),s.prepTicks(r),r._tmin=null,r._tmax=null}}return function(e){return s.tickText(r,e).text}},t.calcTextOpts=function(e,t,a,n){var o=t(e);a.text(o).call(l.convertToTspans,n);var i=a.node(),s=r.bBox(i,!0);return{text:o,width:s.width,height:s.height,fontSize:+i.style["font-size"].replace("px",""),level:e,dy:(s.top+s.bottom)/2}},t.findBestTextLocation=function(e,t,a,n,r){var i,l,s,c,p,u=a.width;t.isClosed?(l=t.len/x.INITIALSEARCHPOINTS,i=t.min+l/2,s=t.max):(l=(t.len-u)/(x.INITIALSEARCHPOINTS+1),i=t.min+l+u/2,s=t.max-(l+u)/2);for(var h=1/0,d=0;d<x.ITERATIONS;d++){for(var f=i;f<s;f+=l){var v=o.getTextLocation(e,t.total,f,u),g=y(v,a,n,r);g<h&&(h=g,p=v,c=f)}if(h>2*x.MAXCOST)break;d&&(l/=2),s=(i=c-l/2)+1.5*l}if(h<=x.MAXCOST)return p},t.addLabelData=function(e,t,a,n){var o=t.fontSize,r=t.width+o/3,i=Math.max(0,t.height-o/3),l=e.x,s=e.y,c=e.theta,p=Math.sin(c),u=Math.cos(c),h=function(e,t){return[l+e*u-t*p,s+e*p+t*u]},d=[h(-r/2,-i/2),h(-r/2,i/2),h(r/2,i/2),h(r/2,-i/2)];a.push({text:t.text,x:l,y:s,dy:t.dy,theta:c,level:t.level,width:r,height:i}),n.push(d)},t.drawLabels=function(e,t,a,r,i){var s=e.selectAll("text").data(t,(function(e){return e.text+","+e.x+","+e.y+","+e.theta}));if(s.exit().remove(),s.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each((function(e){var t=e.x+Math.sin(e.theta)*e.dy,o=e.y-Math.cos(e.theta)*e.dy;n.select(this).text(e.text).attr({x:t,y:o,transform:"rotate("+180*e.theta/Math.PI+" "+t+" "+o+")"}).call(l.convertToTspans,a)})),i){for(var c="",p=0;p<i.length;p++)c+="M"+i[p].join("L")+"Z";o.ensureSingle(r,"path","").attr("d",c)}}},22632:function(e,t,a){var n=a(37762),o=a(47401);function r(e,t,a){var o={type:"linear",range:[e,t]};return n.autoTicks(o,(t-e)/(a||15)),o}e.exports=function(e,t){var a=e.contours;if(e.autocontour){var i=e.zmin,l=e.zmax;(e.zauto||void 0===i)&&(i=o.aggNums(Math.min,null,t)),(e.zauto||void 0===l)&&(l=o.aggNums(Math.max,null,t));var s=r(i,l,e.ncontours);a.size=s.dtick,a.start=n.tickFirst(s),s.range.reverse(),a.end=n.tickFirst(s),a.start===i&&(a.start+=a.size),a.end===l&&(a.end-=a.size),a.start>a.end&&(a.start=a.end=(a.start+a.end)/2),e._input.contours||(e._input.contours={}),o.extendFlat(e._input.contours,{start:a.start,end:a.end,size:a.size}),e._input.autocontour=!0}else if("constraint"!==a.type){var c,p=a.start,u=a.end,h=e._input.contours;if(p>u&&(a.start=h.start=u,u=a.end=h.end=p,p=a.start),!(a.size>0))c=p===u?1:r(p,u,e.ncontours).dtick,h.size=a.size=c}}},72960:function(e,t,a){var n=a(62258),o=a(41707),r=a(24246),i=a(71686);e.exports=function(e){var t=n.select(e).selectAll("g.contour");t.style("opacity",(function(e){return e[0].trace.opacity})),t.each((function(e){var t=n.select(this),a=e[0].trace,r=a.contours,l=a.line,s=r.size||1,c=r.start,p="constraint"===r.type,u=!p&&"lines"===r.coloring,h=!p&&"fill"===r.coloring,d=u||h?i(a):null;t.selectAll("g.contourlevel").each((function(e){n.select(this).selectAll("path").call(o.lineGroupStyle,l.width,u?d(e.level):l.color,l.dash)}));var f=r.labelfont;if(t.selectAll("g.contourlabels text").each((function(e){o.font(n.select(this),{family:f.family,size:f.size,color:f.color||(u?d(e.level):l.color)})})),p)t.selectAll("g.contourfill path").style("fill",a.fillcolor);else if(h){var v;t.selectAll("g.contourfill path").style("fill",(function(e){return void 0===v&&(v=e.level),d(e.level+.5*s)})),void 0===v&&(v=c),t.selectAll("g.contourbg path").style("fill",d(v-.5*s))}})),r(e)}},67137:function(e,t,a){var n=a(94060),o=a(19952);e.exports=function(e,t,a,r,i){var l,s=a("contours.coloring"),c="";"fill"===s&&(l=a("contours.showlines")),!1!==l&&("lines"!==s&&(c=a("line.color","#000")),a("line.width",.5),a("line.dash")),"none"!==s&&(!0!==e.showlegend&&(t.showlegend=!1),t._dfltShowLegend=!1,n(e,t,r,a,{prefix:"",cLetter:"z"})),a("line.smoothing"),o(a,r,c,i)}},83949:function(e,t,a){var n=a(5738),o=a(52416),r=a(97451),i=a(87241).extendFlat,l=o.contours;e.exports=i({carpet:{valType:"string",editType:"calc",description:["The `carpet` of the carpet axes on which this contour trace lies"].join(" ")},z:n.z,a:n.x,a0:n.x0,da:n.dx,b:n.y,b0:n.y0,db:n.dy,text:n.text,hovertext:n.hovertext,transpose:n.transpose,atype:n.xtype,btype:n.ytype,fillcolor:o.fillcolor,autocontour:o.autocontour,ncontours:o.ncontours,contours:{type:l.type,start:l.start,end:l.end,size:l.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc",description:["Determines the coloring method showing the contour values.","If *fill*, coloring is done evenly between each contour level","If *lines*, coloring is done on the contour lines.","If *none*, no coloring is applied on this trace."].join(" ")},showlines:l.showlines,showlabels:l.showlabels,labelfont:l.labelfont,labelformat:l.labelformat,operation:l.operation,value:l.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:o.line.color,width:o.line.width,dash:o.line.dash,smoothing:o.line.smoothing,editType:"plot"},transforms:void 0},r("",{cLetter:"z",autoColorDflt:!1}))},95681:function(e,t,a){var n=a(92171),o=a(47401),r=a(48877),i=a(21605),l=a(82335),s=a(93290),c=a(59756),p=a(25658),u=a(26683),h=a(22632);e.exports=function(e,t){var a=t._carpetTrace=u(e,t);if(a&&a.visible&&"legendonly"!==a.visible){if(!t.a||!t.b){var d=e.data[a.index],f=e.data[t.index];f.a||(f.a=d.a),f.b||(f.b=d.b),p(f,t,t._defaultColor,e._fullLayout)}var v=function(e,t){var a,p,u,h,d,f,v,g=t._carpetTrace,x=g.aaxis,m=g.baxis;x._minDtick=0,m._minDtick=0,o.isArray1D(t.z)&&r(t,x,m,"a","b",["z"]);a=t._a=t._a||t.a,h=t._b=t._b||t.b,a=a?x.makeCalcdata(t,"_a"):[],h=h?m.makeCalcdata(t,"_b"):[],p=t.a0||0,u=t.da||1,d=t.b0||0,f=t.db||1,v=t._z=i(t._z||t.z,t.transpose),t._emptypoints=s(v),l(v,t._emptypoints);var y=o.maxRowLength(v),b="scaled"===t.xtype?"":a,T=c(t,b,p,u,y,x),w="scaled"===t.ytype?"":h,L=c(t,w,d,f,v.length,m),M={a:T,b:L,z:v};"levels"===t.contours.type&&"none"!==t.contours.coloring&&n(e,t,{vals:v,containerStr:"",cLetter:"z"});return[M]}(e,t);return h(t,t._z),v}}},25658:function(e,t,a){var n=a(47401),o=a(7497),r=a(83949),i=a(99727),l=a(20567),s=a(67137);e.exports=function(e,t,a,c){function p(a,o){return n.coerce(e,t,r,a,o)}if(p("carpet"),e.a&&e.b){if(!o(e,t,p,c,"a","b"))return void(t.visible=!1);p("text"),"constraint"===p("contours.type")?i(e,t,p,c,a,{hasHover:!1}):(l(e,t,p,(function(a){return n.coerce2(e,t,r,a)})),s(e,t,p,c,{hasHover:!1}))}else t._defaultColor=a,t._length=null}},23798:function(e,t,a){e.exports={attributes:a(83949),supplyDefaults:a(25658),colorbar:a(68201),calc:a(95681),plot:a(52567),style:a(72960),moduleType:"trace",name:"contourcarpet",basePlotModule:a(66807),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{hrName:"contour_carpet",description:["Plots contours on either the first carpet axis or the","carpet axis with a matching `carpet` attribute. Data `z`","is interpreted as matching that of the corresponding carpet","axis."].join(" ")}}},52567:function(e,t,a){var n=a(62258),o=a(49040),r=a(17333),i=a(41707),l=a(47401),s=a(4361),c=a(26809),p=a(22818),u=a(14612),h=a(77599),d=a(54460),f=a(76142),v=a(26683),g=a(19623);function x(e,t,a){var n=e.getPointAtLength(t),o=e.getPointAtLength(a),r=o.x-n.x,i=o.y-n.y,l=Math.sqrt(r*r+i*i);return[r/l,i/l]}function m(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]}function y(e,t){var a=Math.abs(e[0]*t[0]+e[1]*t[1]);return Math.sqrt(1-a*a)/a}e.exports=function(e,t,a,b){var T=t.xaxis,w=t.yaxis;l.makeTraceGroups(b,a,"contour").each((function(a){var b=n.select(this),L=a[0],M=L.trace,A=M._carpetTrace=v(e,M),S=e.calcdata[A.index][0];if(A.visible&&"legendonly"!==A.visible){var z=L.a,k=L.b,_=M.contours,O=d(_,t,L),I="constraint"===_.type,E=_._operation,D=I?"="===E?"lines":"fill":_.coloring,C=[[z[0],k[k.length-1]],[z[z.length-1],k[k.length-1]],[z[z.length-1],k[0]],[z[0],k[0]]];s(O);var R=1e-8*(z[z.length-1]-z[0]),B=1e-8*(k[k.length-1]-k[0]);c(O,R,B);var j,N,P,F,H=O;"constraint"===_.type&&(H=h(O,E)),function(e,t){var a,n,o,r,i,l,s,c,p;for(a=0;a<e.length;a++){for(i=(r=e[a]).pedgepaths=[],l=r.ppaths=[],n=0;n<r.edgepaths.length;n++){for(p=r.edgepaths[n],s=[],o=0;o<p.length;o++)s[o]=t(p[o]);i.push(s)}for(n=0;n<r.paths.length;n++){for(p=r.paths[n],c=[],o=0;o<p.length;o++)c[o]=t(p[o]);l.push(c)}}}(O,Z);var V=[];for(F=S.clipsegments.length-1;F>=0;F--)j=S.clipsegments[F],N=o([],j.x,T.c2p),P=o([],j.y,w.c2p),N.reverse(),P.reverse(),V.push(r(N,P,j.bicubic));var G="M"+V.join("L")+"Z";!function(e,t,a,n,i,s){var c,p,u,h,d=l.ensureSingle(e,"g","contourbg").selectAll("path").data("fill"!==s||i?[]:[0]);d.enter().append("path"),d.exit().remove();var f=[];for(h=0;h<t.length;h++)c=t[h],p=o([],c.x,a.c2p),u=o([],c.y,n.c2p),f.push(r(p,u,c.bicubic));d.attr("d","M"+f.join("L")+"Z").style("stroke","none")}(b,S.clipsegments,T,w,I,D),function(e,t,a,o,r,s,c,p,u,h,d){var v="fill"===h;v&&f(r,e.contours);var x=l.ensureSingle(t,"g","contourfill").selectAll("path").data(v?r:[]);x.enter().append("path"),x.exit().remove(),x.each((function(e){var t=(e.prefixBoundary?d:"")+function(e,t,a,n,o,r,s,c){var p,u,h,d,f,v,x,m="",y=t.edgepaths.map((function(e,t){return t})),b=!0,T=1e-4*Math.abs(a[0][0]-a[2][0]),w=1e-4*Math.abs(a[0][1]-a[2][1]);function L(e){return Math.abs(e[1]-a[0][1])<w}function M(e){return Math.abs(e[1]-a[2][1])<w}function A(e){return Math.abs(e[0]-a[0][0])<T}function S(e){return Math.abs(e[0]-a[2][0])<T}function z(e,t){var a,n,i,l,p="";for(L(e)&&!S(e)||M(e)&&!A(e)?(l=o.aaxis,i=g(o,r,[e[0],t[0]],.5*(e[1]+t[1]))):(l=o.baxis,i=g(o,r,.5*(e[0]+t[0]),[e[1],t[1]])),a=1;a<i.length;a++)for(p+=l.smoothing?"C":"L",n=0;n<i[a].length;n++){var u=i[a][n];p+=[s.c2p(u[0]),c.c2p(u[1])]+" "}return p}p=0,u=null;for(;y.length;){var k=t.edgepaths[p][0];for(u&&(m+=z(u,k)),x=i.smoothopen(t.edgepaths[p].map(n),t.smoothing),m+=b?x:x.replace(/^M/,"L"),y.splice(y.indexOf(p),1),u=t.edgepaths[p][t.edgepaths[p].length-1],f=-1,d=0;d<4;d++){if(!u){l.log("Missing end?",p,t);break}for(L(u)&&!S(u)?h=a[1]:A(u)?h=a[0]:M(u)?h=a[3]:S(u)&&(h=a[2]),v=0;v<t.edgepaths.length;v++){var _=t.edgepaths[v][0];Math.abs(u[0]-h[0])<T?Math.abs(u[0]-_[0])<T&&(_[1]-u[1])*(h[1]-_[1])>=0&&(h=_,f=v):Math.abs(u[1]-h[1])<w?Math.abs(u[1]-_[1])<w&&(_[0]-u[0])*(h[0]-_[0])>=0&&(h=_,f=v):l.log("endpt to newendpt is not vert. or horz.",u,h,_)}if(f>=0)break;m+=z(u,h),u=h}if(f===t.edgepaths.length){l.log("unclosed perimeter path");break}p=f,(b=-1===y.indexOf(p))&&(p=y[0],m+=z(u,h)+"Z",u=null)}for(p=0;p<t.paths.length;p++)m+=i.smoothclosed(t.paths[p].map(n),t.smoothing);return m}(0,e,s,c,p,u,a,o);t?n.select(this).attr("d",t).style("stroke","none"):n.select(this).remove()}))}(M,b,T,w,H,C,Z,A,S,D,G),function(e,t,a,o,r,s,c){var h=l.ensureSingle(e,"g","contourlines"),d=!1!==r.showlines,f=r.showlabels,v=d&&f,g=p.createLines(h,d||f,t),b=p.createLineClip(h,v,a,o.trace.uid),T=e.selectAll("g.contourlabels").data(f?[0]:[]);if(T.exit().remove(),T.enter().append("g").classed("contourlabels",!0),f){var w=s.xaxis,L=s.yaxis,M=w._length,A=L._length,S=[[[0,0],[M,0],[M,A],[0,A]]],z=[];l.clearLocationCache();var k=p.labelFormatter(a,o),_=i.tester.append("text").attr("data-notex",1).call(i.font,r.labelfont),O={left:0,right:M,center:M/2,top:0,bottom:A,middle:A/2},I=Math.sqrt(M*M+A*A),E=u.LABELDISTANCE*I/Math.max(1,t.length/u.LABELINCREASE);g.each((function(e){var t=p.calcTextOpts(e.level,k,_,a);n.select(this).selectAll("path").each((function(a){var n=this,o=l.getVisibleSegment(n,O,t.height/2);if(o&&(function(e,t,a,n,o,r){for(var i,l=0;l<a.pedgepaths.length;l++)t===a.pedgepaths[l]&&(i=a.edgepaths[l]);if(!i)return;var s=o.a[0],c=o.a[o.a.length-1],p=o.b[0],u=o.b[o.b.length-1];function h(e,t){var a,n=0,i=.1;return(Math.abs(e[0]-s)<i||Math.abs(e[0]-c)<i)&&(a=m(o.dxydb_rough(e[0],e[1],i)),n=Math.max(n,r*y(t,a)/2)),(Math.abs(e[1]-p)<i||Math.abs(e[1]-u)<i)&&(a=m(o.dxyda_rough(e[0],e[1],i)),n=Math.max(n,r*y(t,a)/2)),n}var d=x(e,0,1),f=x(e,n.total,n.total-1),v=h(i[0],d),g=n.total-h(i[i.length-1],f);n.min<v&&(n.min=v);n.max>g&&(n.max=g);n.len=n.max-n.min}(n,a,e,o,c,t.height),!(o.len<(t.width+t.height)*u.LABELMIN)))for(var r=Math.min(Math.ceil(o.len/E),u.LABELMAX),i=0;i<r;i++){var s=p.findBestTextLocation(n,o,t,z,O);if(!s)break;p.addLabelData(s,t,z,S)}}))})),_.remove(),p.drawLabels(T,z,a,b,v?S:null)}f&&!d&&g.remove()}(b,O,e,L,_,t,A),i.setClipUrl(b,A._clipPathId,e)}function Z(e){var t=A.ab2xy(e[0],e[1],!0);return[T.c2p(t[0]),w.c2p(t[1])]}}))}},77843:function(e,t,a){var n=a(97451),o=a(4216).r,r=a(42837),i=a(88297),l=a(87241).extendFlat;e.exports=l({lon:i.lon,lat:i.lat,z:{valType:"data_array",editType:"calc",description:["Sets the points' weight.","For example, a value of 10 would be equivalent to having 10 points of weight 1","in the same spot"].join(" ")},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30,description:["Sets the radius of influence of one `lon` / `lat` point in pixels.","Increasing the value makes the densitymapbox trace smoother, but less detailed."].join(" ")},below:{valType:"string",editType:"plot",description:["Determines if the densitymapbox trace will be inserted","before the layer with the specified ID.","By default, densitymapbox traces are placed below the first","layer of type symbol","If set to '',","the layer will be inserted above every existing layer."].join(" ")},text:i.text,hovertext:i.hovertext,hoverinfo:l({},r.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:o(),showlegend:l({},r.showlegend,{dflt:!1})},n("",{cLetter:"z",editTypeOverride:"calc"}))},11251:function(e,t,a){var n=a(83491),o=a(47401).isArrayOrTypedArray,r=a(9405).BADNUM,i=a(92171),l=a(47401)._;e.exports=function(e,t){for(var a=t._length,s=new Array(a),c=t.z,p=o(c)&&c.length,u=0;u<a;u++){var h=s[u]={},d=t.lon[u],f=t.lat[u];if(h.lonlat=n(d)&&n(f)?[+d,+f]:[r,r],p){var v=c[u];h.z=n(v)?v:r}}return i(e,t,{vals:p?c:[0,1],containerStr:"",cLetter:"z"}),a&&(s[0].t={labels:{lat:l(e,"lat:")+" ",lon:l(e,"lon:")+" "}}),s}},11559:function(e,t,a){var n=a(83491),o=a(47401),r=a(31454),i=a(47624),l=a(9405).BADNUM,s=a(92380).makeBlank;e.exports=function(e){var t=e[0].trace,a=!0===t.visible&&0!==t._length,c=t._opts={heatmap:{layout:{visibility:"none"},paint:{}},geojson:s()};if(!a)return c;var p,u=[],h=t.z,d=t.radius,f=o.isArrayOrTypedArray(h)&&h.length,v=o.isArrayOrTypedArray(d);for(p=0;p<e.length;p++){var g=e[p],x=g.lonlat;if(x[0]!==l){var m={};if(f){var y=g.z;m.z=y!==l?y:0}v&&(m.r=n(d[p])&&d[p]>0?+d[p]:0),u.push({type:"Feature",geometry:{type:"Point",coordinates:x},properties:m})}}var b=i.extractOpts(t),T=b.reversescale?i.flipScale(b.colorscale):b.colorscale,w=T[0][1],L=["interpolate",["linear"],["heatmap-density"],0,r.opacity(w)<1?w:r.addOpacity(w,0)];for(p=1;p<T.length;p++)L.push(T[p][0],T[p][1]);var M=["interpolate",["linear"],["get","z"],b.min,0,b.max,1];return o.extendFlat(c.heatmap.paint,{"heatmap-weight":f?M:1/(b.max-b.min),"heatmap-color":L,"heatmap-radius":v?{type:"identity",property:"r"}:t.radius,"heatmap-opacity":t.opacity}),c.geojson={type:"FeatureCollection",features:u},c.heatmap.layout.visibility="visible",c}},13876:function(e,t,a){var n=a(47401),o=a(94060),r=a(77843);e.exports=function(e,t,a,i){function l(a,o){return n.coerce(e,t,r,a,o)}var s=l("lon")||[],c=l("lat")||[],p=Math.min(s.length,c.length);p?(t._length=p,l("z"),l("radius"),l("below"),l("text"),l("hovertext"),l("hovertemplate"),o(e,t,i,l,{prefix:"",cLetter:"z"})):t.visible=!1}},95943:function(e){e.exports=function(e,t){return e.lon=t.lon,e.lat=t.lat,e.z=t.z,e}},56062:function(e,t,a){var n=a(37762),o=a(93712).hoverPoints,r=a(93712).getExtraText;e.exports=function(e,t,a){var i=o(e,t,a);if(i){var l=i[0],s=l.cd,c=s[0].trace,p=s[l.index];if(delete l.color,"z"in p){var u=l.subplot.mockAxis;l.z=p.z,l.zLabel=n.tickText(u,u.c2l(p.z),"hover").text}return l.extraText=r(c,p,s[0].t.labels),[l]}}},62656:function(e,t,a){e.exports={attributes:a(77843),supplyDefaults:a(13876),colorbar:a(17439),formatLabels:a(55265),calc:a(11251),plot:a(14877),hoverPoints:a(56062),eventData:a(95943),getBelow:function(e,t){for(var a=t.getMapLayers(),n=0;n<a.length;n++){var o=a[n],r=o.id;if("symbol"===o.type&&"string"===typeof r&&-1===r.indexOf("plotly-"))return r}},moduleType:"trace",name:"densitymapbox",basePlotModule:a(25456),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox",description:["Draws a bivariate kernel density estimation with a Gaussian kernel","from `lon` and `lat` coordinates and optional `z` values using a colorscale."].join(" ")}}},14877:function(e,t,a){var n=a(11559),o=a(82949).traceLayerPrefix;function r(e,t){this.type="densitymapbox",this.subplot=e,this.uid=t,this.sourceId="source-"+t,this.layerList=[["heatmap",o+t+"-heatmap"]],this.below=null}var i=r.prototype;i.update=function(e){var t=this.subplot,a=this.layerList,o=n(e),r=t.belowLookup["trace-"+this.uid];t.map.getSource(this.sourceId).setData(o.geojson),r!==this.below&&(this._removeLayers(),this._addLayers(o,r),this.below=r);for(var i=0;i<a.length;i++){var l=a[i],s=l[0],c=l[1],p=o[s];t.setOptions(c,"setLayoutProperty",p.layout),"visible"===p.layout.visibility&&t.setOptions(c,"setPaintProperty",p.paint)}},i._addLayers=function(e,t){for(var a=this.subplot,n=this.layerList,o=this.sourceId,r=0;r<n.length;r++){var i=n[r],l=i[0],s=e[l];a.addLayer({type:l,id:i[1],source:o,layout:s.layout,paint:s.paint},t)}},i._removeLayers=function(){for(var e=this.subplot.map,t=this.layerList,a=t.length-1;a>=0;a--)e.removeLayer(t[a][1])},i.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},e.exports=function(e,t){var a=t[0].trace,o=new r(e,a.uid),i=o.sourceId,l=n(t),s=o.below=e.belowLookup["trace-"+a.uid];return e.map.addSource(i,{type:"geojson",data:l.geojson}),o._addLayers(l,s),o}},27867:function(e,t,a){var n=a(47401);e.exports=function(e,t){for(var a=0;a<e.length;a++)e[a].i=a;n.mergeArray(t.text,e,"tx"),n.mergeArray(t.hovertext,e,"htx");var o=t.marker;if(o){n.mergeArray(o.opacity,e,"mo"),n.mergeArray(o.color,e,"mc");var r=o.line;r&&(n.mergeArray(r.color,e,"mlc"),n.mergeArrayCastPositive(r.width,e,"mlw"))}}},80216:function(e,t,a){var n=a(66905),o=a(47216).line,r=a(42837),i=a(20184).axisHoverFormat,l=a(4216).r,s=a(4216).a,c=a(23484),p=a(87241).extendFlat,u=a(31454);e.exports={x:n.x,x0:n.x0,dx:n.dx,y:n.y,y0:n.y0,dy:n.dy,xperiod:n.xperiod,yperiod:n.yperiod,xperiod0:n.xperiod0,yperiod0:n.yperiod0,xperiodalignment:n.xperiodalignment,yperiodalignment:n.yperiodalignment,xhoverformat:i("x"),yhoverformat:i("y"),hovertext:n.hovertext,hovertemplate:l({},{keys:c.eventDataKeys}),hoverinfo:p({},r.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1,description:["Determines which trace information appear on the graph.","In the case of having multiple funnels, percentages & totals","are computed separately (per trace)."].join(" ")},texttemplate:s({editType:"plot"},{keys:c.eventDataKeys.concat(["label","value"])}),text:n.text,textposition:n.textposition,insidetextanchor:p({},n.insidetextanchor,{dflt:"middle"}),textangle:p({},n.textangle,{dflt:0}),textfont:n.textfont,insidetextfont:n.insidetextfont,outsidetextfont:n.outsidetextfont,constraintext:n.constraintext,cliponaxis:n.cliponaxis,orientation:p({},n.orientation,{description:["Sets the orientation of the funnels.","With *v* (*h*), the value of the each bar spans","along the vertical (horizontal).","By default funnels are tend to be oriented horizontally;","unless only *y* array is presented or orientation is set to *v*.","Also regarding graphs including only 'horizontal' funnels,","*autorange* on the *y-axis* are set to *reversed*."].join(" ")}),offset:p({},n.offset,{arrayOk:!1}),width:p({},n.width,{arrayOk:!1}),marker:function(){var e=p({},n.marker);return delete e.pattern,e}(),connector:{fillcolor:{valType:"color",editType:"style",description:["Sets the fill color."].join(" ")},line:{color:p({},o.color,{dflt:u.defaultLine}),width:p({},o.width,{dflt:0,editType:"plot"}),dash:o.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot",description:["Determines if connector regions and lines are drawn."].join(" ")},editType:"plot"},offsetgroup:n.offsetgroup,alignmentgroup:n.alignmentgroup}},24072:function(e,t,a){var n=a(37762),o=a(48128),r=a(27867),i=a(35533),l=a(9405).BADNUM;function s(e){return e===l?0:e}e.exports=function(e,t){var a,c,p,u,h,d,f,v,g=n.getFromId(e,t.xaxis||"x"),x=n.getFromId(e,t.yaxis||"y");"h"===t.orientation?(a=g.makeCalcdata(t,"x"),p=x.makeCalcdata(t,"y"),u=o(t,x,"y",p),h=!!t.yperiodalignment,d="y"):(a=x.makeCalcdata(t,"y"),p=g.makeCalcdata(t,"x"),u=o(t,g,"x",p),h=!!t.xperiodalignment,d="x"),c=u.vals;var m,y=Math.min(c.length,a.length),b=new Array(y);for(t._base=[],f=0;f<y;f++){a[f]<0&&(a[f]=l);var T=!1;a[f]!==l&&f+1<y&&a[f+1]!==l&&(T=!0),v=b[f]={p:c[f],s:a[f],cNext:T},t._base[f]=-.5*v.s,h&&(b[f].orig_p=p[f],b[f][d+"End"]=u.ends[f],b[f][d+"Start"]=u.starts[f]),t.ids&&(v.id=String(t.ids[f])),0===f&&(b[0].vTotal=0),b[0].vTotal+=s(v.s),v.begR=s(v.s)/s(b[0].s)}for(f=0;f<y;f++)(v=b[f]).s!==l&&(v.sumR=v.s/b[0].vTotal,v.difR=void 0!==m?v.s/m:1,m=v.s);return r(b,t),i(b,t),b}},23484:function(e){e.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},71611:function(e,t,a){var n=a(11262).setGroupPositions;e.exports=function(e,t){var a,o,r=e._fullLayout,i=e._fullData,l=e.calcdata,s=t.xaxis,c=t.yaxis,p=[],u=[],h=[];for(o=0;o<i.length;o++){var d=i[o],f="h"===d.orientation;!0===d.visible&&d.xaxis===s._id&&d.yaxis===c._id&&"funnel"===d.type&&(a=l[o],f?h.push(a):u.push(a),p.push(a))}var v={mode:r.funnelmode,norm:r.funnelnorm,gap:r.funnelgap,groupgap:r.funnelgroupgap};for(n(e,s,c,u,v),n(e,c,s,h,v),o=0;o<p.length;o++){a=p[o];for(var g=0;g<a.length;g++)g+1<a.length&&(a[g].nextP0=a[g+1].p0,a[g].nextS0=a[g+1].s0,a[g].nextP1=a[g+1].p1,a[g].nextS1=a[g+1].s1)}}},21231:function(e,t,a){var n=a(47401),o=a(18878).handleGroupingDefaults,r=a(18878).handleText,i=a(87243),l=a(75781),s=a(80216),c=a(31454);e.exports={supplyDefaults:function(e,t,a,o){function p(a,o){return n.coerce(e,t,s,a,o)}if(i(e,t,o,p)){l(e,t,o,p),p("xhoverformat"),p("yhoverformat"),p("orientation",t.y&&!t.x?"v":"h"),p("offset"),p("width");var u=p("text");p("hovertext"),p("hovertemplate");var h=p("textposition");r(e,t,o,p,h,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"===t.textposition||t.texttemplate||p("textinfo",Array.isArray(u)?"text+value":"value");var d=p("marker.color",a);if(p("marker.line.color",c.defaultLine),p("marker.line.width"),p("connector.visible"))p("connector.fillcolor",function(e){var t=n.isArrayOrTypedArray(e)?"#000":e;return c.addOpacity(t,.5*c.opacity(t))}(d)),p("connector.line.width")&&(p("connector.line.color"),p("connector.line.dash"))}else t.visible=!1},crossTraceDefaults:function(e,t){var a,r;function i(e){return n.coerce(r._input,r,s,e)}if("group"===t.funnelmode)for(var l=0;l<e.length;l++)a=(r=e[l])._input,o(a,r,t,i)}}},37236:function(e){e.exports=function(e,t){return e.x="xVal"in t?t.xVal:t.x,e.y="yVal"in t?t.yVal:t.y,"percentInitial"in t&&(e.percentInitial=t.percentInitial),"percentPrevious"in t&&(e.percentPrevious=t.percentPrevious),"percentTotal"in t&&(e.percentTotal=t.percentTotal),t.xa&&(e.xaxis=t.xa),t.ya&&(e.yaxis=t.ya),e}},9983:function(e,t,a){var n=a(31454).opacity,o=a(16032).hoverOnBars,r=a(47401).formatPercent;e.exports=function(e,t,a,i,l){var s=o(e,t,a,i,l);if(s){var c=s.cd,p=c[0].trace,u="h"===p.orientation,h=c[s.index];s[(u?"x":"y")+"LabelVal"]=h.s,s.percentInitial=h.begR,s.percentInitialLabel=r(h.begR,1),s.percentPrevious=h.difR,s.percentPreviousLabel=r(h.difR,1),s.percentTotal=h.sumR,s.percentTotalLabel=r(h.sumR,1);var d=h.hi||p.hoverinfo,f=[];if(d&&"none"!==d&&"skip"!==d){var v="all"===d,g=d.split("+"),x=function(e){return v||-1!==g.indexOf(e)};x("percent initial")&&f.push(s.percentInitialLabel+" of initial"),x("percent previous")&&f.push(s.percentPreviousLabel+" of previous"),x("percent total")&&f.push(s.percentTotalLabel+" of total")}return s.extraText=f.join("<br>"),s.color=function(e,t){var a=e.marker,o=t.mc||a.color,r=t.mlc||a.line.color,i=t.mlw||a.line.width;if(n(o))return o;if(n(r)&&i)return r}(p,h),[s]}}},83333:function(e,t,a){e.exports={attributes:a(80216),layoutAttributes:a(88499),supplyDefaults:a(21231).supplyDefaults,crossTraceDefaults:a(21231).crossTraceDefaults,supplyLayoutDefaults:a(60244),calc:a(24072),crossTraceCalc:a(71611),plot:a(99946),style:a(76184).style,hoverPoints:a(9983),eventData:a(37236),selectPoints:a(76304),moduleType:"trace",name:"funnel",basePlotModule:a(66807),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{description:["Visualize stages in a process using length-encoded bars. This trace can be used","to show data in either a part-to-whole representation wherein each item appears",'in a single stage, or in a "drop-off" representation wherein each item appears in','each stage it traversed. See also the "funnelarea" trace type for a different',"approach to visualizing funnel data."].join(" ")}}},88499:function(e){e.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc",description:["Determines how bars at the same location coordinate","are displayed on the graph.","With *stack*, the bars are stacked on top of one another","With *group*, the bars are plotted next to one another","centered around the shared location.","With *overlay*, the bars are plotted over one another,","you might need to an *opacity* to see multiple bars."].join(" ")},funnelgap:{valType:"number",min:0,max:1,editType:"calc",description:["Sets the gap (in plot fraction) between bars of","adjacent location coordinates."].join(" ")},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc",description:["Sets the gap (in plot fraction) between bars of","the same location coordinate."].join(" ")}}},60244:function(e,t,a){var n=a(47401),o=a(88499);e.exports=function(e,t,a){var r=!1;function i(a,r){return n.coerce(e,t,o,a,r)}for(var l=0;l<a.length;l++){var s=a[l];if(s.visible&&"funnel"===s.type){r=!0;break}}r&&(i("funnelmode"),i("funnelgap",.2),i("funnelgroupgap"))}},99946:function(e,t,a){var n=a(62258),o=a(47401),r=a(41707),i=a(9405).BADNUM,l=a(74835),s=a(77846).clearMinTextSize;function c(e,t,a,n){var o=[],r=[],i=n?t:a,l=n?a:t;return o[0]=i.c2p(e.s0,!0),r[0]=l.c2p(e.p0,!0),o[1]=i.c2p(e.s1,!0),r[1]=l.c2p(e.p1,!0),o[2]=i.c2p(e.nextS0,!0),r[2]=l.c2p(e.nextP0,!0),o[3]=i.c2p(e.nextS1,!0),r[3]=l.c2p(e.nextP1,!0),n?[o,r]:[r,o]}e.exports=function(e,t,a,p){var u=e._fullLayout;s("funnel",u),function(e,t,a,l){var s=t.xaxis,p=t.yaxis;o.makeTraceGroups(l,a,"trace bars").each((function(a){var l=n.select(this),u=a[0].trace,h=o.ensureSingle(l,"g","regions");if(u.connector&&u.connector.visible){var d="h"===u.orientation,f=h.selectAll("g.region").data(o.identity);f.enter().append("g").classed("region",!0),f.exit().remove();var v=f.size();f.each((function(a,l){if(l===v-1||a.cNext){var u=c(a,s,p,d),h=u[0],f=u[1],g="";h[0]!==i&&f[0]!==i&&h[1]!==i&&f[1]!==i&&h[2]!==i&&f[2]!==i&&h[3]!==i&&f[3]!==i&&(g+=d?"M"+h[0]+","+f[1]+"L"+h[2]+","+f[2]+"H"+h[3]+"L"+h[1]+","+f[1]+"Z":"M"+h[1]+","+f[1]+"L"+h[2]+","+f[3]+"V"+f[2]+"L"+h[1]+","+f[0]+"Z"),""===g&&(g="M0,0Z"),o.ensureSingle(n.select(this),"path").attr("d",g).call(r.setClipUrl,t.layerClipId,e)}}))}else h.remove()}))}(e,t,a,p),function(e,t,a,i){var l=t.xaxis,s=t.yaxis;o.makeTraceGroups(i,a,"trace bars").each((function(a){var i=n.select(this),p=a[0].trace,u=o.ensureSingle(i,"g","lines");if(p.connector&&p.connector.visible&&p.connector.line.width){var h="h"===p.orientation,d=u.selectAll("g.line").data(o.identity);d.enter().append("g").classed("line",!0),d.exit().remove();var f=d.size();d.each((function(a,i){if(i===f-1||a.cNext){var p=c(a,l,s,h),u=p[0],d=p[1],v="";void 0!==u[3]&&void 0!==d[3]&&(h?(v+="M"+u[0]+","+d[1]+"L"+u[2]+","+d[2],v+="M"+u[1]+","+d[1]+"L"+u[3]+","+d[2]):(v+="M"+u[1]+","+d[1]+"L"+u[2]+","+d[3],v+="M"+u[1]+","+d[0]+"L"+u[2]+","+d[2])),""===v&&(v="M0,0Z"),o.ensureSingle(n.select(this),"path").attr("d",v).call(r.setClipUrl,t.layerClipId,e)}}))}else u.remove()}))}(e,t,a,p),l.plot(e,t,a,p,{mode:u.funnelmode,norm:u.funnelmode,gap:u.funnelgap,groupgap:u.funnelgroupgap})}},76184:function(e,t,a){var n=a(62258),o=a(41707),r=a(31454),i=a(49158).DESELECTDIM,l=a(49651),s=a(77846).resizeText,c=l.styleTextPoints;e.exports={style:function(e,t,a){var l=a||n.select(e).selectAll("g.funnellayer").selectAll("g.trace");s(e,l,"funnel"),l.style("opacity",(function(e){return e[0].trace.opacity})),l.each((function(t){var a=n.select(this),l=t[0].trace;a.selectAll(".point > path").each((function(e){if(!e.isBlank){var t=l.marker;n.select(this).call(r.fill,e.mc||t.color).call(r.stroke,e.mlc||t.line.color).call(o.dashLine,t.line.dash,e.mlw||t.line.width).style("opacity",l.selectedpoints&&!e.selected?i:1)}})),c(a,l,e),a.selectAll(".regions").each((function(){n.select(this).selectAll("path").style("stroke-width",0).call(r.fill,l.connector.fillcolor)})),a.selectAll(".lines").each((function(){var e=l.connector.line;o.lineGroupStyle(n.select(this).selectAll("path"),e.width,e.color,e.dash)}))}))}}},94631:function(e,t,a){var n=a(86692),o=a(42837),r=a(16688).u,i=a(4216).r,l=a(4216).a,s=a(87241).extendFlat;e.exports={labels:n.labels,label0:n.label0,dlabel:n.dlabel,values:n.values,marker:{colors:n.marker.colors,line:{color:s({},n.marker.line.color,{dflt:null,description:["Sets the color of the line enclosing each sector.","Defaults to the `paper_bgcolor` value."].join(" ")}),width:s({},n.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:n.text,hovertext:n.hovertext,scalegroup:s({},n.scalegroup,{description:["If there are multiple funnelareas that should be sized according to","their totals, link them by providing a non-empty group id here","shared by every trace in the same group."].join(" ")}),textinfo:s({},n.textinfo,{flags:["label","text","value","percent"]}),texttemplate:l({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:s({},o.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:i({},{keys:["label","color","value","text","percent"]}),textposition:s({},n.textposition,{values:["inside","none"],dflt:"inside"}),textfont:n.textfont,insidetextfont:n.insidetextfont,title:{text:n.title.text,font:n.title.font,position:s({},n.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:r({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot",description:["Sets the ratio between height and width"].join(" ")},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot",description:["Sets the ratio between bottom length and maximum top length."].join(" ")}}},71057:function(e,t,a){var n=a(35722);t.name="funnelarea",t.plot=function(e,a,o,r){n.plotBasePlot(t.name,e,a,o,r)},t.clean=function(e,a,o,r){n.cleanBasePlot(t.name,e,a,o,r)}},76455:function(e,t,a){var n=a(93444);e.exports={calc:function(e,t){return n.calc(e,t)},crossTraceCalc:function(e){n.crossTraceCalc(e,{type:"funnelarea"})}}},41664:function(e,t,a){var n=a(47401),o=a(94631),r=a(16688).N,i=a(18878).handleText,l=a(53459).handleLabelsAndValues;e.exports=function(e,t,a,s){function c(a,r){return n.coerce(e,t,o,a,r)}var p=c("labels"),u=c("values"),h=l(p,u),d=h.len;if(t._hasLabels=h.hasLabels,t._hasValues=h.hasValues,!t._hasLabels&&t._hasValues&&(c("label0"),c("dlabel")),d){t._length=d,c("marker.line.width")&&c("marker.line.color",s.paper_bgcolor),c("marker.colors"),c("scalegroup");var f,v=c("text"),g=c("texttemplate");if(g||(f=c("textinfo",Array.isArray(v)?"text+percent":"percent")),c("hovertext"),c("hovertemplate"),g||f&&"none"!==f){var x=c("textposition");i(e,t,s,c,x,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}r(t,s,c),c("title.text")&&(c("title.position"),n.coerceFont(c,"title.font",s.font)),c("aspectratio"),c("baseratio")}else t.visible=!1}},80012:function(e,t,a){e.exports={moduleType:"trace",name:"funnelarea",basePlotModule:a(71057),categories:["pie-like","funnelarea","showLegend"],attributes:a(94631),layoutAttributes:a(70414),supplyDefaults:a(41664),supplyLayoutDefaults:a(22553),calc:a(76455).calc,crossTraceCalc:a(76455).crossTraceCalc,plot:a(77777),style:a(62285),styleOne:a(59371),meta:{description:["Visualize stages in a process using area-encoded trapezoids. This trace can be used",'to show data in a part-to-whole representation similar to a "pie" trace, wherein','each item appears in a single stage. See also the "funnel" trace type for a different',"approach to visualizing funnel data."].join(" ")}}},70414:function(e,t,a){var n=a(59055).hiddenlabels;e.exports={hiddenlabels:n,funnelareacolorway:{valType:"colorlist",editType:"calc",description:["Sets the default funnelarea slice colors. Defaults to the main","`colorway` used for trace colors. If you specify a new","list here it can still be extended with lighter and darker","colors, see `extendfunnelareacolors`."].join(" ")},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc",description:["If `true`, the funnelarea slice colors (whether given by `funnelareacolorway` or","inherited from `colorway`) will be extended to three times its","original length by first repeating every color 20% lighter then","each color 20% darker. This is intended to reduce the likelihood","of reusing the same color when you have many slices, but you can","set `false` to disable.","Colors provided in the trace, using `marker.colors`, are never","extended."].join(" ")}}},22553:function(e,t,a){var n=a(47401),o=a(70414);e.exports=function(e,t){function a(a,r){return n.coerce(e,t,o,a,r)}a("hiddenlabels"),a("funnelareacolorway",t.colorway),a("extendfunnelareacolors")}},77777:function(e,t,a){var n=a(62258),o=a(41707),r=a(47401),i=r.strScale,l=r.strTranslate,s=a(43995),c=a(74835).toMoveInsideBar,p=a(77846),u=p.recordMinTextSize,h=p.clearMinTextSize,d=a(80084),f=a(59718),v=f.attachFxHandlers,g=f.determineInsideTextFont,x=f.layoutAreas,m=f.prerenderTitles,y=f.positionTitleOutside,b=f.formatSliceLabel;function T(e,t){return"l"+(t[0]-e[0])+","+(t[1]-e[1])}function w(e,t){return[.5*(e[0]+t[0]),.5*(e[1]+t[1])]}e.exports=function(e,t){var a=e._fullLayout;h("funnelarea",a),m(t,e),x(t,a._size),r.makeTraceGroups(a._funnelarealayer,t,"trace").each((function(t){var p=n.select(this),h=t[0],f=h.trace;!function(e){if(!e.length)return;var t=e[0],a=t.trace,n=a.aspectratio,o=a.baseratio;o>.999&&(o=.999);var r,i=Math.pow(o,2),l=t.vTotal,s=l,c=l*i/(1-i)/l;function p(){var e=Math.sqrt(c);return{x:e,y:-e}}function u(){var e=p();return[e.x,e.y]}var h,d,f=[];for(f.push(u()),h=e.length-1;h>-1;h--)if(!(d=e[h]).hidden){var v=d.v/s;c+=v,f.push(u())}var g=1/0,x=-1/0;for(h=0;h<f.length;h++)r=f[h],g=Math.min(g,r[1]),x=Math.max(x,r[1]);for(h=0;h<f.length;h++)f[h][1]-=(x+g)/2;var m=f[f.length-1][0],y=t.r,b=(x-g)/2,T=y/m,L=y/b*n;for(t.r=L*b,h=0;h<f.length;h++)f[h][0]*=T,f[h][1]*=L;var M=[-(r=f[0])[0],r[1]],A=[r[0],r[1]],S=0;for(h=e.length-1;h>-1;h--)if(!(d=e[h]).hidden){var z=f[S+=1][0],k=f[S][1];d.TL=[-z,k],d.TR=[z,k],d.BL=M,d.BR=A,d.pxmid=w(d.TR,d.BR),M=d.TL,A=d.TR}}(t),p.each((function(){var p=n.select(this).selectAll("g.slice").data(t);p.enter().append("g").classed("slice",!0),p.exit().remove(),p.each((function(i,l){if(i.hidden)n.select(this).selectAll("path,g").remove();else{i.pointNumber=i.i,i.curveNumber=f.index;var p=h.cx,x=h.cy,m=n.select(this),y=m.selectAll("path.surface").data([i]);y.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),m.call(v,e,t);var w="M"+(p+i.TR[0])+","+(x+i.TR[1])+T(i.TR,i.BR)+T(i.BR,i.BL)+T(i.BL,i.TL)+"Z";y.attr("d",w),b(e,i,h);var L=d.castOption(f.textposition,i.pts),M=m.selectAll("g.slicetext").data(i.text&&"none"!==L?[0]:[]);M.enter().append("g").classed("slicetext",!0),M.exit().remove(),M.each((function(){var h=r.ensureSingle(n.select(this),"text","",(function(e){e.attr("data-notex",1)})),d=r.ensureUniformFontSize(e,g(f,i,a.font));h.text(i.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(o.font,d).call(s.convertToTspans,e);var v,m,y,b=o.bBox(h.node()),T=Math.min(i.BL[1],i.BR[1])+x,w=Math.max(i.TL[1],i.TR[1])+x;m=Math.max(i.TL[0],i.BL[0])+p,y=Math.min(i.TR[0],i.BR[0])+p,(v=c(m,y,T,w,b,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"})).fontSize=d.size,u(f.type,v,a),t[l].transform=v,h.attr("transform",r.getTextTransform(v))}))}}));var x=n.select(this).selectAll("g.titletext").data(f.title.text?[0]:[]);x.enter().append("g").classed("titletext",!0),x.exit().remove(),x.each((function(){var t=r.ensureSingle(n.select(this),"text","",(function(e){e.attr("data-notex",1)})),c=f.title.text;f._meta&&(c=r.templateString(c,f._meta)),t.text(c).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(o.font,f.title.font).call(s.convertToTspans,e);var p=y(h,a._size);t.attr("transform",l(p.x,p.y)+i(Math.min(1,p.scale))+l(p.tx,p.ty))}))}))}))}},62285:function(e,t,a){var n=a(62258),o=a(59371),r=a(77846).resizeText;e.exports=function(e){var t=e._fullLayout._funnelarealayer.selectAll(".trace");r(e,t,"funnelarea"),t.each((function(e){var t=e[0].trace,a=n.select(this);a.style({opacity:t.opacity}),a.selectAll("path.surface").each((function(e){n.select(this).call(o,e,t)}))}))}}}]);