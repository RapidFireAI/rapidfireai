"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[1012],{59055:function(e){e.exports={hiddenlabels:{valType:"data_array",editType:"calc",description:["hiddenlabels is the funnelarea & pie chart analog of","visible:'legendonly'","but it can contain many labels, and can simultaneously","hide slices from several pies/funnelarea charts"].join(" ")},piecolorway:{valType:"colorlist",editType:"calc",description:["Sets the default pie slice colors. Defaults to the main","`colorway` used for trace colors. If you specify a new","list here it can still be extended with lighter and darker","colors, see `extendpiecolors`."].join(" ")},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc",description:["If `true`, the pie slice colors (whether given by `piecolorway` or","inherited from `colorway`) will be extended to three times its","original length by first repeating every color 20% lighter then","each color 20% darker. This is intended to reduce the likelihood","of reusing the same color when you have many slices, but you can","set `false` to disable.","Colors provided in the trace, using `marker.colors`, are never","extended."].join(" ")}}},18504:function(e,t,n){var a=n(47401),r=n(59055);e.exports=function(e,t){function n(n,o){return a.coerce(e,t,r,n,o)}n("hiddenlabels"),n("piecolorway",t.colorway),n("extendpiecolors")}},59718:function(e,t,n){var a=n(62258),r=n(35722),o=n(21661),i=n(31454),l=n(41707),s=n(47401),c=s.strScale,d=s.strTranslate,u=n(43995),f=n(77846),h=f.recordMinTextSize,p=f.clearMinTextSize,v=n(33419).TEXTPAD,y=n(80084),x=n(41240),g=n(47401).isValidTextValue;function m(e,t,n){var r=n[0],i=r.cx,l=r.cy,c=r.trace,d="funnelarea"===c.type;"_hasHoverLabel"in c||(c._hasHoverLabel=!1),"_hasHoverEvent"in c||(c._hasHoverEvent=!1),e.on("mouseover",(function(e){var n=t._fullLayout,u=t._fullData[c.index];if(!t._dragging&&!1!==n.hovermode){var f=u.hoverinfo;if(Array.isArray(f)&&(f=o.castHoverinfo({hoverinfo:[y.castOption(f,e.pts)],_module:c._module},n,0)),"all"===f&&(f="label+text+value+percent+name"),u.hovertemplate||"none"!==f&&"skip"!==f&&f){var h=e.rInscribed||0,p=i+e.pxmid[0]*(1-h),v=l+e.pxmid[1]*(1-h),g=n.separators,m=[];if(f&&-1!==f.indexOf("label")&&m.push(e.label),e.text=y.castOption(u.hovertext||u.text,e.pts),f&&-1!==f.indexOf("text")){var b=e.text;s.isValidTextValue(b)&&m.push(b)}e.value=e.v,e.valueLabel=y.formatPieValue(e.v,g),f&&-1!==f.indexOf("value")&&m.push(e.valueLabel),e.percent=e.v/r.vTotal,e.percentLabel=y.formatPiePercent(e.percent,g),f&&-1!==f.indexOf("percent")&&m.push(e.percentLabel);var k=u.hoverlabel,L=k.font,_=[];o.loneHover({trace:c,x0:p-h*r.r,x1:p+h*r.r,y:v,_x0:d?i+e.TL[0]:p-h*r.r,_x1:d?i+e.TR[0]:p+h*r.r,_y0:d?l+e.TL[1]:v-h*r.r,_y1:d?l+e.BL[1]:v+h*r.r,text:m.join("<br>"),name:u.hovertemplate||-1!==f.indexOf("name")?u.name:void 0,idealAlign:e.pxmid[0]<0?"left":"right",color:y.castOption(k.bgcolor,e.pts)||e.color,borderColor:y.castOption(k.bordercolor,e.pts),fontFamily:y.castOption(L.family,e.pts),fontSize:y.castOption(L.size,e.pts),fontColor:y.castOption(L.color,e.pts),nameLength:y.castOption(k.namelength,e.pts),textAlign:y.castOption(k.align,e.pts),hovertemplate:y.castOption(u.hovertemplate,e.pts),hovertemplateLabels:e,eventData:[x(e,u)]},{container:n._hoverlayer.node(),outerContainer:n._paper.node(),gd:t,inOut_bbox:_}),e.bbox=_[0],c._hasHoverLabel=!0}c._hasHoverEvent=!0,t.emit("plotly_hover",{points:[x(e,u)],event:a.event})}})),e.on("mouseout",(function(e){var n=t._fullLayout,r=t._fullData[c.index],i=a.select(this).datum();c._hasHoverEvent&&(e.originalEvent=a.event,t.emit("plotly_unhover",{points:[x(i,r)],event:a.event}),c._hasHoverEvent=!1),c._hasHoverLabel&&(o.loneUnhover(n._hoverlayer.node()),c._hasHoverLabel=!1)})),e.on("click",(function(e){var n=t._fullLayout,r=t._fullData[c.index];t._dragging||!1===n.hovermode||(t._hoverdata=[x(e,r)],o.click(t,a.event))}))}function b(e,t,n){var a=y.castOption(e.insidetextfont.color,t.pts);!a&&e._input.textfont&&(a=y.castOption(e._input.textfont.color,t.pts));var r=y.castOption(e.insidetextfont.family,t.pts)||y.castOption(e.textfont.family,t.pts)||n.family,o=y.castOption(e.insidetextfont.size,t.pts)||y.castOption(e.textfont.size,t.pts)||n.size;return{color:a||i.contrast(t.color),family:r,size:o}}function k(e,t){for(var n,a,r=0;r<e.length;r++)if((a=(n=e[r][0]).trace).title.text){var o=a.title.text;a._meta&&(o=s.templateString(o,a._meta));var i=l.tester.append("text").attr("data-notex",1).text(o).call(l.font,a.title.font).call(u.convertToTspans,t),c=l.bBox(i.node(),!0);n.titleBox={width:c.width,height:c.height},i.remove()}}function L(e,t,n){var a=n.r||t.rpx1,r=t.rInscribed;if(t.startangle===t.stopangle)return{rCenter:1-r,scale:0,rotate:0,textPosAngle:0};var o,i=t.ring,l=1===i&&Math.abs(t.startangle-t.stopangle)===2*Math.PI,s=t.halfangle,c=t.midangle,d=n.trace.insidetextorientation,u="horizontal"===d,f="tangential"===d,h="radial"===d,p="auto"===d,v=[];if(!p){var y,x=function(n,r){if(function(e,t){var n=e.startangle,a=e.stopangle;return n>t&&t>a||n<t&&t<a}(t,n)){var l=Math.abs(n-t.startangle),s=Math.abs(n-t.stopangle),c=l<s?l:s;(o="tan"===r?w(e,a,i,c,0):_(e,a,i,c,Math.PI/2)).textPosAngle=n,v.push(o)}};if(u||f){for(y=4;y>=-4;y-=2)x(Math.PI*y,"tan");for(y=4;y>=-4;y-=2)x(Math.PI*(y+1),"tan")}if(u||h){for(y=4;y>=-4;y-=2)x(Math.PI*(y+1.5),"rad");for(y=4;y>=-4;y-=2)x(Math.PI*(y+.5),"rad")}}if(l||p||u){var g=Math.sqrt(e.width*e.width+e.height*e.height);if((o={scale:r*a*2/g,rCenter:1-r,rotate:0}).textPosAngle=(t.startangle+t.stopangle)/2,o.scale>=1)return o;v.push(o)}(p||h)&&((o=_(e,a,i,s,c)).textPosAngle=(t.startangle+t.stopangle)/2,v.push(o)),(p||f)&&((o=w(e,a,i,s,c)).textPosAngle=(t.startangle+t.stopangle)/2,v.push(o));for(var m=0,b=0,k=0;k<v.length;k++){var L=v[k].scale;if(b<L&&(b=L,m=k),!p&&b>=1)break}return v[m]}function _(e,t,n,a,r){t=Math.max(0,t-2*v);var o=e.width/e.height,i=I(o,a,t,n);return{scale:2*i/e.height,rCenter:A(o,i/t),rotate:T(r)}}function w(e,t,n,a,r){t=Math.max(0,t-2*v);var o=e.height/e.width,i=I(o,a,t,n);return{scale:2*i/e.width,rCenter:A(o,i/t),rotate:T(r+Math.PI/2)}}function A(e,t){return Math.cos(t)-e*t}function T(e){return(180/Math.PI*e+720)%180-90}function I(e,t,n,a){var r=e+1/(2*Math.tan(t));return n*Math.min(1/(Math.sqrt(r*r+.5)+r),a/(Math.sqrt(e*e+a/2)+e))}function O(e,t){return e.v!==t.vTotal||t.trace.hole?Math.min(1/(1+1/Math.sin(e.halfangle)),e.ring/2):1}function S(e,t){var n=t.pxmid[0],a=t.pxmid[1],r=e.width/2,o=e.height/2;return n<0&&(r*=-1),a<0&&(o*=-1),{scale:1,rCenter:1,rotate:0,x:r+Math.abs(o)*(r>0?1:-1)/2,y:o/(1+n*n/(a*a)),outside:!0}}function M(e,t){var n,a,r,o=e.trace,i={x:e.cx,y:e.cy},l={tx:0,ty:0};l.ty+=o.title.font.size,r=F(o),-1!==o.title.position.indexOf("top")?(i.y-=(1+r)*e.r,l.ty-=e.titleBox.height):-1!==o.title.position.indexOf("bottom")&&(i.y+=(1+r)*e.r);var s,c,d=(s=e.r,c=e.trace.aspectratio,s/(void 0===c?1:c)),u=t.w*(o.domain.x[1]-o.domain.x[0])/2;return-1!==o.title.position.indexOf("left")?(u+=d,i.x-=(1+r)*d,l.tx+=e.titleBox.width/2):-1!==o.title.position.indexOf("center")?u*=2:-1!==o.title.position.indexOf("right")&&(u+=d,i.x+=(1+r)*d,l.tx-=e.titleBox.width/2),n=u/e.titleBox.width,a=E(e,t)/e.titleBox.height,{x:i.x,y:i.y,scale:Math.min(n,a),tx:l.tx,ty:l.ty}}function E(e,t){var n=e.trace,a=t.h*(n.domain.y[1]-n.domain.y[0]);return Math.min(e.titleBox.height,a/2)}function F(e){var t,n=e.pull;if(!n)return 0;if(Array.isArray(n))for(n=0,t=0;t<e.pull.length;t++)e.pull[t]>n&&(n=e.pull[t]);return n}function P(e,t){for(var n=[],a=0;a<e.length;a++){var r=e[a][0],o=r.trace,i=o.domain,l=t.w*(i.x[1]-i.x[0]),s=t.h*(i.y[1]-i.y[0]);o.title.text&&"middle center"!==o.title.position&&(s-=E(r,t));var c=l/2,d=s/2;"funnelarea"!==o.type||o.scalegroup||(d/=o.aspectratio),r.r=Math.min(c,d)/(1+F(o)),r.cx=t.l+t.w*(o.domain.x[1]+o.domain.x[0])/2,r.cy=t.t+t.h*(1-o.domain.y[0])-s/2,o.title.text&&-1!==o.title.position.indexOf("bottom")&&(r.cy-=E(r,t)),o.scalegroup&&-1===n.indexOf(o.scalegroup)&&n.push(o.scalegroup)}!function(e,t){for(var n,a,r,o=0;o<t.length;o++){var i=1/0,l=t[o];for(a=0;a<e.length;a++)if((r=(n=e[a][0]).trace).scalegroup===l){var s;if("pie"===r.type)s=n.r*n.r;else if("funnelarea"===r.type){var c,d;r.aspectratio>1?d=(c=n.r)/r.aspectratio:c=(d=n.r)*r.aspectratio,s=(c*=(1+r.baseratio)/2)*d}i=Math.min(i,s/n.vTotal)}for(a=0;a<e.length;a++)if((r=(n=e[a][0]).trace).scalegroup===l){var u=i*n.vTotal;"funnelarea"===r.type&&(u/=(1+r.baseratio)/2,u/=r.aspectratio),n.r=Math.sqrt(u)}}}(e,n)}function z(e,t){return[e*Math.sin(t),-e*Math.cos(t)]}function C(e,t,n){var a=e._fullLayout,r=n.trace,o=r.texttemplate,i=r.textinfo;if(!o&&i&&"none"!==i){var l,c=i.split("+"),d=function(e){return-1!==c.indexOf(e)},u=d("label"),f=d("text"),h=d("value"),p=d("percent"),v=a.separators;if(l=u?[t.label]:[],f){var x=y.getFirstFilled(r.text,t.pts);g(x)&&l.push(x)}h&&l.push(y.formatPieValue(t.v,v)),p&&l.push(y.formatPiePercent(t.v/n.vTotal,v)),t.text=l.join("<br>")}if(o){var m=s.castOption(r,t.i,"texttemplate");if(m){var b=function(e){return{label:e.label,value:e.v,valueLabel:y.formatPieValue(e.v,a.separators),percent:e.v/n.vTotal,percentLabel:y.formatPiePercent(e.v/n.vTotal,a.separators),color:e.color,text:e.text,customdata:s.castOption(r,e.i,"customdata")}}(t),k=y.getFirstFilled(r.text,t.pts);(g(k)||""===k)&&(b.text=k),t.text=s.texttemplateString(m,b,e._fullLayout._d3locale,b,r._meta||{})}else t.text=""}}function R(e,t){var n=e.rotate*Math.PI/180,a=Math.cos(n),r=Math.sin(n),o=(t.left+t.right)/2,i=(t.top+t.bottom)/2;e.textX=o*a-i*r,e.textY=o*r+i*a,e.noCenter=!0}e.exports={plot:function(e,t){var n=e._fullLayout,o=n._size;p("pie",n),k(t,e),P(t,o);var f=s.makeTraceGroups(n._pielayer,t,"trace").each((function(t){var f=a.select(this),p=t[0],v=p.trace;!function(e){var t,n,a,r=e[0],o=r.r,i=r.trace,l=y.getRotationAngle(i.rotation),s=2*Math.PI/r.vTotal,c="px0",d="px1";if("counterclockwise"===i.direction){for(t=0;t<e.length&&e[t].hidden;t++);if(t===e.length)return;l+=s*e[t].v,s*=-1,c="px1",d="px0"}for(a=z(o,l),t=0;t<e.length;t++)(n=e[t]).hidden||(n[c]=a,n.startangle=l,l+=s*n.v/2,n.pxmid=z(o,l),n.midangle=l,a=z(o,l+=s*n.v/2),n.stopangle=l,n[d]=a,n.largeArc=n.v>r.vTotal/2?1:0,n.halfangle=Math.PI*Math.min(n.v/r.vTotal,.5),n.ring=1-i.hole,n.rInscribed=O(n,r))}(t),f.attr("stroke-linejoin","round"),f.each((function(){var x=a.select(this).selectAll("g.slice").data(t);x.enter().append("g").classed("slice",!0),x.exit().remove();var g=[[[],[]],[[],[]]],k=!1;x.each((function(r,o){if(r.hidden)a.select(this).selectAll("path,g").remove();else{r.pointNumber=r.i,r.curveNumber=v.index,g[r.pxmid[1]<0?0:1][r.pxmid[0]<0?0:1].push(r);var i=p.cx,c=p.cy,d=a.select(this),f=d.selectAll("path.surface").data([r]);if(f.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),d.call(m,e,t),v.pull){var x=+y.castOption(v.pull,r.pts)||0;x>0&&(i+=x*r.pxmid[0],c+=x*r.pxmid[1])}r.cxFinal=i,r.cyFinal=c;var _=v.hole;if(r.v===p.vTotal){var w="M"+(i+r.px0[0])+","+(c+r.px0[1])+M(r.px0,r.pxmid,!0,1)+M(r.pxmid,r.px0,!0,1)+"Z";_?f.attr("d","M"+(i+_*r.px0[0])+","+(c+_*r.px0[1])+M(r.px0,r.pxmid,!1,_)+M(r.pxmid,r.px0,!1,_)+"Z"+w):f.attr("d",w)}else{var A=M(r.px0,r.px1,!0,1);if(_){var T=1-_;f.attr("d","M"+(i+_*r.px1[0])+","+(c+_*r.px1[1])+M(r.px1,r.px0,!1,_)+"l"+T*r.px0[0]+","+T*r.px0[1]+A+"Z")}else f.attr("d","M"+i+","+c+"l"+r.px0[0]+","+r.px0[1]+A+"Z")}C(e,r,p);var I=y.castOption(v.textposition,r.pts),O=d.selectAll("g.slicetext").data(r.text&&"none"!==I?[0]:[]);O.enter().append("g").classed("slicetext",!0),O.exit().remove(),O.each((function(){var d=s.ensureSingle(a.select(this),"text","",(function(e){e.attr("data-notex",1)})),f=s.ensureUniformFontSize(e,"outside"===I?function(e,t,n){var a=y.castOption(e.outsidetextfont.color,t.pts)||y.castOption(e.textfont.color,t.pts)||n.color,r=y.castOption(e.outsidetextfont.family,t.pts)||y.castOption(e.textfont.family,t.pts)||n.family,o=y.castOption(e.outsidetextfont.size,t.pts)||y.castOption(e.textfont.size,t.pts)||n.size;return{color:a,family:r,size:o}}(v,r,n.font):b(v,r,n.font));d.text(r.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(l.font,f).call(u.convertToTspans,e);var x,g=l.bBox(d.node());if("outside"===I)x=S(g,r);else if(x=L(g,r,p),"auto"===I&&x.scale<1){var m=s.ensureUniformFontSize(e,v.outsidetextfont);d.call(l.font,m),x=S(g=l.bBox(d.node()),r)}var _=x.textPosAngle,w=void 0===_?r.pxmid:z(p.r,_);if(x.targetX=i+w[0]*x.rCenter+(x.x||0),x.targetY=c+w[1]*x.rCenter+(x.y||0),R(x,g),x.outside){var A=x.targetY;r.yLabelMin=A-g.height/2,r.yLabelMid=A,r.yLabelMax=A+g.height/2,r.labelExtraX=0,r.labelExtraY=0,k=!0}x.fontSize=f.size,h(v.type,x,n),t[o].transform=x,d.attr("transform",s.getTextTransform(x))}))}function M(e,t,n,a){var o=a*(t[0]-e[0]),i=a*(t[1]-e[1]);return"a"+a*p.r+","+a*p.r+" 0 "+r.largeArc+(n?" 1 ":" 0 ")+o+","+i}}));var _=a.select(this).selectAll("g.titletext").data(v.title.text?[0]:[]);if(_.enter().append("g").classed("titletext",!0),_.exit().remove(),_.each((function(){var t,n=s.ensureSingle(a.select(this),"text","",(function(e){e.attr("data-notex",1)})),r=v.title.text;v._meta&&(r=s.templateString(r,v._meta)),n.text(r).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(l.font,v.title.font).call(u.convertToTspans,e),t="middle center"===v.title.position?function(e){var t=Math.sqrt(e.titleBox.width*e.titleBox.width+e.titleBox.height*e.titleBox.height);return{x:e.cx,y:e.cy,scale:e.trace.hole*e.r*2/t,tx:0,ty:-e.titleBox.height/2+e.trace.title.font.size}}(p):M(p,o),n.attr("transform",d(t.x,t.y)+c(Math.min(1,t.scale))+d(t.tx,t.ty))})),k&&function(e,t){var n,a,r,o,i,l,s,c,d,u,f,h,p;function v(e,t){return e.pxmid[1]-t.pxmid[1]}function x(e,t){return t.pxmid[1]-e.pxmid[1]}function g(e,n){n||(n={});var r,c,d,f,h=n.labelExtraY+(a?n.yLabelMax:n.yLabelMin),p=a?e.yLabelMin:e.yLabelMax,v=a?e.yLabelMax:e.yLabelMin,x=e.cyFinal+i(e.px0[1],e.px1[1]),g=h-p;if(g*s>0&&(e.labelExtraY=g),Array.isArray(t.pull))for(c=0;c<u.length;c++)(d=u[c])===e||(y.castOption(t.pull,e.pts)||0)>=(y.castOption(t.pull,d.pts)||0)||((e.pxmid[1]-d.pxmid[1])*s>0?(g=d.cyFinal+i(d.px0[1],d.px1[1])-p-e.labelExtraY)*s>0&&(e.labelExtraY+=g):(v+e.labelExtraY-x)*s>0&&(r=3*l*Math.abs(c-u.indexOf(e)),(f=d.cxFinal+o(d.px0[0],d.px1[0])+r-(e.cxFinal+e.pxmid[0])-e.labelExtraX)*l>0&&(e.labelExtraX+=f)))}for(a=0;a<2;a++)for(r=a?v:x,i=a?Math.max:Math.min,s=a?1:-1,n=0;n<2;n++){for(o=n?Math.max:Math.min,l=n?1:-1,(c=e[a][n]).sort(r),d=e[1-a][n],u=d.concat(c),h=[],f=0;f<c.length;f++)void 0!==c[f].yLabelMid&&h.push(c[f]);for(p=!1,f=0;a&&f<d.length;f++)if(void 0!==d[f].yLabelMid){p=d[f];break}for(f=0;f<h.length;f++){var m=f&&h[f-1];p&&!f&&(m=p),g(h[f],m)}}}(g,v),function(e,t){e.each((function(e){var n=a.select(this);if(e.labelExtraX||e.labelExtraY){var r=n.select("g.slicetext text");e.transform.targetX+=e.labelExtraX,e.transform.targetY+=e.labelExtraY,r.attr("transform",s.getTextTransform(e.transform));var o=e.cxFinal+e.pxmid[0],l="M"+o+","+(e.cyFinal+e.pxmid[1]),c=(e.yLabelMax-e.yLabelMin)*(e.pxmid[0]<0?-1:1)/4;if(e.labelExtraX){var d=e.labelExtraX*e.pxmid[1]/e.pxmid[0],u=e.yLabelMid+e.labelExtraY-(e.cyFinal+e.pxmid[1]);Math.abs(d)>Math.abs(u)?l+="l"+u*e.pxmid[0]/e.pxmid[1]+","+u+"H"+(o+e.labelExtraX+c):l+="l"+e.labelExtraX+","+d+"v"+(u-d)+"h"+c}else l+="V"+(e.yLabelMid+e.labelExtraY)+"h"+c;s.ensureSingle(n,"path","textline").call(i.stroke,t.outsidetextfont.color).attr({"stroke-width":Math.min(2,t.outsidetextfont.size/8),d:l,fill:"none"})}else n.select("path.textline").remove()}))}(x,v),k&&v.automargin){var w=l.bBox(f.node()),A=v.domain,T=o.w*(A.x[1]-A.x[0]),I=o.h*(A.y[1]-A.y[0]),O=(.5*T-p.r)/o.w,E=(.5*I-p.r)/o.h;r.autoMargin(e,"pie."+v.uid+".automargin",{xl:A.x[0]-O,xr:A.x[1]+O,yb:A.y[0]-E,yt:A.y[1]+E,l:Math.max(p.cx-p.r-w.left,0),r:Math.max(w.right-(p.cx+p.r),0),b:Math.max(w.bottom-(p.cy+p.r),0),t:Math.max(p.cy-p.r-w.top,0),pad:5})}}))}));setTimeout((function(){f.selectAll("tspan").each((function(){var e=a.select(this);e.attr("dy")&&e.attr("dy",e.attr("dy"))}))}),0)},formatSliceLabel:C,transformInsideText:L,determineInsideTextFont:b,positionTitleOutside:M,prerenderTitles:k,layoutAreas:P,attachFxHandlers:m,computeTransform:R}},9884:function(e,t,n){var a=n(62258),r=n(59371),o=n(77846).resizeText;e.exports=function(e){var t=e._fullLayout._pielayer.selectAll(".trace");o(e,t,"pie"),t.each((function(e){var t=e[0].trace,n=a.select(this);n.style({opacity:t.opacity}),n.selectAll("path.surface").each((function(e){a.select(this).call(r,e,t)}))}))}},59371:function(e,t,n){var a=n(31454),r=n(80084).castOption;e.exports=function(e,t,n){var o=n.marker.line,i=r(o.color,t.pts)||a.defaultLine,l=r(o.width,t.pts)||0;e.style("stroke-width",l).call(a.fill,t.color).call(a.stroke,i)}},26481:function(e,t,n){var a=n(47216);e.exports={x:a.x,y:a.y,xy:{valType:"data_array",editType:"calc",description:["Faster alternative to specifying `x` and `y` separately.","If supplied, it must be a typed `Float32Array` array that","represents points such that `xy[i * 2] = x[i]` and `xy[i * 2 + 1] = y[i]`"].join(" ")},indices:{valType:"data_array",editType:"calc",description:["A sequential value, 0..n, supply it to avoid creating this array inside plotting.","If specified, it must be a typed `Int32Array` array.","Its length must be equal to or greater than the number of points.","For the best performance and memory use, create one large `indices` typed array","that is guaranteed to be at least as long as the largest number of points during","use, and reuse it on each `Plotly.restyle()` call."].join(" ")},xbounds:{valType:"data_array",editType:"calc",description:["Specify `xbounds` in the shape of `[xMin, xMax] to avoid looping through","the `xy` typed array. Use it in conjunction with `xy` and `ybounds` for the performance benefits."].join(" ")},ybounds:{valType:"data_array",editType:"calc",description:["Specify `ybounds` in the shape of `[yMin, yMax] to avoid looping through","the `xy` typed array. Use it in conjunction with `xy` and `xbounds` for the performance benefits."].join(" ")},text:a.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc",description:["Sets the marker fill color. It accepts a specific color.","If the color is not fully opaque and there are hundreds of thousands","of points, it may cause slower zooming and panning."].join("")},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc",description:["Sets the marker opacity. The default value is `1` (fully opaque).","If the markers are not fully opaque and there are hundreds of thousands","of points, it may cause slower zooming and panning.","Opacity fades the color even if `blend` is left on `false` even if there","is no translucency effect in that case."].join(" ")},blend:{valType:"boolean",dflt:null,editType:"calc",description:["Determines if colors are blended together for a translucency effect","in case `opacity` is specified as a value less then `1`.","Setting `blend` to `true` reduces zoom/pan","speed if used with large numbers of points."].join(" ")},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc",description:["Sets the minimum size (in px) of the rendered marker points, effective when","the `pointcloud` shows a million or more points."].join(" ")},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc",description:["Sets the maximum size (in px) of the rendered marker points.","Effective when the `pointcloud` shows only few points."].join(" ")},border:{color:{valType:"color",arrayOk:!1,editType:"calc",description:["Sets the stroke color. It accepts a specific color.","If the color is not fully opaque and there are hundreds of thousands","of points, it may cause slower zooming and panning."].join(" ")},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc",description:["Specifies what fraction of the marker area is covered with the","border."].join(" ")},editType:"calc"},editType:"calc"},transforms:void 0}},29177:function(e,t,n){var a=n(66745),r=n(42770),o=n(9319).findExtremes,i=n(56035);function l(e,t){this.scene=e,this.uid=t,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=a(e.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var s=l.prototype;s.handlePick=function(e){var t=this.idToIndex[e.pointId];return{trace:this,dataCoord:e.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*t],this.pickXYData[2*t+1]]:[this.pickXData[t],this.pickYData[t]],textLabel:Array.isArray(this.textLabels)?this.textLabels[t]:this.textLabels,color:this.color,name:this.name,pointIndex:t,hoverinfo:this.hoverinfo}},s.update=function(e){this.index=e.index,this.textLabels=e.text,this.name=e.name,this.hoverinfo=e.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(e),this.color=i(e,{})},s.updateFast=function(e){var t,n,a,i,l,s,c=this.xData=this.pickXData=e.x,d=this.yData=this.pickYData=e.y,u=this.pickXYData=e.xy,f=e.xbounds&&e.ybounds,h=e.indices,p=this.bounds;if(u){if(a=u,t=u.length>>>1,f)p[0]=e.xbounds[0],p[2]=e.xbounds[1],p[1]=e.ybounds[0],p[3]=e.ybounds[1];else for(s=0;s<t;s++)i=a[2*s],l=a[2*s+1],i<p[0]&&(p[0]=i),i>p[2]&&(p[2]=i),l<p[1]&&(p[1]=l),l>p[3]&&(p[3]=l);if(h)n=h;else for(n=new Int32Array(t),s=0;s<t;s++)n[s]=s}else for(t=c.length,a=new Float32Array(2*t),n=new Int32Array(t),s=0;s<t;s++)i=c[s],l=d[s],n[s]=s,a[2*s]=i,a[2*s+1]=l,i<p[0]&&(p[0]=i),i>p[2]&&(p[2]=i),l<p[1]&&(p[1]=l),l>p[3]&&(p[3]=l);this.idToIndex=n,this.pointcloudOptions.idToIndex=n,this.pointcloudOptions.positions=a;var v=r(e.marker.color),y=r(e.marker.border.color),x=e.opacity*e.marker.opacity;v[3]*=x,this.pointcloudOptions.color=v;var g=e.marker.blend;if(null===g){g=c.length<100||d.length<100}this.pointcloudOptions.blend=g,y[3]*=x,this.pointcloudOptions.borderColor=y;var m=e.marker.sizemin,b=Math.max(e.marker.sizemax,e.marker.sizemin);this.pointcloudOptions.sizeMin=m,this.pointcloudOptions.sizeMax=b,this.pointcloudOptions.areaRatio=e.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var k=this.scene.xaxis,L=this.scene.yaxis,_=b/2||.5;e._extremes[k._id]=o(k,[p[0],p[2]],{ppad:_}),e._extremes[L._id]=o(L,[p[1],p[3]],{ppad:_})},s.dispose=function(){this.pointcloud.dispose()},e.exports=function(e,t){var n=new l(e,t.uid);return n.update(t),n}},96022:function(e,t,n){var a=n(47401),r=n(26481);e.exports=function(e,t,n){function o(n,o){return a.coerce(e,t,r,n,o)}o("x"),o("y"),o("xbounds"),o("ybounds"),e.xy&&e.xy instanceof Float32Array&&(t.xy=e.xy),e.indices&&e.indices instanceof Int32Array&&(t.indices=e.indices),o("text"),o("marker.color",n),o("marker.opacity"),o("marker.blend"),o("marker.sizemin"),o("marker.sizemax"),o("marker.border.color",n),o("marker.border.arearatio"),t._length=null}},99874:function(e,t,n){var a=["*pointcloud* trace is deprecated!","Please consider switching to the *scattergl* trace type."].join(" ");e.exports={attributes:n(26481),supplyDefaults:n(96022),calc:n(8809),plot:n(29177),moduleType:"trace",name:"pointcloud",basePlotModule:n(92198),categories:["gl","gl2d","showLegend"],meta:{description:[a,"The data visualized as a point cloud set in `x` and `y`","using the WebGl plotting engine."].join(" ")}}},39987:function(e,t,n){var a=n(5153),r=n(42837),o=n(62405),i=n(97280),l=n(16688).u,s=n(4216).r,c=n(97451),d=n(92704).templatedArray,u=n(20184).descriptionOnlyNumbers,f=n(87241).extendFlat,h=n(17342).overrideAll;(e.exports=h({hoverinfo:f({},r.hoverinfo,{flags:[],arrayOk:!1,description:["Determines which trace information appear on hover.","If `none` or `skip` are set, no information is displayed upon hovering.","But, if `none` is set, click and hover events are still fired.","Note that this attribute is superseded by `node.hoverinfo` and `node.hoverinfo`","for nodes and links respectively."].join(" ")}),hoverlabel:i.hoverlabel,domain:l({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h",description:"Sets the orientation of the Sankey diagram."},valueformat:{valType:"string",dflt:".3s",description:u("value")},valuesuffix:{valType:"string",dflt:"",description:["Adds a unit to follow the value in the hover tooltip. Add a space if a separation","is necessary from the value."].join(" ")},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap",description:["If value is `snap` (the default), the node arrangement is assisted by automatic snapping of elements to","preserve space between nodes specified via `nodepad`.","If value is `perpendicular`, the nodes can only move along a line perpendicular to the flow.","If value is `freeform`, the nodes can freely move on the plane.","If value is `fixed`, the nodes are stationary."].join(" ")},textfont:a({description:"Sets the font for node labels"}),customdata:void 0,node:{label:{valType:"data_array",dflt:[],description:"The shown name of the node."},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"},description:["Groups of nodes.","Each group is defined by an array with the indices of the nodes it contains.","Multiple groups can be specified."].join(" ")},x:{valType:"data_array",dflt:[],description:"The normalized horizontal position of the node."},y:{valType:"data_array",dflt:[],description:"The normalized vertical position of the node."},color:{valType:"color",arrayOk:!0,description:["Sets the `node` color. It can be a single value, or an array for specifying color for each `node`.","If `node.color` is omitted, then the default `Plotly` color palette will be cycled through","to have a variety of colors. These defaults are not fully opaque, to allow some visibility of","what is beneath the node."].join(" ")},customdata:{valType:"data_array",editType:"calc",description:["Assigns extra data to each node."].join(" ")},line:{color:{valType:"color",dflt:o.defaultLine,arrayOk:!0,description:["Sets the color of the `line` around each `node`."].join(" ")},width:{valType:"number",min:0,dflt:.5,arrayOk:!0,description:["Sets the width (in px) of the `line` around each `node`."].join(" ")}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20,description:"Sets the padding (in px) between the `nodes`."},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20,description:"Sets the thickness (in px) of the `nodes`."},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all",description:["Determines which trace information appear when hovering nodes.","If `none` or `skip` are set, no information is displayed upon hovering.","But, if `none` is set, click and hover events are still fired."].join(" ")},hoverlabel:i.hoverlabel,hovertemplate:s({},{description:"Variables `sourceLinks` and `targetLinks` are arrays of link objects.",keys:["value","label"]}),description:"The nodes of the Sankey plot."},link:{label:{valType:"data_array",dflt:[],description:"The shown name of the link."},color:{valType:"color",arrayOk:!0,description:["Sets the `link` color. It can be a single value, or an array for specifying color for each `link`.","If `link.color` is omitted, then by default, a translucent grey link will be used."].join(" ")},customdata:{valType:"data_array",editType:"calc",description:["Assigns extra data to each link."].join(" ")},line:{color:{valType:"color",dflt:o.defaultLine,arrayOk:!0,description:["Sets the color of the `line` around each `link`."].join(" ")},width:{valType:"number",min:0,dflt:0,arrayOk:!0,description:["Sets the width (in px) of the `line` around each `link`."].join(" ")}},source:{valType:"data_array",dflt:[],description:"An integer number `[0..nodes.length - 1]` that represents the source node."},target:{valType:"data_array",dflt:[],description:"An integer number `[0..nodes.length - 1]` that represents the target node."},value:{valType:"data_array",dflt:[],description:"A numeric value representing the flow volume value."},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all",description:["Determines which trace information appear when hovering links.","If `none` or `skip` are set, no information is displayed upon hovering.","But, if `none` is set, click and hover events are still fired."].join(" ")},hoverlabel:i.hoverlabel,hovertemplate:s({},{description:"Variables `source` and `target` are node objects.",keys:["value","label"]}),colorscales:d("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",description:"The label of the links to color based on their concentration within a flow.",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1,description:["Sets the upper bound of the color domain."].join("")},cmin:{valType:"number",editType:"calc",dflt:0,description:["Sets the lower bound of the color domain."].join("")},colorscale:f(c().colorscale,{dflt:[[0,"white"],[1,"black"]]})}),description:"The links of the Sankey plot."}},"calc","nested")).transforms=void 0},32357:function(e,t,n){var a=n(17342).overrideAll,r=n(13373).eV,o=n(98813),i=n(51499),l=n(82559),s=n(52783),c=n(88987).prepSelect,d=n(47401),u=n(62282),f="sankey";function h(e,t){var n=e._fullData[t],a=e._fullLayout,r=a.dragmode,o="pan"===a.dragmode?"move":"crosshair",i=n._bgRect;if("pan"!==r&&"zoom"!==r){l(i,o);var f={_id:"x",c2p:d.identity,_offset:n._sankey.translateX,_length:n._sankey.width},h={_id:"y",c2p:d.identity,_offset:n._sankey.translateY,_length:n._sankey.height},p={gd:e,element:i.node(),plotinfo:{id:t,xaxis:f,yaxis:h,fillRangeItems:d.noop},subplot:t,xaxes:[f],yaxes:[h],doneFnCompleted:function(n){var a,r=e._fullData[t],o=r.node.groups.slice(),i=[];function l(e){for(var t=r._sankey.graph.nodes,n=0;n<t.length;n++)if(t[n].pointNumber===e)return t[n]}for(var s=0;s<n.length;s++){var c=l(n[s].pointNumber);if(c)if(c.group){for(var d=0;d<c.childrenNodes.length;d++)i.push(c.childrenNodes[d].pointNumber);o[c.pointNumber-r.node._count]=!1}else i.push(c.pointNumber)}a=o.filter(Boolean).concat([i]),u.call("_guiRestyle",e,{"node.groups":[a]},t)},prepFn:function(e,t,n){c(e,t,n,p,r)}};s.init(p)}}t.name=f,t.baseLayoutAttrOverrides=a({hoverlabel:i.hoverlabel},"plot","nested"),t.plot=function(e){var n=r(e.calcdata,f)[0];o(e,n),t.updateFx(e)},t.clean=function(e,t,n,a){var r=a._has&&a._has(f),o=t._has&&t._has(f);r&&!o&&(a._paperdiv.selectAll(".sankey").remove(),a._paperdiv.selectAll(".bgsankey").remove())},t.updateFx=function(e){for(var t=0;t<e._fullData.length;t++)h(e,t)}},56691:function(e,t,n){var a=n(88363),r=n(47401),o=n(84941).wrap,i=r.isArrayOrTypedArray,l=r.isIndex,s=n(47624);function c(e){var t,n=e.node,o=e.link,c=[],d=i(o.color),u=i(o.customdata),f={},h={},p=o.colorscales.length;for(t=0;t<p;t++){var v=o.colorscales[t],y=s.extractScale(v,{cLetter:"c"}),x=s.makeColorScaleFunc(y);h[v.label]=x}var g=0;for(t=0;t<o.value.length;t++)o.source[t]>g&&(g=o.source[t]),o.target[t]>g&&(g=o.target[t]);var m,b=g+1;e.node._count=b;var k=e.node.groups,L={};for(t=0;t<k.length;t++){var _=k[t];for(m=0;m<_.length;m++){var w=_[m],A=b+t;L.hasOwnProperty(w)?r.warn("Node "+w+" is already part of a group."):L[w]=A}}var T={source:[],target:[]};for(t=0;t<o.value.length;t++){var I=o.value[t],O=o.source[t],S=o.target[t];if(I>0&&l(O,b)&&l(S,b)&&(!L.hasOwnProperty(O)||!L.hasOwnProperty(S)||L[O]!==L[S])){L.hasOwnProperty(S)&&(S=L[S]),L.hasOwnProperty(O)&&(O=L[O]),S=+S,f[O=+O]=f[S]=!0;var M="";o.label&&o.label[t]&&(M=o.label[t]);var E=null;M&&h.hasOwnProperty(M)&&(E=h[M]),c.push({pointNumber:t,label:M,color:d?o.color[t]:o.color,customdata:u?o.customdata[t]:o.customdata,concentrationscale:E,source:O,target:S,value:+I}),T.source.push(O),T.target.push(S)}}var F=b+k.length,P=i(n.color),z=i(n.customdata),C=[];for(t=0;t<F;t++)if(f[t]){var R=n.label[t];C.push({group:t>b-1,childrenNodes:[],pointNumber:t,label:R,color:P?n.color[t]:n.color,customdata:z?n.customdata[t]:n.customdata})}var D=!1;return function(e,t,n){for(var o=r.init2dArray(e,0),i=0;i<Math.min(t.length,n.length);i++)if(r.isIndex(t[i],e)&&r.isIndex(n[i],e)){if(t[i]===n[i])return!0;o[t[i]].push(n[i])}var l=a(o);return l.components.some((function(e){return e.length>1}))}(F,T.source,T.target)&&(D=!0),{circular:D,links:c,nodes:C,groups:k,groupLookup:L}}e.exports=function(e,t){var n=c(t);return o({circular:n.circular,_nodes:n.nodes,_links:n.links,_groups:n.groups,_groupLookup:n.groupLookup})}},79957:function(e){e.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},23892:function(e,t,n){var a=n(47401),r=n(39987),o=n(31454),i=n(91771),l=n(16688).N,s=n(94158),c=n(92704),d=n(26800);function u(e,t){function n(n,o){return a.coerce(e,t,r.link.colorscales,n,o)}n("label"),n("cmin"),n("cmax"),n("colorscale")}e.exports=function(e,t,n,f){function h(n,o){return a.coerce(e,t,r,n,o)}var p=a.extendDeep(f.hoverlabel,e.hoverlabel),v=e.node,y=c.newContainer(t,"node");function x(e,t){return a.coerce(v,y,r.node,e,t)}x("label"),x("groups"),x("x"),x("y"),x("pad"),x("thickness"),x("line.color"),x("line.width"),x("hoverinfo",e.hoverinfo),s(v,y,x,p),x("hovertemplate");var g=f.colorway;x("color",y.label.map((function(e,t){return o.addOpacity(function(e){return g[e%g.length]}(t),.8)}))),x("customdata");var m=e.link||{},b=c.newContainer(t,"link");function k(e,t){return a.coerce(m,b,r.link,e,t)}k("label"),k("source"),k("target"),k("value"),k("line.color"),k("line.width"),k("hoverinfo",e.hoverinfo),s(m,b,k,p),k("hovertemplate");var L,_=i(f.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";k("color",a.repeat(_,b.value.length)),k("customdata"),d(m,b,{name:"colorscales",handleItemDefaults:u}),l(t,f,h),h("orientation"),h("valueformat"),h("valuesuffix"),y.x.length&&y.y.length&&(L="freeform"),h("arrangement",L),a.coerceFont(h,"textfont",a.extendFlat({},f.font)),t._length=null}},11808:function(e,t,n){e.exports={attributes:n(39987),supplyDefaults:n(23892),calc:n(56691),plot:n(98813),moduleType:"trace",name:"sankey",basePlotModule:n(32357),selectPoints:n(39934),categories:["noOpacity"],meta:{description:["Sankey plots for network flow data analysis.","The nodes are specified in `nodes` and the links between sources and targets in `links`.","The colors are set in `nodes[i].color` and `links[i].color`, otherwise defaults are used."].join(" ")}}},98813:function(e,t,n){var a=n(62258),r=n(47401),o=r.numberFormat,i=n(75518),l=n(21661),s=n(31454),c=n(79957).cn,d=r._;function u(e){return""!==e}function f(e,t){return e.filter((function(e){return e.key===t.traceId}))}function h(e,t){a.select(e).select("path").style("fill-opacity",t),a.select(e).select("rect").style("fill-opacity",t)}function p(e){a.select(e).select("text.name").style("fill","black")}function v(e){return function(t){return-1!==e.node.sourceLinks.indexOf(t.link)||-1!==e.node.targetLinks.indexOf(t.link)}}function y(e){return function(t){return-1!==t.node.sourceLinks.indexOf(e.link)||-1!==t.node.targetLinks.indexOf(e.link)}}function x(e,t,n){t&&n&&f(n,t).selectAll("."+c.sankeyLink).filter(v(t)).call(m.bind(0,t,n,!1))}function g(e,t,n){t&&n&&f(n,t).selectAll("."+c.sankeyLink).filter(v(t)).call(b.bind(0,t,n,!1))}function m(e,t,n,a){var r=a.datum().link.label;a.style("fill-opacity",(function(e){if(!e.link.concentrationscale)return.4})),r&&f(t,e).selectAll("."+c.sankeyLink).filter((function(e){return e.link.label===r})).style("fill-opacity",(function(e){if(!e.link.concentrationscale)return.4})),n&&f(t,e).selectAll("."+c.sankeyNode).filter(y(e)).call(x)}function b(e,t,n,a){var r=a.datum().link.label;a.style("fill-opacity",(function(e){return e.tinyColorAlpha})),r&&f(t,e).selectAll("."+c.sankeyLink).filter((function(e){return e.link.label===r})).style("fill-opacity",(function(e){return e.tinyColorAlpha})),n&&f(t,e).selectAll(c.sankeyNode).filter(y(e)).call(g)}function k(e,t){var n=e.hoverlabel||{},a=r.nestedProperty(n,t).get();return!Array.isArray(a)&&a}e.exports=function(e,t){for(var n=e._fullLayout,r=n._paper,f=n._size,v=0;v<e._fullData.length;v++)if(e._fullData[v].visible&&e._fullData[v].type===c.sankey&&!e._fullData[v]._viewInitial){var y=e._fullData[v].node;e._fullData[v]._viewInitial={node:{groups:y.groups.slice(),x:y.x.slice(),y:y.y.slice()}}}var L=d(e,"source:")+" ",_=d(e,"target:")+" ",w=d(e,"concentration:")+" ",A=d(e,"incoming flow count:")+" ",T=d(e,"outgoing flow count:")+" ";i(e,r,t,{width:f.w,height:f.h,margin:{t:f.t,r:f.r,b:f.b,l:f.l}},{linkEvents:{hover:function(t,n,r){!1!==e._fullLayout.hovermode&&(a.select(t).call(m.bind(0,n,r,!0)),"skip"!==n.link.trace.link.hoverinfo&&(n.link.fullData=n.link.trace,e.emit("plotly_hover",{event:a.event,points:[n.link]})))},follow:function(t,r){if(!1!==e._fullLayout.hovermode){var i=r.link.trace.link;if("none"!==i.hoverinfo&&"skip"!==i.hoverinfo){for(var c=[],d=0,f=0;f<r.flow.links.length;f++){var v=r.flow.links[f];if("closest"!==e._fullLayout.hovermode||r.link.pointNumber===v.pointNumber){r.link.pointNumber===v.pointNumber&&(d=f),v.fullData=v.trace,i=r.link.trace.link;var y=g(v),x={valueLabel:o(r.valueFormat)(v.value)+r.valueSuffix};c.push({x:y[0],y:y[1],name:x.valueLabel,text:[v.label||"",L+v.source.label,_+v.target.label,v.concentrationscale?w+o("%0.2f")(v.flow.labelConcentration):""].filter(u).join("<br>"),color:k(i,"bgcolor")||s.addOpacity(v.color,1),borderColor:k(i,"bordercolor"),fontFamily:k(i,"font.family"),fontSize:k(i,"font.size"),fontColor:k(i,"font.color"),nameLength:k(i,"namelength"),textAlign:k(i,"align"),idealAlign:a.event.x<y[0]?"right":"left",hovertemplate:i.hovertemplate,hovertemplateLabels:x,eventData:[v]})}}l.loneHover(c,{container:n._hoverlayer.node(),outerContainer:n._paper.node(),gd:e,anchorIndex:d}).each((function(){r.link.concentrationscale||h(this,.65),p(this)}))}}function g(e){var t,n;e.circular?(t=(e.circularPathData.leftInnerExtent+e.circularPathData.rightInnerExtent)/2,n=e.circularPathData.verticalFullExtent):(t=(e.source.x1+e.target.x0)/2,n=(e.y0+e.y1)/2);var a=[t,n];return"v"===e.trace.orientation&&a.reverse(),a[0]+=r.parent.translateX,a[1]+=r.parent.translateY,a}},unhover:function(t,r,o){!1!==e._fullLayout.hovermode&&(a.select(t).call(b.bind(0,r,o,!0)),"skip"!==r.link.trace.link.hoverinfo&&(r.link.fullData=r.link.trace,e.emit("plotly_unhover",{event:a.event,points:[r.link]})),l.loneUnhover(n._hoverlayer.node()))},select:function(t,n){var r=n.link;r.originalEvent=a.event,e._hoverdata=[r],l.click(e,{target:!0})}},nodeEvents:{hover:function(t,n,r){!1!==e._fullLayout.hovermode&&(a.select(t).call(x,n,r),"skip"!==n.node.trace.node.hoverinfo&&(n.node.fullData=n.node.trace,e.emit("plotly_hover",{event:a.event,points:[n.node]})))},follow:function(t,r){if(!1!==e._fullLayout.hovermode){var i=r.node.trace.node;if("none"!==i.hoverinfo&&"skip"!==i.hoverinfo){var s=a.select(t).select("."+c.nodeRect),d=e._fullLayout._paperdiv.node().getBoundingClientRect(),f=s.node().getBoundingClientRect(),v=f.left-2-d.left,y=f.right+2-d.left,x=f.top+f.height/4-d.top,g={valueLabel:o(r.valueFormat)(r.node.value)+r.valueSuffix};r.node.fullData=r.node.trace,e._fullLayout._calcInverseTransform(e);var m=e._fullLayout._invScaleX,b=e._fullLayout._invScaleY,L=l.loneHover({x0:m*v,x1:m*y,y:b*x,name:o(r.valueFormat)(r.node.value)+r.valueSuffix,text:[r.node.label,A+r.node.targetLinks.length,T+r.node.sourceLinks.length].filter(u).join("<br>"),color:k(i,"bgcolor")||r.tinyColorHue,borderColor:k(i,"bordercolor"),fontFamily:k(i,"font.family"),fontSize:k(i,"font.size"),fontColor:k(i,"font.color"),nameLength:k(i,"namelength"),textAlign:k(i,"align"),idealAlign:"left",hovertemplate:i.hovertemplate,hovertemplateLabels:g,eventData:[r.node]},{container:n._hoverlayer.node(),outerContainer:n._paper.node(),gd:e});h(L,.85),p(L)}}},unhover:function(t,r,o){!1!==e._fullLayout.hovermode&&(a.select(t).call(g,r,o),"skip"!==r.node.trace.node.hoverinfo&&(r.node.fullData=r.node.trace,e.emit("plotly_unhover",{event:a.event,points:[r.node]})),l.loneUnhover(n._hoverlayer.node()))},select:function(t,n,r){var o=n.node;o.originalEvent=a.event,e._hoverdata=[o],a.select(t).call(g,n,r),l.click(e,{target:!0})}}})}},75518:function(e,t,n){var a=n(27755),r=n(87717).Dj,o=n(62258),i=n(76392),l=n(70233),s=n(79957),c=n(91771),d=n(31454),u=n(41707),f=n(47401),h=f.strTranslate,p=f.strRotate,v=n(84941),y=v.keyFun,x=v.repeat,g=v.unwrap,m=n(43995),b=n(62282),k=n(60482),L=k.CAP_SHIFT,_=k.LINE_SPACING;function w(e,t,n){var a,r=g(t),o=r.trace,d=o.domain,u="h"===o.orientation,h=o.node.pad,p=o.node.thickness,v=e.width*(d.x[1]-d.x[0]),y=e.height*(d.y[1]-d.y[0]),x=r._nodes,m=r._links,b=r.circular;(a=b?l.sankeyCircular().circularLinkGap(0):i.sankey()).iterations(s.sankeyIterations).size(u?[v,y]:[y,v]).nodeWidth(p).nodePadding(h).nodeId((function(e){return e.pointNumber})).nodes(x).links(m);var k,L,_,w=a();for(var A in a.nodePadding()<h&&f.warn("node.pad was reduced to ",a.nodePadding()," to fit within the figure."),r._groupLookup){var T,I=parseInt(r._groupLookup[A]);for(k=0;k<w.nodes.length;k++)if(w.nodes[k].pointNumber===I){T=w.nodes[k];break}if(T){var O={pointNumber:parseInt(A),x0:T.x0,x1:T.x1,y0:T.y0,y1:T.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};w.nodes.unshift(O),T.childrenNodes.unshift(O)}}if(function(){for(k=0;k<w.nodes.length;k++){var e,t,n=w.nodes[k],a={};for(L=0;L<n.targetLinks.length;L++)e=(t=n.targetLinks[L]).source.pointNumber+":"+t.target.pointNumber,a.hasOwnProperty(e)||(a[e]=[]),a[e].push(t);var r=Object.keys(a);for(L=0;L<r.length;L++){var o=a[e=r[L]],i=0,l={};for(_=0;_<o.length;_++)l[(t=o[_]).label]||(l[t.label]=0),l[t.label]+=t.value,i+=t.value;for(_=0;_<o.length;_++)(t=o[_]).flow={value:i,labelConcentration:l[t.label]/i,concentration:t.value/i,links:o},t.concentrationscale&&(t.color=c(t.concentrationscale(t.flow.labelConcentration)))}var s=0;for(L=0;L<n.sourceLinks.length;L++)s+=n.sourceLinks[L].value;for(L=0;L<n.sourceLinks.length;L++)(t=n.sourceLinks[L]).concentrationOut=t.value/s;var d=0;for(L=0;L<n.targetLinks.length;L++)d+=n.targetLinks[L].value;for(L=0;L<n.targetLinks.length;L++)(t=n.targetLinks[L]).concenrationIn=t.value/d}}(),o.node.x.length&&o.node.y.length){for(k=0;k<Math.min(o.node.x.length,o.node.y.length,w.nodes.length);k++)if(o.node.x[k]&&o.node.y[k]){var S=[o.node.x[k]*v,o.node.y[k]*y];w.nodes[k].x0=S[0]-p/2,w.nodes[k].x1=S[0]+p/2;var M=w.nodes[k].y1-w.nodes[k].y0;w.nodes[k].y0=S[1]-M/2,w.nodes[k].y1=S[1]+M/2}if("snap"===o.arrangement)!function(e){e.forEach((function(e){var t,n,a,r=0,o=e.length;for(e.sort((function(e,t){return e.y0-t.y0})),a=0;a<o;++a)(t=e[a]).y0>=r||(n=r-t.y0)>1e-6&&(t.y0+=n,t.y1+=n),r=t.y1+h}))}(function(e){var t,n,a=e.map((function(e,t){return{x0:e.x0,index:t}})).sort((function(e,t){return e.x0-t.x0})),r=[],o=-1,i=-1/0;for(k=0;k<a.length;k++){var l=e[a[k].index];l.x0>i+p&&(o+=1,t=l.x0),i=l.x0,r[o]||(r[o]=[]),r[o].push(l),n=t-l.x0,l.x0+=n,l.x1+=n}return r}(x=w.nodes));a.update(w)}return{circular:b,key:n,trace:o,guid:f.randstr(),horizontal:u,width:v,height:y,nodePad:o.node.pad,nodeLineColor:o.node.line.color,nodeLineWidth:o.node.line.width,linkLineColor:o.link.line.color,linkLineWidth:o.link.line.width,valueFormat:o.valueformat,valueSuffix:o.valuesuffix,textFont:o.textfont,translateX:d.x[0]*e.width+e.margin.l,translateY:e.height-d.y[1]*e.height+e.margin.t,dragParallel:u?y:v,dragPerpendicular:u?v:y,arrangement:o.arrangement,sankey:a,graph:w,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function A(e,t,n){var a=c(t.color),r=t.source.label+"|"+t.target.label+"__"+n;return t.trace=e.trace,t.curveNumber=e.trace.index,{circular:e.circular,key:r,traceId:e.key,pointNumber:t.pointNumber,link:t,tinyColorHue:d.tinyRGB(a),tinyColorAlpha:a.getAlpha(),linkPath:T,linkLineColor:e.linkLineColor,linkLineWidth:e.linkLineWidth,valueFormat:e.valueFormat,valueSuffix:e.valueSuffix,sankey:e.sankey,parent:e,interactionState:e.interactionState,flow:t.flow}}function T(){return function(e){if(e.link.circular)return function(e){var t=e.width/2,n=e.circularPathData;return"top"===e.circularLinkType?"M "+n.targetX+" "+(n.targetY+t)+" L"+n.rightInnerExtent+" "+(n.targetY+t)+"A"+(n.rightLargeArcRadius+t)+" "+(n.rightSmallArcRadius+t)+" 0 0 1 "+(n.rightFullExtent-t)+" "+(n.targetY-n.rightSmallArcRadius)+"L"+(n.rightFullExtent-t)+" "+n.verticalRightInnerExtent+"A"+(n.rightLargeArcRadius+t)+" "+(n.rightLargeArcRadius+t)+" 0 0 1 "+n.rightInnerExtent+" "+(n.verticalFullExtent-t)+"L"+n.leftInnerExtent+" "+(n.verticalFullExtent-t)+"A"+(n.leftLargeArcRadius+t)+" "+(n.leftLargeArcRadius+t)+" 0 0 1 "+(n.leftFullExtent+t)+" "+n.verticalLeftInnerExtent+"L"+(n.leftFullExtent+t)+" "+(n.sourceY-n.leftSmallArcRadius)+"A"+(n.leftLargeArcRadius+t)+" "+(n.leftSmallArcRadius+t)+" 0 0 1 "+n.leftInnerExtent+" "+(n.sourceY+t)+"L"+n.sourceX+" "+(n.sourceY+t)+"L"+n.sourceX+" "+(n.sourceY-t)+"L"+n.leftInnerExtent+" "+(n.sourceY-t)+"A"+(n.leftLargeArcRadius-t)+" "+(n.leftSmallArcRadius-t)+" 0 0 0 "+(n.leftFullExtent-t)+" "+(n.sourceY-n.leftSmallArcRadius)+"L"+(n.leftFullExtent-t)+" "+n.verticalLeftInnerExtent+"A"+(n.leftLargeArcRadius-t)+" "+(n.leftLargeArcRadius-t)+" 0 0 0 "+n.leftInnerExtent+" "+(n.verticalFullExtent+t)+"L"+n.rightInnerExtent+" "+(n.verticalFullExtent+t)+"A"+(n.rightLargeArcRadius-t)+" "+(n.rightLargeArcRadius-t)+" 0 0 0 "+(n.rightFullExtent+t)+" "+n.verticalRightInnerExtent+"L"+(n.rightFullExtent+t)+" "+(n.targetY-n.rightSmallArcRadius)+"A"+(n.rightLargeArcRadius-t)+" "+(n.rightSmallArcRadius-t)+" 0 0 0 "+n.rightInnerExtent+" "+(n.targetY-t)+"L"+n.targetX+" "+(n.targetY-t)+"Z":"M "+n.targetX+" "+(n.targetY-t)+" L"+n.rightInnerExtent+" "+(n.targetY-t)+"A"+(n.rightLargeArcRadius+t)+" "+(n.rightSmallArcRadius+t)+" 0 0 0 "+(n.rightFullExtent-t)+" "+(n.targetY+n.rightSmallArcRadius)+"L"+(n.rightFullExtent-t)+" "+n.verticalRightInnerExtent+"A"+(n.rightLargeArcRadius+t)+" "+(n.rightLargeArcRadius+t)+" 0 0 0 "+n.rightInnerExtent+" "+(n.verticalFullExtent+t)+"L"+n.leftInnerExtent+" "+(n.verticalFullExtent+t)+"A"+(n.leftLargeArcRadius+t)+" "+(n.leftLargeArcRadius+t)+" 0 0 0 "+(n.leftFullExtent+t)+" "+n.verticalLeftInnerExtent+"L"+(n.leftFullExtent+t)+" "+(n.sourceY+n.leftSmallArcRadius)+"A"+(n.leftLargeArcRadius+t)+" "+(n.leftSmallArcRadius+t)+" 0 0 0 "+n.leftInnerExtent+" "+(n.sourceY-t)+"L"+n.sourceX+" "+(n.sourceY-t)+"L"+n.sourceX+" "+(n.sourceY+t)+"L"+n.leftInnerExtent+" "+(n.sourceY+t)+"A"+(n.leftLargeArcRadius-t)+" "+(n.leftSmallArcRadius-t)+" 0 0 1 "+(n.leftFullExtent-t)+" "+(n.sourceY+n.leftSmallArcRadius)+"L"+(n.leftFullExtent-t)+" "+n.verticalLeftInnerExtent+"A"+(n.leftLargeArcRadius-t)+" "+(n.leftLargeArcRadius-t)+" 0 0 1 "+n.leftInnerExtent+" "+(n.verticalFullExtent-t)+"L"+n.rightInnerExtent+" "+(n.verticalFullExtent-t)+"A"+(n.rightLargeArcRadius-t)+" "+(n.rightLargeArcRadius-t)+" 0 0 1 "+(n.rightFullExtent+t)+" "+n.verticalRightInnerExtent+"L"+(n.rightFullExtent+t)+" "+(n.targetY+n.rightSmallArcRadius)+"A"+(n.rightLargeArcRadius-t)+" "+(n.rightSmallArcRadius-t)+" 0 0 1 "+n.rightInnerExtent+" "+(n.targetY+t)+"L"+n.targetX+" "+(n.targetY+t)+"Z"}(e.link);var t=e.link.source.x1,n=e.link.target.x0,a=r(t,n),o=a(.5),i=a(.5),l=e.link.y0-e.link.width/2,s=e.link.y0+e.link.width/2,c=e.link.y1-e.link.width/2,d=e.link.y1+e.link.width/2;return"M"+t+","+l+"C"+o+","+l+" "+i+","+c+" "+n+","+c+"L"+n+","+d+"C"+i+","+d+" "+o+","+s+" "+t+","+s+"Z"}}function I(e,t){var n=c(t.color),a=s.nodePadAcross,r=e.nodePad/2;t.dx=t.x1-t.x0,t.dy=t.y1-t.y0;var o=t.dx,i=Math.max(.5,t.dy),l="node_"+t.pointNumber;return t.group&&(l=f.randstr()),t.trace=e.trace,t.curveNumber=e.trace.index,{index:t.pointNumber,key:l,partOfGroup:t.partOfGroup||!1,group:t.group,traceId:e.key,trace:e.trace,node:t,nodePad:e.nodePad,nodeLineColor:e.nodeLineColor,nodeLineWidth:e.nodeLineWidth,textFont:e.textFont,size:e.horizontal?e.height:e.width,visibleWidth:Math.ceil(o),visibleHeight:i,zoneX:-a,zoneY:-r,zoneWidth:o+2*a,zoneHeight:i+2*r,labelY:e.horizontal?t.dy/2+1:t.dx/2+1,left:1===t.originalLayer,sizeAcross:e.width,forceLayouts:e.forceLayouts,horizontal:e.horizontal,darkBackground:n.getBrightness()<=128,tinyColorHue:d.tinyRGB(n),tinyColorAlpha:n.getAlpha(),valueFormat:e.valueFormat,valueSuffix:e.valueSuffix,sankey:e.sankey,graph:e.graph,arrangement:e.arrangement,uniqueNodeLabelPathId:[e.guid,e.key,l].join("_"),interactionState:e.interactionState,figure:e}}function O(e){e.attr("transform",(function(e){return h(e.node.x0.toFixed(3),e.node.y0.toFixed(3))}))}function S(e){e.call(O)}function M(e,t){e.call(S),t.attr("d",T())}function E(e){e.attr("width",(function(e){return e.node.x1-e.node.x0})).attr("height",(function(e){return e.visibleHeight}))}function F(e){return e.link.width>1||e.linkLineWidth>0}function P(e){return h(e.translateX,e.translateY)+(e.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function z(e,t,n){e.on(".basic",null).on("mouseover.basic",(function(e){e.interactionState.dragInProgress||e.partOfGroup||(n.hover(this,e,t),e.interactionState.hovered=[this,e])})).on("mousemove.basic",(function(e){e.interactionState.dragInProgress||e.partOfGroup||(n.follow(this,e),e.interactionState.hovered=[this,e])})).on("mouseout.basic",(function(e){e.interactionState.dragInProgress||e.partOfGroup||(n.unhover(this,e,t),e.interactionState.hovered=!1)})).on("click.basic",(function(e){e.interactionState.hovered&&(n.unhover(this,e,t),e.interactionState.hovered=!1),e.interactionState.dragInProgress||e.partOfGroup||n.select(this,e,t)}))}function C(e,t,n,r){var i=o.behavior.drag().origin((function(e){return{x:e.node.x0+e.visibleWidth/2,y:e.node.y0+e.visibleHeight/2}})).on("dragstart",(function(o){if("fixed"!==o.arrangement&&(f.ensureSingle(r._fullLayout._infolayer,"g","dragcover",(function(e){r._fullLayout._dragCover=e})),f.raiseToTop(this),o.interactionState.dragInProgress=o.node,D(o.node),o.interactionState.hovered&&(n.nodeEvents.unhover.apply(0,o.interactionState.hovered),o.interactionState.hovered=!1),"snap"===o.arrangement)){var i=o.traceId+"|"+o.key;o.forceLayouts[i]?o.forceLayouts[i].alpha(1):function(e,t,n,r){!function(e){for(var t=0;t<e.length;t++)e[t].y=(e[t].y0+e[t].y1)/2,e[t].x=(e[t].x0+e[t].x1)/2}(n.graph.nodes);var o=n.graph.nodes.filter((function(e){return e.originalX===n.node.originalX})).filter((function(e){return!e.partOfGroup}));n.forceLayouts[t]=a.forceSimulation(o).alphaDecay(0).force("collide",a.forceCollide().radius((function(e){return e.dy/2+n.nodePad/2})).strength(1).iterations(s.forceIterations)).force("constrain",function(e,t,n,a){return function(){for(var e=0,r=0;r<n.length;r++){var o=n[r];o===a.interactionState.dragInProgress?(o.x=o.lastDraggedX,o.y=o.lastDraggedY):(o.vx=(o.originalX-o.x)/s.forceTicksPerFrame,o.y=Math.min(a.size-o.dy/2,Math.max(o.dy/2,o.y))),e=Math.max(e,Math.abs(o.vx),Math.abs(o.vy))}!a.interactionState.dragInProgress&&e<.1&&a.forceLayouts[t].alpha()>0&&a.forceLayouts[t].alpha(0)}}(0,t,o,n)).stop()}(0,i,o),function(e,t,n,a,r){window.requestAnimationFrame((function o(){var i;for(i=0;i<s.forceTicksPerFrame;i++)n.forceLayouts[a].tick();if(function(e){for(var t=0;t<e.length;t++)e[t].y0=e[t].y-e[t].dy/2,e[t].y1=e[t].y0+e[t].dy,e[t].x0=e[t].x-e[t].dx/2,e[t].x1=e[t].x0+e[t].dx}(n.graph.nodes),n.sankey.update(n.graph),M(e.filter(Y(n)),t),n.forceLayouts[a].alpha()>0)window.requestAnimationFrame(o);else{var l=n.node.originalX;n.node.x0=l-n.visibleWidth/2,n.node.x1=l+n.visibleWidth/2,R(n,r)}}))}(e,t,o,i,r)}})).on("drag",(function(n){if("fixed"!==n.arrangement){var a=o.event.x,r=o.event.y;"snap"===n.arrangement?(n.node.x0=a-n.visibleWidth/2,n.node.x1=a+n.visibleWidth/2,n.node.y0=r-n.visibleHeight/2,n.node.y1=r+n.visibleHeight/2):("freeform"===n.arrangement&&(n.node.x0=a-n.visibleWidth/2,n.node.x1=a+n.visibleWidth/2),r=Math.max(0,Math.min(n.size-n.visibleHeight/2,r)),n.node.y0=r-n.visibleHeight/2,n.node.y1=r+n.visibleHeight/2),D(n.node),"snap"!==n.arrangement&&(n.sankey.update(n.graph),M(e.filter(Y(n)),t))}})).on("dragend",(function(e){if("fixed"!==e.arrangement){e.interactionState.dragInProgress=!1;for(var t=0;t<e.node.childrenNodes.length;t++)e.node.childrenNodes[t].x=e.node.x,e.node.childrenNodes[t].y=e.node.y;"snap"!==e.arrangement&&R(e,r)}}));e.on(".drag",null).call(i)}function R(e,t){for(var n=[],a=[],r=0;r<e.graph.nodes.length;r++){var o=(e.graph.nodes[r].x0+e.graph.nodes[r].x1)/2,i=(e.graph.nodes[r].y0+e.graph.nodes[r].y1)/2;n.push(o/e.figure.width),a.push(i/e.figure.height)}b.call("_guiRestyle",t,{"node.x":[n],"node.y":[a]},e.trace.index).then((function(){t._fullLayout._dragCover&&t._fullLayout._dragCover.remove()}))}function D(e){e.lastDraggedX=e.x0+e.dx/2,e.lastDraggedY=e.y0+e.dy/2}function Y(e){return function(t){return t.node.originalX===e.node.originalX}}e.exports=function(e,t,n,a,r){var i=!1;f.ensureSingle(e._fullLayout._infolayer,"g","first-render",(function(){i=!0}));var l=e._fullLayout._dragCover,v=n.filter((function(e){return g(e).trace.visible})).map(w.bind(null,a)),b=t.selectAll("."+s.cn.sankey).data(v,y);b.exit().remove(),b.enter().append("g").classed(s.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",P),b.each((function(t,n){e._fullData[n]._sankey=t;var a="bgsankey-"+t.trace.uid+"-"+n;f.ensureSingle(e._fullLayout._draggers,"rect",a),e._fullData[n]._bgRect=o.select("."+a),e._fullData[n]._bgRect.style("pointer-events","all").attr("width",t.width).attr("height",t.height).attr("x",t.translateX).attr("y",t.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})})),b.transition().ease(s.ease).duration(s.duration).attr("transform",P);var k=b.selectAll("."+s.cn.sankeyLinks).data(x,y);k.enter().append("g").classed(s.cn.sankeyLinks,!0).style("fill","none");var S=k.selectAll("."+s.cn.sankeyLink).data((function(e){return e.graph.links.filter((function(e){return e.value})).map(A.bind(null,e))}),y);S.enter().append("path").classed(s.cn.sankeyLink,!0).call(z,b,r.linkEvents),S.style("stroke",(function(e){return F(e)?d.tinyRGB(c(e.linkLineColor)):e.tinyColorHue})).style("stroke-opacity",(function(e){return F(e)?d.opacity(e.linkLineColor):e.tinyColorAlpha})).style("fill",(function(e){return e.tinyColorHue})).style("fill-opacity",(function(e){return e.tinyColorAlpha})).style("stroke-width",(function(e){return F(e)?e.linkLineWidth:1})).attr("d",T()),S.style("opacity",(function(){return e._context.staticPlot||i||l?1:0})).transition().ease(s.ease).duration(s.duration).style("opacity",1),S.exit().transition().ease(s.ease).duration(s.duration).style("opacity",0).remove();var M=b.selectAll("."+s.cn.sankeyNodeSet).data(x,y);M.enter().append("g").classed(s.cn.sankeyNodeSet,!0),M.style("cursor",(function(e){switch(e.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}}));var R=M.selectAll("."+s.cn.sankeyNode).data((function(e){var t=e.graph.nodes;return function(e){var t,n=[];for(t=0;t<e.length;t++)e[t].originalX=(e[t].x0+e[t].x1)/2,e[t].originalY=(e[t].y0+e[t].y1)/2,-1===n.indexOf(e[t].originalX)&&n.push(e[t].originalX);for(n.sort((function(e,t){return e-t})),t=0;t<e.length;t++)e[t].originalLayerIndex=n.indexOf(e[t].originalX),e[t].originalLayer=e[t].originalLayerIndex/(n.length-1)}(t),t.map(I.bind(null,e))}),y);R.enter().append("g").classed(s.cn.sankeyNode,!0).call(O).style("opacity",(function(t){return!e._context.staticPlot&&!i||t.partOfGroup?0:1})),R.call(z,b,r.nodeEvents).call(C,S,r,e),R.transition().ease(s.ease).duration(s.duration).call(O).style("opacity",(function(e){return e.partOfGroup?0:1})),R.exit().transition().ease(s.ease).duration(s.duration).style("opacity",0).remove();var D=R.selectAll("."+s.cn.nodeRect).data(x);D.enter().append("rect").classed(s.cn.nodeRect,!0).call(E),D.style("stroke-width",(function(e){return e.nodeLineWidth})).style("stroke",(function(e){return d.tinyRGB(c(e.nodeLineColor))})).style("stroke-opacity",(function(e){return d.opacity(e.nodeLineColor)})).style("fill",(function(e){return e.tinyColorHue})).style("fill-opacity",(function(e){return e.tinyColorAlpha})),D.transition().ease(s.ease).duration(s.duration).call(E);var Y=R.selectAll("."+s.cn.nodeLabel).data(x);Y.enter().append("text").classed(s.cn.nodeLabel,!0).style("cursor","default"),Y.attr("data-notex",1).text((function(e){return e.node.label})).each((function(t){var n=o.select(this);u.font(n,t.textFont),m.convertToTspans(n,e)})).style("text-shadow",m.makeTextShadow(e._fullLayout.paper_bgcolor)).attr("text-anchor",(function(e){return e.horizontal&&e.left?"end":"start"})).attr("transform",(function(e){var t=o.select(this),n=m.lineCount(t),a=e.textFont.size*((n-1)*_-L),r=e.nodeLineWidth/2+3,i=((e.horizontal?e.visibleHeight:e.visibleWidth)-a)/2;e.horizontal&&(e.left?r=-r:r+=e.visibleWidth);var l=e.horizontal?"":"scale(-1,1)"+p(90);return h(e.horizontal?r:i,e.horizontal?i:r)+l})),Y.transition().ease(s.ease).duration(s.duration)}},39934:function(e){e.exports=function(e,t){for(var n=[],a=e.cd[0].trace,r=a._sankey.graph.nodes,o=0;o<r.length;o++){var i=r[o];if(!i.partOfGroup){var l=[(i.x0+i.x1)/2,(i.y0+i.y1)/2];"v"===a.orientation&&l.reverse(),t&&t.contains(l,!1,o,e)&&n.push({pointNumber:i.pointNumber})}}return n}}}]);